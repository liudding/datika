!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.gradecam=e():t.gradecam=e()}(window,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(e){return t[e]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=59)}([function(t,e,n){var r;(function(){function n(t){return function(e,n,r,i){n=x(n,i,4);var o=!j(e)&&_.keys(e),s=(o||e).length,a=t>0?0:s-1;return arguments.length<3&&(r=e[o?o[a]:a],a+=t),function(e,n,r,i,o,s){for(;o>=0&&o<s;o+=t){var a=i?i[o]:o;r=n(r,e[a],a,e)}return r}(e,n,r,o,a,s)}}function i(t){return function(e,n,r){n=S(n,r);for(var i=T(e),o=t>0?0:i-1;o>=0&&o<i;o+=t)if(n(e[o],o,e))return o;return-1}}function o(t,e,n){return function(r,i,o){var s=0,a=T(r);if("number"==typeof o)t>0?s=o>=0?o:Math.max(o+a,s):a=o>=0?Math.min(o+1,a):o+a+1;else if(n&&o&&a)return r[o=n(r,i)]===i?o:-1;if(i!=i)return(o=e(h.call(r,s,a),_.isNaN))>=0?o+s:-1;for(o=t>0?s:a-1;o>=0&&o<a;o+=t)if(r[o]===i)return o;return-1}}function s(t,e){var n=R.length,r=t.constructor,i=_.isFunction(r)&&r.prototype||l,o="constructor";for(_.has(t,o)&&!_.contains(e,o)&&e.push(o);n--;)(o=R[n])in t&&t[o]!==i[o]&&!_.contains(e,o)&&e.push(o)}var a=this,c=a._,u=Array.prototype,l=Object.prototype,p=Function.prototype,f=u.push,h=u.slice,d=l.toString,y=l.hasOwnProperty,m=Array.isArray,g=Object.keys,v=p.bind,b=Object.create,w=function(){},_=function(t){return t instanceof _?t:this instanceof _?void(this._wrapped=t):new _(t)};t.exports&&(e=t.exports=_),e._=_,_.VERSION="1.8.3";var x=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return function(){return t.apply(e,arguments)}},S=function(t,e,n){return null==t?_.identity:_.isFunction(t)?x(t,e,n):_.isObject(t)?_.matcher(t):_.property(t)};_.iteratee=function(t,e){return S(t,e,1/0)};var k=function(t,e){return function(n){var r=arguments.length;if(r<2||null==n)return n;for(var i=1;i<r;i++)for(var o=arguments[i],s=t(o),a=s.length,c=0;c<a;c++){var u=s[c];e&&void 0!==n[u]||(n[u]=o[u])}return n}},O=function(t){if(!_.isObject(t))return{};if(b)return b(t);w.prototype=t;var e=new w;return w.prototype=null,e},I=function(t){return function(e){return null==e?void 0:e[t]}},C=Math.pow(2,53)-1,T=I("length"),j=function(t){var e=T(t);return"number"==typeof e&&e>=0&&e<=C};_.each=_.forEach=function(t,e,n){var r,i;if(e=x(e,n),j(t))for(r=0,i=t.length;r<i;r++)e(t[r],r,t);else{var o=_.keys(t);for(r=0,i=o.length;r<i;r++)e(t[o[r]],o[r],t)}return t},_.map=_.collect=function(t,e,n){e=S(e,n);for(var r=!j(t)&&_.keys(t),i=(r||t).length,o=Array(i),s=0;s<i;s++){var a=r?r[s]:s;o[s]=e(t[a],a,t)}return o},_.reduce=_.foldl=_.inject=n(1),_.reduceRight=_.foldr=n(-1),_.find=_.detect=function(t,e,n){var r;if(void 0!==(r=j(t)?_.findIndex(t,e,n):_.findKey(t,e,n))&&-1!==r)return t[r]},_.filter=_.select=function(t,e,n){var r=[];return e=S(e,n),_.each(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r},_.reject=function(t,e,n){return _.filter(t,_.negate(S(e)),n)},_.every=_.all=function(t,e,n){e=S(e,n);for(var r=!j(t)&&_.keys(t),i=(r||t).length,o=0;o<i;o++){var s=r?r[o]:o;if(!e(t[s],s,t))return!1}return!0},_.some=_.any=function(t,e,n){e=S(e,n);for(var r=!j(t)&&_.keys(t),i=(r||t).length,o=0;o<i;o++){var s=r?r[o]:o;if(e(t[s],s,t))return!0}return!1},_.contains=_.includes=_.include=function(t,e,n,r){return j(t)||(t=_.values(t)),("number"!=typeof n||r)&&(n=0),_.indexOf(t,e,n)>=0},_.invoke=function(t,e){var n=h.call(arguments,2),r=_.isFunction(e);return _.map(t,function(t){var i=r?e:t[e];return null==i?i:i.apply(t,n)})},_.pluck=function(t,e){return _.map(t,_.property(e))},_.where=function(t,e){return _.filter(t,_.matcher(e))},_.findWhere=function(t,e){return _.find(t,_.matcher(e))},_.max=function(t,e,n){var r,i,o=-1/0,s=-1/0;if(null==e&&null!=t)for(var a=0,c=(t=j(t)?t:_.values(t)).length;a<c;a++)(r=t[a])>o&&(o=r);else e=S(e,n),_.each(t,function(t,n,r){((i=e(t,n,r))>s||i===-1/0&&o===-1/0)&&(o=t,s=i)});return o},_.min=function(t,e,n){var r,i,o=1/0,s=1/0;if(null==e&&null!=t)for(var a=0,c=(t=j(t)?t:_.values(t)).length;a<c;a++)(r=t[a])<o&&(o=r);else e=S(e,n),_.each(t,function(t,n,r){((i=e(t,n,r))<s||i===1/0&&o===1/0)&&(o=t,s=i)});return o},_.shuffle=function(t){for(var e,n=j(t)?t:_.values(t),r=n.length,i=Array(r),o=0;o<r;o++)(e=_.random(0,o))!==o&&(i[o]=i[e]),i[e]=n[o];return i},_.sample=function(t,e,n){return null==e||n?(j(t)||(t=_.values(t)),t[_.random(t.length-1)]):_.shuffle(t).slice(0,Math.max(0,e))},_.sortBy=function(t,e,n){return e=S(e,n),_.pluck(_.map(t,function(t,n,r){return{value:t,index:n,criteria:e(t,n,r)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")};var D=function(t){return function(e,n,r){var i={};return n=S(n,r),_.each(e,function(r,o){var s=n(r,o,e);t(i,r,s)}),i}};_.groupBy=D(function(t,e,n){_.has(t,n)?t[n].push(e):t[n]=[e]}),_.indexBy=D(function(t,e,n){t[n]=e}),_.countBy=D(function(t,e,n){_.has(t,n)?t[n]++:t[n]=1}),_.toArray=function(t){return t?_.isArray(t)?h.call(t):j(t)?_.map(t,_.identity):_.values(t):[]},_.size=function(t){return null==t?0:j(t)?t.length:_.keys(t).length},_.partition=function(t,e,n){e=S(e,n);var r=[],i=[];return _.each(t,function(t,n,o){(e(t,n,o)?r:i).push(t)}),[r,i]},_.first=_.head=_.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:_.initial(t,t.length-e)},_.initial=function(t,e,n){return h.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},_.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:_.rest(t,Math.max(0,t.length-e))},_.rest=_.tail=_.drop=function(t,e,n){return h.call(t,null==e||n?1:e)},_.compact=function(t){return _.filter(t,_.identity)};var M=function(t,e,n,r){for(var i=[],o=0,s=r||0,a=T(t);s<a;s++){var c=t[s];if(j(c)&&(_.isArray(c)||_.isArguments(c))){e||(c=M(c,e,n));var u=0,l=c.length;for(i.length+=l;u<l;)i[o++]=c[u++]}else n||(i[o++]=c)}return i};_.flatten=function(t,e){return M(t,e,!1)},_.without=function(t){return _.difference(t,h.call(arguments,1))},_.uniq=_.unique=function(t,e,n,r){_.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=S(n,r));for(var i=[],o=[],s=0,a=T(t);s<a;s++){var c=t[s],u=n?n(c,s,t):c;e?(s&&o===u||i.push(c),o=u):n?_.contains(o,u)||(o.push(u),i.push(c)):_.contains(i,c)||i.push(c)}return i},_.union=function(){return _.uniq(M(arguments,!0,!0))},_.intersection=function(t){for(var e=[],n=arguments.length,r=0,i=T(t);r<i;r++){var o=t[r];if(!_.contains(e,o)){for(var s=1;s<n&&_.contains(arguments[s],o);s++);s===n&&e.push(o)}}return e},_.difference=function(t){var e=M(arguments,!0,!0,1);return _.filter(t,function(t){return!_.contains(e,t)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(t){for(var e=t&&_.max(t,T).length||0,n=Array(e),r=0;r<e;r++)n[r]=_.pluck(t,r);return n},_.object=function(t,e){for(var n={},r=0,i=T(t);r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},_.findIndex=i(1),_.findLastIndex=i(-1),_.sortedIndex=function(t,e,n,r){for(var i=(n=S(n,r,1))(e),o=0,s=T(t);o<s;){var a=Math.floor((o+s)/2);n(t[a])<i?o=a+1:s=a}return o},_.indexOf=o(1,_.findIndex,_.sortedIndex),_.lastIndexOf=o(-1,_.findLastIndex),_.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),o=0;o<r;o++,t+=n)i[o]=t;return i};var P=function(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var o=O(t.prototype),s=t.apply(o,i);return _.isObject(s)?s:o};_.bind=function(t,e){if(v&&t.bind===v)return v.apply(t,h.call(arguments,1));if(!_.isFunction(t))throw new TypeError("Bind must be called on a function");var n=h.call(arguments,2),r=function(){return P(t,r,e,this,n.concat(h.call(arguments)))};return r},_.partial=function(t){var e=h.call(arguments,1),n=function(){for(var r=0,i=e.length,o=Array(i),s=0;s<i;s++)o[s]=e[s]===_?arguments[r++]:e[s];for(;r<arguments.length;)o.push(arguments[r++]);return P(t,n,this,this,o)};return n},_.bindAll=function(t){var e,n,r=arguments.length;if(r<=1)throw new Error("bindAll must be passed function names");for(e=1;e<r;e++)t[n=arguments[e]]=_.bind(t[n],t);return t},_.memoize=function(t,e){var n=function(r){var i=n.cache,o=""+(e?e.apply(this,arguments):r);return _.has(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return n.cache={},n},_.delay=function(t,e){var n=h.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},_.defer=_.partial(_.delay,_,1),_.throttle=function(t,e,n){var r,i,o,s=null,a=0;n||(n={});var c=function(){a=!1===n.leading?0:_.now(),s=null,o=t.apply(r,i),s||(r=i=null)};return function(){var u=_.now();a||!1!==n.leading||(a=u);var l=e-(u-a);return r=this,i=arguments,l<=0||l>e?(s&&(clearTimeout(s),s=null),a=u,o=t.apply(r,i),s||(r=i=null)):s||!1===n.trailing||(s=setTimeout(c,l)),o}},_.debounce=function(t,e,n){var r,i,o,s,a,c=function(){var u=_.now()-s;u<e&&u>=0?r=setTimeout(c,e-u):(r=null,n||(a=t.apply(o,i),r||(o=i=null)))};return function(){o=this,i=arguments,s=_.now();var u=n&&!r;return r||(r=setTimeout(c,e)),u&&(a=t.apply(o,i),o=i=null),a}},_.wrap=function(t,e){return _.partial(e,t)},_.negate=function(t){return function(){return!t.apply(this,arguments)}},_.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},_.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},_.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},_.once=_.partial(_.before,2);var E=!{toString:null}.propertyIsEnumerable("toString"),R=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];_.keys=function(t){if(!_.isObject(t))return[];if(g)return g(t);var e=[];for(var n in t)_.has(t,n)&&e.push(n);return E&&s(t,e),e},_.allKeys=function(t){if(!_.isObject(t))return[];var e=[];for(var n in t)e.push(n);return E&&s(t,e),e},_.values=function(t){for(var e=_.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r},_.mapObject=function(t,e,n){e=S(e,n);for(var r,i=_.keys(t),o=i.length,s={},a=0;a<o;a++)s[r=i[a]]=e(t[r],r,t);return s},_.pairs=function(t){for(var e=_.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=[e[i],t[e[i]]];return r},_.invert=function(t){for(var e={},n=_.keys(t),r=0,i=n.length;r<i;r++)e[t[n[r]]]=n[r];return e},_.functions=_.methods=function(t){var e=[];for(var n in t)_.isFunction(t[n])&&e.push(n);return e.sort()},_.extend=k(_.allKeys),_.extendOwn=_.assign=k(_.keys),_.findKey=function(t,e,n){e=S(e,n);for(var r,i=_.keys(t),o=0,s=i.length;o<s;o++)if(e(t[r=i[o]],r,t))return r},_.pick=function(t,e,n){var r,i,o={},s=t;if(null==s)return o;_.isFunction(e)?(i=_.allKeys(s),r=x(e,n)):(i=M(arguments,!1,!1,1),r=function(t,e,n){return e in n},s=Object(s));for(var a=0,c=i.length;a<c;a++){var u=i[a],l=s[u];r(l,u,s)&&(o[u]=l)}return o},_.omit=function(t,e,n){if(_.isFunction(e))e=_.negate(e);else{var r=_.map(M(arguments,!1,!1,1),String);e=function(t,e){return!_.contains(r,e)}}return _.pick(t,e,n)},_.defaults=k(_.allKeys,!0),_.create=function(t,e){var n=O(t);return e&&_.extendOwn(n,e),n},_.clone=function(t){return _.isObject(t)?_.isArray(t)?t.slice():_.extend({},t):t},_.tap=function(t,e){return e(t),t},_.isMatch=function(t,e){var n=_.keys(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;o<r;o++){var s=n[o];if(e[s]!==i[s]||!(s in i))return!1}return!0};var F=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof _&&(t=t._wrapped),e instanceof _&&(e=e._wrapped);var i=d.call(t);if(i!==d.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(_.isFunction(s)&&s instanceof s&&_.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}r=r||[];for(var c=(n=n||[]).length;c--;)if(n[c]===t)return r[c]===e;if(n.push(t),r.push(e),o){if((c=t.length)!==e.length)return!1;for(;c--;)if(!F(t[c],e[c],n,r))return!1}else{var u,l=_.keys(t);if(c=l.length,_.keys(e).length!==c)return!1;for(;c--;)if(u=l[c],!_.has(e,u)||!F(t[u],e[u],n,r))return!1}return n.pop(),r.pop(),!0};_.isEqual=function(t,e){return F(t,e)},_.isEmpty=function(t){return null==t||(j(t)&&(_.isArray(t)||_.isString(t)||_.isArguments(t))?0===t.length:0===_.keys(t).length)},_.isElement=function(t){return!(!t||1!==t.nodeType)},_.isArray=m||function(t){return"[object Array]"===d.call(t)},_.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){_["is"+t]=function(e){return d.call(e)==="[object "+t+"]"}}),_.isArguments(arguments)||(_.isArguments=function(t){return _.has(t,"callee")}),"object"!=typeof Int8Array&&(_.isFunction=function(t){return"function"==typeof t||!1}),_.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},_.isNaN=function(t){return _.isNumber(t)&&t!==+t},_.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===d.call(t)},_.isNull=function(t){return null===t},_.isUndefined=function(t){return void 0===t},_.has=function(t,e){return null!=t&&y.call(t,e)},_.noConflict=function(){return a._=c,this},_.identity=function(t){return t},_.constant=function(t){return function(){return t}},_.noop=function(){},_.property=I,_.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},_.matcher=_.matches=function(t){return t=_.extendOwn({},t),function(e){return _.isMatch(e,t)}},_.times=function(t,e,n){var r=Array(Math.max(0,t));e=x(e,n,1);for(var i=0;i<t;i++)r[i]=e(i);return r},_.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},_.now=Date.now||function(){return(new Date).getTime()};var A={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},N=_.invert(A),L=function(t){var e=function(e){return t[e]},n="(?:"+_.keys(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}};_.escape=L(A),_.unescape=L(N),_.result=function(t,e,n){var r=null==t?void 0:t[e];return void 0===r&&(r=n),_.isFunction(r)?r.call(t):r};var q=0;_.uniqueId=function(t){var e=++q+"";return t?t+e:e},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var U=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},G=/\\|'|\r|\n|\u2028|\u2029/g,V=function(t){return"\\"+B[t]};_.template=function(t,e,n){!e&&n&&(e=n),e=_.defaults({},e,_.templateSettings);var r=RegExp([(e.escape||U).source,(e.interpolate||U).source,(e.evaluate||U).source].join("|")+"|$","g"),i=0,o="__p+='";t.replace(r,function(e,n,r,s,a){return o+=t.slice(i,a).replace(G,V),i=a+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var s=new Function(e.variable||"obj","_",o)}catch(t){throw t.source=o,t}var a=function(t){return s.call(this,t,_)},c=e.variable||"obj";return a.source="function("+c+"){\n"+o+"}",a},_.chain=function(t){var e=_(t);return e._chain=!0,e};var H=function(t,e){return t._chain?_(e).chain():e};_.mixin=function(t){_.each(_.functions(t),function(e){var n=_[e]=t[e];_.prototype[e]=function(){var t=[this._wrapped];return f.apply(t,arguments),H(this,n.apply(_,t))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=u[t];_.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],H(this,n)}}),_.each(["concat","join","slice"],function(t){var e=u[t];_.prototype[t]=function(){return H(this,e.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped},void 0===(r=function(){return _}.apply(e,[]))||(t.exports=r)}).call(this)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(22);"undefined"==typeof window||window.Promise||(window.Promise=r),e.PromiseAll=function(t){return new Promise(function(e,n){function r(o,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(t){return r(o,t)},n)}t[o]=s,0==--i&&e(t)}catch(t){n(t)}}if(0===t.length)return e([]);for(var i=t.length,o=0;o<t.length;o++)r(o,t[o])})},e.newDeferred=function(t){var e,n=new Promise(function(t,n){e={reject:n,resolve:t}});return e.promise=n,arguments.length>0&&e.resolve(t),e},e.rejected=function(t){return new Promise(function(e,n){return n(t)})},e.race=function(t){return new Promise(function(e,n){for(var r=0;r<t.length;r+=1)Promise.resolve(t[r]).then(e,n)})},e.later=function(t,e){return new Promise(function(n){setTimeout(n,e,t)})}},function(t,e,n){"use strict";var r=n(0),i=function(){function t(){if(!(this instanceof t))return new t;this.trace=r.bind(this._log,this,t.TRACE),this.debug=r.bind(this._log,this,t.DEBUG),this.info=r.bind(this._log,this,t.INFO),this.warn=r.bind(this._log,this,t.WARN),this.error=r.bind(this._log,this,t.ERROR),this.logLevel=t.ERROR}return t.prototype.setLogLevel=function(t){this.logLevel=t},t.prototype._log=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.logLevel>=t&&window.console&&console.log(e)},t.prototype.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.get=function(){throw new Error("Not configured")},t.TRACE=5,t.DEBUG=4,t.INFO=3,t.WARN=2,t.ERROR=1,t}(),o=new i;i.get=function(){return o},function(t){var e=function(){function e(e,n){void 0===e&&(e="LogTimer"),void 0===n&&(n=t.INFO),this.name=e,this.level=n,this.start=Date.now(),this.count=0}return e.prototype.log=function(t,e){o._log(this.level,this.name+": "+(e||"")+" "+t)},e.prototype.ping=function(){this.count++},e.prototype.reset=function(t){this.count=0,this.start=Date.now(),t&&this.log(t)},e.prototype.getSeconds=function(){return(Date.now()-this.start)/1e3},e.prototype.logNow=function(t){var e=this.getSeconds()+" seconds";this.count&&(e+=" @"+this.count/this.getSeconds()+" calls per second"),this.log(e,t)},e}();t.LogTimer=e}(i||(i={})),t.exports=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this._callbacks={}}return t.prototype.bind=function(t,e,n){var r=this._callbacks;return(r[t]||(r[t]=[])).push([e,n]),this},t.prototype.unbind=function(t,e){var n=this._callbacks;if(t){if(n)if(e){var r=n[t];if(!r)return this;for(var i=0,o=r.length;i<o;i++)if(r[i]&&e===r[i][0]){r[i]=null;break}}else n[t]=[]}else this._callbacks={};return this},t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this._callbacks,i=2;if(!r)return this;for(;i--;){var o=r[i?t:"all"];if(o)for(var s=0,a=o.length;s<a;s++){var c=o[s];c?(e=i?Array.prototype.slice.call(arguments,1):arguments,c[0].apply(c[1]||this,e)):(o.splice(s,1),s--,a--)}}return this},t}();e.ClassTS=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(151);e.ScanBlocks=r;var i=n(155);e.InterpretedScan=i;var o=n(163);e.StructuredScan=o;var s=n(12);e.FormDescription=s;var a=n(48);e.FormMode=a},function(t,e,n){"use strict";function r(t){return t.reduce(function(t,e){return t.concat(e instanceof u.UnsubscriptionError?e.errors:e)},[])}var i=n(65),o=n(66),s=n(35),a=n(67),c=n(36),u=n(68),l=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var n=this._parent,l=this._parents,p=this._unsubscribe,f=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var h=-1,d=l?l.length:0;n;)n.remove(this),n=++h<d&&l[h]||null;if(s.isFunction(p)&&a.tryCatch(p).call(this)===c.errorObject&&(e=!0,t=t||(c.errorObject.e instanceof u.UnsubscriptionError?r(c.errorObject.e.errors):[c.errorObject.e])),i.isArray(f))for(h=-1,d=f.length;++h<d;){var y=f[h];if(o.isObject(y)&&a.tryCatch(y.unsubscribe).call(y)===c.errorObject){e=!0,t=t||[];var m=c.errorObject.e;m instanceof u.UnsubscriptionError?t=t.concat(r(m.errors)):t.push(m)}}if(e)throw new u.UnsubscriptionError(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var n=e;switch(typeof e){case"function":n=new t(e);case"object":if(n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if("function"!=typeof n._addParent){var r=n;(n=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(n),n._addParent(this),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.prototype._addParent=function(t){var e=this._parent,n=this._parents;e&&e!==t?n?-1===n.indexOf(t)&&n.push(t):this._parents=[t]:this._parent=t},t.EMPTY=((e=new t).closed=!0,e),t}();e.Subscription=l},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=n(43),s=n(1);n(22),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame,!window.URL&&window.webkitURL&&(window.URL=window.webkitURL);var a=window.File&&window.FileReader&&window.FileList&&window.Blob&&window.URL&&window.URL.createObjectURL,c={ext_installed:o.ext_installed,installed:void 0,waitForPlugin:o.watchForInstall,supported:o.supported},u=s.newDeferred(),l={userMedia:!!navigator.getUserMedia||navigator.mediaDevices&&!!navigator.mediaDevices.getUserMedia,webWorker:!!window.Worker,reqAnimFrame:!!window.requestAnimationFrame,fileSupport:!!a,plugin2:c,readyDfd:u.promise};if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){var p=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;p&&(navigator.mediaDevices||(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia=function(t){return new Promise(function(e,n){return p.call(navigator,t,e,n)})})}c.ext_installed?function t(e){return r(this,void 0,void 0,function(){var n,r;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,o.detect()];case 1:return n=i.sent(),c.installed=n,[3,3];case 2:return r=i.sent(),c.installed=!!c.installed,e&&"timeout"==r&&t(e-1),[3,3];case 3:return[2]}})})}(3).catch(function(t){return c.installed=!1}).then(function(){return u.resolve()}):u.resolve(),t.exports=l},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(16),o=n(70),s=n(5),a=n(77),c=n(20),u=n(38),l=function(t){function e(e,n,r){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY),t.call(this),this.scheduler=r,this._events=[],this._bufferSize=e<1?1:e,this._windowTime=n<1?1:n}return r(e,t),e.prototype.next=function(e){var n=this._getNow();this._events.push(new p(n,e)),this._trimBufferThenGetEvents(),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,n=this._trimBufferThenGetEvents(),r=this.scheduler;if(this.closed)throw new c.ObjectUnsubscribedError;this.hasError?e=s.Subscription.EMPTY:this.isStopped?e=s.Subscription.EMPTY:(this.observers.push(t),e=new u.SubjectSubscription(this,t)),r&&t.add(t=new a.ObserveOnSubscriber(t,r));for(var i=n.length,o=0;o<i&&!t.closed;o++)t.next(n[o].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||o.queue).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(t-r[o].time<n);)o++;return i>e&&(o=Math.max(o,i-e)),o>0&&r.splice(0,o),r},e}(i.Subject);e.ReplaySubject=l;var p=function(t,e){this.time=t,this.value=e}},function(t,e,n){"use strict";(function(t){var n="undefined"!=typeof window&&window,r="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,i=n||void 0!==t&&t||r;e.root=i,function(){if(!i)throw new Error("RxJS could not find any global context (window, self, global)")}()}).call(this,n(17))},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e){var n=this.constructor,r=t.call(this,"The plugin is not installed")||this;r.status=e,r.name="NeedsInstallError";var i=n.prototype;return Object.setPrototypeOf?Object.setPrototypeOf(r,i):r.__proto__=i,r}return i(e,t),e.prototype.getStatus=function(){return this.status},e.prototype.toString=function(){return this.message},e}(Error);e.NeedsInstallError=o;var s=function(t){function e(e){var n=this.constructor,r=t.call(this,e)||this;r.name="UnsupportedError";var i=n.prototype;return Object.setPrototypeOf?Object.setPrototypeOf(r,i):r.__proto__=i,r}return i(e,t),e}(Error);e.UnsupportedError=s;var a=function(t){function e(e){var n=this.constructor,r=t.call(this,e)||this;r.name="UnauthenticatedError";var i=n.prototype;return Object.setPrototypeOf?Object.setPrototypeOf(r,i):r.__proto__=i,r}return i(e,t),e}(Error);e.UnauthenticatedError=a},function(t,e,n){"use strict";function r(t){window.requestAnimationFrame?window.requestAnimationFrame(function(e){4==++f?(f=0,t(e)):r(t)}):setTimeout(t,1e3/15)}var i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},s=n(7),a=n(0),c=n(2),u=n(3),l=n(1),p=n(24),f=0,h=c.get(),d=function(){function t(t,e,n,r){var i=this;this.el=t,this.video=this.el.getElementsByTagName("video")[0],this.image=this.el.getElementsByTagName("img")[0],this.activeInput=null,this.triggeredLoop=!1,this.evtBus=new u.ClassTS,this.stream=null,this.connected=!1,this.drawn=!1,this.loopRunning=!1,this.paused=!1,this.camera=null,this.rotate=p.CameraRotate.None,this.cameraList=[],this.cameraMap={},this.p2Cameras={},this.lastWidth=0,this.lastHeight=0,this.jpegDfd=null,this.plugin2=null,this.currentCameraInfo=new s.ReplaySubject(1),this.fpsTimer=new c.LogTimer("Video FPS timer",c.INFO),this.bind=a.bind(this.evtBus.bind,this.evtBus),this.unbind=a.bind(this.evtBus.unbind,this.evtBus);var o=l.PromiseAll([e,n]).then(function(t){var e=t[0],n=t[1];return i.imageHandler=e,i.blitter=n,!0});this._readyDfd=l.PromiseAll([r,o]).then(function(t){var r=t[0];return t[1],i.plugin2=r,r&&r.setImageCallback(function(t){return i.imageDrawCallback(t)}),l.PromiseAll([i._detectCameraList(),e,n])})}return t.prototype._detectCameraList=function(){return i(this,void 0,void 0,function(){var t,e,n,r,i,s,a,c,u,p,f,d,y,m,g,v,b,w,_,x,S,k,O,I,C,T,j,D,M,P,E;return o(this,function(o){switch(o.label){case 0:return t=l.newDeferred(),e=this.plugin2,n=[],r={},i={},s=1,e?[4,e.getCameraList()]:[3,2];case 1:return c=o.sent(),[3,3];case 2:c="[]",o.label=3;case 3:a=c;try{u=a?JSON.parse(a):[]}catch(t){u=[]}if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return[3,8];o.label=4;case 4:return o.trys.push([4,6,,7]),[4,navigator.mediaDevices.enumerateDevices()];case 5:p=o.sent();try{for(p=p.filter(function(t){return"videoinput"==t.kind}),f=0,d=0,y=p;d<y.length;d++)P=y[d],m="camera "+s,g=P.label||{index:f},v=P.label||m,r[v]=g,r[m]=g,n.push(v),s++,f++}catch(t){
h.error("Error processing mediaDevices list")}try{(u||[]).forEach(function(t){var e="GC: "+t;i[e]=t,n.push(e)})}catch(t){h.error("Couldn't process plugin2 camera list")}return console.log("cameraList",n,r),this.cameraList=n,this.cameraMap=r,this.p2Cameras=i,[3,7];case 6:return b=o.sent(),h.error("Error detecting camera list"),this.cameraList=["Default Camera"],this.cameraMap["Default Camera"]="",this.p2Cameras={},h.error(b.name+": "+b.message),[3,7];case 7:return t.resolve(n),[3,14];case 8:if(!window.MediaStreamTrack||!window.MediaStreamTrack.getSources)return[3,13];w=l.newDeferred(),window.MediaStreamTrack.getSources(function(t){w.resolve(t)}),o.label=9;case 9:return o.trys.push([9,11,,12]),[4,w.promise];case 10:for(_=o.sent(),x=0,S=_;x<S.length;x++)"video"==(k=S[x]).kind&&(O="camera "+s,"user"==k.facing?O="Front Camera "+s:"environment"==k.facing&&(O="Rear Camera "+s),r[O]=k.id,n.push(O),s++);try{for(I=0,C=u||[];I<C.length;I++)P=C[I],i[T="GC: "+P]=P,n.push(T)}catch(t){h.error("Couldn't process plugin2 camera list")}return console.log("10: cmaraMap: ",n,r),this.cameraList=n,this.cameraMap=r,[3,12];case 11:return j=o.sent(),h.error("Could not process media sources:",j.message),[3,12];case 12:return t.resolve(n),[3,14];case 13:for(n=["Default Camera"],r["Default Camera"]="",D=0,M=u||[];D<M.length;D++)P=M[D],i[E="GC: "+P]=P,n.push(E);this.cameraList=n,this.cameraMap=r,this.p2Cameras=i,t.resolve(n),o.label=14,console.log("13: cmaraMap: ",this.cameraList,r);case 14:return[2,t.promise]}})})},t.prototype.drawLoop=function(){var t=this;if(this.connected&&this.activeInput){if(!this.paused){this.loopRunning=!0;var e=this.activeInput,n=this.blitter,i=this.fpsTimer,o=e.videoWidth||e.naturalWidth,s=e.videoHeight||e.naturalHeight;if(o&&s){var c=n.drawVideo(e,this.rotate);if(this.updateVideoSize(c.w,c.h),this.drawn=!0,this.imageHandler.readyForFrame()){this.fpsTimer.ping();var u=n.getVideoPixels(),l=n.isHighRes();a.defer(function(){t.imageHandler.processFrame(u,!1,l)}),this.jpegDfd&&(this.jpegDfd.resolve(n.getJPEGImage()),this.jpegDfd=null)}n.drawRects(this.rotate)}i.getSeconds()>10&&(i.logNow(),i.reset()),this.triggeredLoop||r(function(e){return t.drawLoop()})}}else this.loopRunning=!1},t.prototype.imageDrawCallback=function(t){var e=this;this.image.src=t,this.triggeredLoop&&r(function(t){return e.drawLoop()})},t.prototype.updateVideoSize=function(t,e){this.lastWidth==t&&this.lastHeight==e||(this.currentCameraInfo.next({width:t,height:e,supportsHighRes:t*e>48e4}),this.evtBus.trigger("videoSize",t,e)),this.lastWidth=t,this.lastHeight=e},t.prototype.getCameraList=function(){return JSON.stringify(this.cameraList)},t.prototype.setRotate=function(t){this.rotate=t},t.prototype.setHTML5Camera=function(t){return i(this,void 0,void 0,function(){var e,n,i,s,a,c,u,l,p,f,h,d,y=this;return o(this,function(o){switch(o.label){case 0:return this.camera=t,e=this.cameraMap,n={audio:!1,video:{advanced:[{width:{min:1600},height:{min:1200}},{width:{min:1920},height:{min:1080}},{width:{min:1280},height:{min:760}},{width:{min:800},height:{min:600}},{width:{min:640},height:{min:480}}]}},t&&""!==e[t]?(i=e[t],s="string"==typeof i?i:null,i&&navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?[4,navigator.mediaDevices.enumerateDevices()]:[3,2]):[3,3];case 1:if(a=(a=o.sent()).filter(function(t){return"videoinput"==t.kind}),c=void 0,!(c="string"==typeof i?a.filter(function(t){return t.label==i})[0]:a[i.index]))return alert("Could not connect to "+t+". No device found."),[2];s=c.deviceId,o.label=2;case 2:n.video.deviceId={exact:s},o.label=3;case 3:return o.trys.push([3,9,,10]),[4,navigator.mediaDevices.getUserMedia(n)];case 4:u=o.sent(),l=this.video,this.stream=u,p=window.URL||window.webkitURL,"srcObject"in l?l.srcObject=u:l.src=p?p.createObjectURL(u):u,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,l.play()];case 6:return o.sent(),[3,8];case 7:return f=o.sent(),console.error("Camera display error",f),[3,8];case 8:return this.activeInput=l,this.connected=!0,this.triggeredLoop=!1,this.loopRunning||r(function(){return y.drawLoop()}),[3,10];case 9:return h=o.sent(),d=t||"your default camera","ConstraintNotSatisfiedError"===h.name?alert("Your browser could not connect to '"+d+"': scanning with this device is not supported"):"PermissionDeniedError"===h.name?alert("The user has denied permission for connecting to '"+d+"'. To scan, refresh the page and allow camera access."):"NotAllowedError"===h.name?alert("The browser will not allow us to access "+d+". The error message reported is: "+h.name+" - "+h.message):alert("Could not connect to "+d+": "+h.name+" - "+h.message),[3,10];case 10:return[2]}})})},t.prototype.setPlugin2Camera=function(t){this.triggeredLoop=!0,this.activeInput=this.image,this.camera=t,this.connected=!0,this.plugin2.setCamera(this.p2Cameras[t])},t.prototype.setCamera=function(t){null!==this.camera&&this.camera==t||(this.stopCamera(),this.p2Cameras[t]?this.setPlugin2Camera(t):this.setHTML5Camera(t))},t.prototype.pause=function(){this.paused=!0},t.prototype.unpause=function(){this.paused=!1},t.prototype.stopCamera=function(){if(this.plugin2&&this.plugin2.stopCamera&&this.plugin2.stopCamera(),this.video.src="",this.image.src="",this.activeInput=null,this.stream&&this.stream.getTracks)for(var t=0,e=this.stream.getTracks();t<e.length;t++)e[t].stop();else this.stream&&this.stream.stop&&this.stream.stop();this.blitter.clearVideo(),this.connected=!1,this.camera=null,this.drawn=!1},t.prototype.getJpegDfd=function(){return this.drawn?(this.jpegDfd||(this.jpegDfd=l.newDeferred()),this.jpegDfd.promise):l.newDeferred(!1).promise},t.create=function(t,e,n,r){return i(this,void 0,void 0,function(){var i;return o(this,function(o){switch(o.label){case 0:return[4,(i=new this(t,e,n,r))._readyDfd];case 1:return o.sent(),[2,i]}})})},t}();!function(t){t.Rotate=p.CameraRotate}(d||(d={})),t.exports=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(t){void 0===t&&(t={});for(var e=0,n=r.keys(t);e<n.length;e++){var i=n[e];this[i]=t[i]}};e.Item=i},function(t,e,n){"use strict";var r=n(165);t.exports=r.FormDescription},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(e){void 0===e&&(e={}),this.choices=this.choices||[],r.defaults(e,t.defaults);for(var n=0,i=r.keys(e);n<i.length;n++){var o=i[n];this[o]=e[o]}}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},set:function(t){this._label=String(t)},enumerable:!0,configurable:!0}),t.defaults={ignore:!1},t}();e.ItemDescription=i},function(t,e,n){"use strict";var r={bg:n(124).trim()};t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.isLessThan=function(t,e){for(var n=t.split(".");n.length<4;)n.push("0");for(var i=e.split(".");i.length<4;)i.push("0");for(var o=r.map(n,function(t){return parseInt(t,10)||0}),s=r.map(i,function(t){return parseInt(t,10)||0}),a=0;a<4;++a){if(o[a]<s[a])return!0;if(o[a]>s[a])return!1}return!1}},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(34),o=n(18),s=n(5),a=n(20),c=n(38),u=n(19),l=function(t){function e(e){t.call(this,e),this.destination=e}return r(e,t),e}(o.Subscriber);e.SubjectSubscriber=l;var p=function(t){function e(){t.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return r(e,t),e.prototype[u.rxSubscriber]=function(){return new l(this)},e.prototype.lift=function(t){var e=new f(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new a.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new a.ObjectUnsubscribedError;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new a.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),s.Subscription.EMPTY):this.isStopped?(t.complete(),s.Subscription.EMPTY):(this.observers.push(t),new c.SubjectSubscription(this,t))},e.prototype.asObservable=function(){var t=new i.Observable;return t.source=this,t},e.create=function(t,e){return new f(t,e)},e}(i.Observable);e.Subject=p;var f=function(t){function e(e,n){t.call(this),this.destination=e,this.source=n}return r(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):s.Subscription.EMPTY},e}(p);e.AnonymousSubject=f},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(35),o=n(5),s=n(37),a=n(19),c=function(t){function e(n,r,i){switch(t.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=s.empty;break;case 1:if(!n){this.destination=s.empty;break}if("object"==typeof n){n instanceof e?(this.destination=n,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new u(this,n));break}default:this.syncErrorThrowable=!0,this.destination=new u(this,n,r,i)}}return r(e,t),e.prototype[a.rxSubscriber]=function(){return this},e.create=function(t,n,r){var i=new e(t,n,r);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this},e}(o.Subscription);e.Subscriber=c;var u=function(t){function e(e,n,r,o){var a;t.call(this),this._parentSubscriber=e;var c=this;i.isFunction(n)?a=n:n&&(a=n.next,r=n.error,o=n.complete,n!==s.empty&&(c=Object.create(n),i.isFunction(c.unsubscribe)&&this.add(c.unsubscribe.bind(c)),c.unsubscribe=this.unsubscribe.bind(this))),this._context=c,this._next=a,this._error=r,this._complete=o}return r(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber;if(this._error)e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else{if(!e.syncErrorThrowable)throw this.unsubscribe(),t;e.syncErrorValue=t,e.syncErrorThrown=!0,this.unsubscribe()}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){throw this.unsubscribe(),t}},e.prototype.__tryOrSetError=function(t,e,n){try{e.call(this._context,n)}catch(e){return t.syncErrorValue=e,t.syncErrorThrown=!0,!0}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(c)},function(t,e,n){"use strict";var r=n(8).root.Symbol;e.rxSubscriber="function"==typeof r&&"function"==typeof r.for?r.for("rxSubscriber"):"@@rxSubscriber",e.$$rxSubscriber=e.rxSubscriber},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(t){function e(){var e=t.call(this,"object unsubscribed");this.name=e.name="ObjectUnsubscribedError",this.stack=e.stack,this.message=e.message}return r(e,t),e}(Error);e.ObjectUnsubscribedError=i},function(t,e,n){"use strict";var r=n(0),i=(n(79),n(40)),o=n(1);t.exports=function(t){var e=o.newDeferred(),n=!1,s=t.getChallenge(),a=document.URL,c=-1,u=-1,l=0,p=5,f={challenge:s,url:a};return r.extend(f,i.getData()),i.setNum(i.SCAN_COUNT,0),function(){let r="";n||(r=unescape(r),t.setChallengeResponse(r),e.resolve(t),n=!0),-1!=c&&(clearTimeout(c),c=-1),-1!=u&&(clearTimeout(u),u=-1),c=++l<=p?setTimeout(r,1e3):-1}(),setTimeout(function(){n||e.reject(new Error("Timed out"))},15e3),e.promise}},function(t,e,n){(function(e){!function(n){function r(){}function i(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function o(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void a(e.promise,t)}s(e.promise,r)}else(1===t._state?s:a)(e.promise,t._value)})):t._deferreds.push(e)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof i)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void l((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){a(t,e)}var r,o}function a(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&i._immediateFn(function(){t._handled||i._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)o(t,t._deferreds[e]);t._deferreds=null}function u(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function l(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,a(e,t))})}catch(t){if(n)return;n=!0,a(e,t)}}var p=setTimeout;i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){var n=new this.constructor(r);return o(this,new u(t,e,n)),n},i.all=function(t){var e=Array.prototype.slice.call(t);return new i(function(t,n){function r(o,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(t){r(o,t)},n)}e[o]=s,0==--i&&t(e)}catch(t){n(t)}}if(0===e.length)return t([]);for(var i=e.length,o=0;o<e.length;o++)r(o,e[o])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(t){return new i(function(e,n){n(t)})},i.race=function(t){return new i(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},i._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){p(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},t.exports?t.exports=i:n.Promise||(n.Promise=i)}(this)}).call(this,n(80).setImmediate)},function(t,e,n){"use strict";var r={},i=function(t){t=t.toLowerCase();var e=/(edge)[ \/]([\w.]+)/.exec(t)||/(opr)[\/]([\w.]+)/.exec(t)||/(chrome)[ \/]([\w.]+)/.exec(t)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[],n=/(ipad)/.exec(t)||/(iphone)/.exec(t)||/(ipod)/.exec(t)||/(android)/.exec(t)||/(windows phone)/.exec(t)||/(win)/.exec(t)||/(mac)/.exec(t)||/(linux)/.exec(t)||/(cros)/i.exec(t)||[];return{browser:e[3]||e[1]||"",version:e[2]||"0",platform:n[0]||""}}(window.navigator.userAgent);i.browser&&(r[i.browser]=!0,r.version=i.version,r.versionNumber=parseInt(i.version,10)),i.platform&&(r[i.platform]=!0),(r.android||r.ipad||r.iphone||r["windows phone"])&&(r.mobile=!0),(r.ipad||r.iphone||r.ipod)&&(r.ios=!0),(r.cros||r.mac||r.linux||r.win)&&(r.desktop=!0),(r.chrome||r.opr||r.safari)&&(r.webkit=!0),r.rv&&(i.browser="msie",r.msie=!0),r.opr&&(i.browser="opera",r.opera=!0),r.safari&&r.android&&(i.browser="android",r.android=!0),void 0!==window.external&&void 0!==window.external.msActiveXFilteringEnabled&&window.external.msActiveXFilteringEnabled()&&(r.pluginsDisabled=!0),r.msie&&!function(){var t=null,e=null;try{new ActiveXObject("")}catch(e){t=e.name}try{e=!!new ActiveXObject("htmlfile")}catch(t){e=!1}return"ReferenceError"==t||0!=e}()?r.pluginsDisabled=!0:r.chrome&&parseInt(window.navigator.appVersion.match(/Chrome\/(\d+)\./)[1],10)>=42?r.pluginsDisabled=!0:r.mozilla&&r.versionNumber>=52?(r.versionNumber>52||window.navigator.plugins.length<=1)&&(r.pluginsDisabled=!0):r.safari&&parseFloat(window.navigator.appVersion.match(/Version\/([0-9\.]+)/)[1])>=12&&(r.pluginsDisabled=!0),r.name=i.browser,r.platform=i.platform,t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.None=0]="None",t[t.Left90=1]="Left90",t[t.Full180=2]="Full180",t[t.Right90=3]="Right90"}(e.CameraRotate||(e.CameraRotate={}))},function(t,e,n){"use strict";function r(t){var e=t.split(".");return 1===e.length||""===e[0]&&2===e.length?"":e.pop().toLowerCase()}var i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},s=n(1),a=n(0),c=n(128),u=n(130),l=n(131),p=n(132),f=n(2),h=n(45),d=n(26),y=f.get(),m=s.newDeferred();m.resolve();var g=m.promise,v={ImgReader:c,RawReader:u},b={},w={raw:"RawReader",jpg:"ImgReader",jpeg:"ImgReader",gif:"ImgReader",png:"ImgReader",svg:"ImgReader",bmp:"ImgReader"},_=function(){function t(t){this.curObj=null,this.error=null,y.info("Creating fileQueue to handle array: ",t),this.files=a.toArray(t)}return t.prototype.next=function(){if(this.error instanceof Error&&(this.curObj=null),this.curObj&&(this.curObj.next()||(this.curObj.destroy(),this.curObj=null)),!this.files.length&&!this.curObj)return!1;if(!this.curObj){var t=this.files.shift(),e=r(t.name),n=(i=w[e])?v[i]:null;n?(this.curObj=new n(t),this.curObj.next(),this.error=null):this.error=new Error(t.name)}var i;return!!this.curObj||!!this.error},t.prototype.current=function(){return this.curObj},t}(),x=function(){function t(t,e,n){this.fileArray=t,this.displayFunc=e,this.processFunc=n,this.fileQ=new _(this.fileArray)}return t.prototype.next=function(t,e){return i(this,void 0,void 0,function(){var n,r,i,a,c,u,p,f,m,g,v;return o(this,function(o){switch(o.label){case 0:return this.fileQ.next()?(n=this.fileQ.current(),(r=this.fileQ.error)instanceof Error?(y.warn("Could not process file: ",r.toString()),t([{error:!0,type:"fileReader",msg:r.message}]),[3,11]):[3,1]):(y.info("Finished processing files"),[2,!1]);case 1:i=[],a=e?[h.configurations[0]]:h.configurations,c=!0,u=0,p=a,o.label=2;case 2:if(!(u<p.length))return[3,10];f=p[u],o.label=3;case 3:return o.trys.push([3,8,,9]),0!==f.size||n.supportsNativeRes?[3,4]:(y.warn("Could not process at native resolution for file: ",n.toString()),[3,7]);case 4:return[4,n.getData(f.size)];case 5:return m=o.sent(),l.detectBW(m)&&i.push({error:!0,type:"bw",fileName:n.getName()}),d.darken(m.data.data,f.darkness),y.info("Read file: ",n.getName()),c&&(c=!1,this.displayFunc(m.obj)),[4,s.PromiseAll([this.processFunc(m.data)])];case 6:(g=o.sent()[0])?i.push(JSON.parse(g.replace(/'/g,'"'))):(y.info("No output for "+n.getName()+"; rejecting"),i.push({error:!0,type:"noOutput",fileName:n.getName()})),o.label=7;case 7:return[3,9];case 8:return v=o.sent(),y.info("Could not read file: ",n.getName(),"with error:",v.toString()),i.push({error:!0,type:"readError",fileName:n.getName(),msg:v.toString()}),[3,9];case 9:return u++,[3,2];case 10:t(i),o.label=11;case 11:return[2,!0]}})})},t.getSupportedTypes=function(){return a.keys(w)},t._registerFileReader=function(t,e){v[t]=e},t.registerFileHandler=function(t,e){a.each(t,function(t){w[t]=e})},t.ensureFileLoaders=function(t){var e=a.map(t,function(t){return r(t.name)}),n=a.map(e,function(t){return function(t){if(w[t]){if(v[w[t]])return g;if(b[w[t]])return b[w[t]].promise;var e=s.newDeferred();return b[w[t]]=e,p.l([w[t],function(){b[w[t]]==e&&delete b[w[t]],e.resolve()}]),e.promise}return g}(t)});return s.PromiseAll(n)},t}();t.exports=x},function(t,e,n){"use strict";function r(t,e,n,r){return n+r*t}function i(t,e,n,r,i,a){return a?s(t,e,n,r,i):o(t,e,n,r,i)}function o(t,e,n,i,o){i<0&&(i=0),i>=e&&(i=e-1),o<0&&(o=0),o>=n&&(o=n-1);var s=r(e,0,i,o);return(t[s*=4]+t[s+1]+t[s+2])/3}function s(t,e,n,r,i){return(o(t,e,n,r,i)+o(t,e,n,r-1,i)+o(t,e,n,r+1,i)+o(t,e,n,r,i-1)+o(t,e,n,r,i+1))/5}function a(t,e){return t>e?255*(t-e)/(255-e):0}Object.defineProperty(e,"__esModule",{value:!0}),e.getIdx=r,e.getPixel=i,e.getGrayscalePixel=o,e.getBlurredPixel=s,e.getGrayscaleBuffer=function(t,e,n,o){for(var s=new Uint8Array(t.length/4),a=0;a<e;++a)for(var c=0;c<n;++c)s[r(e,0,a,c)]=i(t,e,n,a,c,o);return s},e.darken=function(t,e){if(!e)return t;for(var n=0;n<t.length;n+=4)t[n]=a(t[n],e),t[n+1]=a(t[n+1],e),t[n+2]=a(t[n+2],e);return t}},function(t,e,n){"use strict";function r(t){for(var e=t;e.parentNode;)e=e.parentNode;return e}Object.defineProperty(e,"__esModule",{value:!0});var i=n(47),o=n(0);e.domLoaded=function(t){var e;if(t=o.once(t),i.hasGCMobile()||!document.readyState||"complete"!=(e=document.readyState)&&"interactive"!=e&&"loaded"!=e)if(i.hasGCMobile())window.gcmobilesdk?setTimeout(t,0):window.gcmobilesdk_loadCallback=t;else{if(document.addEventListener)document.addEventListener("DOMContentLoaded",t,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var n=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(t(),clearInterval(n))},10);var r=t;if(window.onload){var s=window.onload;r=function(){s.apply(this,arguments),t.apply(this,arguments)}}window.onload=r}else setTimeout(t,0)},e.findUltimateAncestor=r,e.isInDOMTree=function(t){return!!r(t).body},e.$=function(t){return document.getElementById(t)}},function(t,e,n){"use strict";var r;r||(r={}),t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(e){void 0===e&&(e={}),r.defaults(e,t.defaults);for(var n=0,i=r.keys(e||{});n<i.length;n++){var o=i[n];this[o]=e[o]}}return t.defaults={zone:0},t}();e.BlockDescription=i},function(t,e,n){"use strict";var r=n(0);t.exports=function(t){for(var e=r.clone(t).sort(function(t,e){return t-e}),n=0,i=0,o=0,s=0,a=0,c=0,u=0,l=e;u<l.length;u++)n+=y=l[u],i+=y*y,o+=1;for(var p=1/0,f=null,h=0,d=e;h<d.length;h++){var y;if(n-=y=d[h],i-=y*y,0!=(o-=1)){var m=i/o-n*n/(o*o),g=(a+=y*y)/(c+=1)-(s+=y)*s/(c*c),v=(c*g+o*m)/(o+c);m<0&&(m=0),v<p&&(p=v,f={threshold:y,threshold_unmarked_sigma:(y-s/c)/Math.sqrt(g),marked_average:n/o,marked_count:o,marked_sigma:Math.sqrt(m),unmarked_average:s/c,unmarked_count:c,unmarked_sigma:Math.sqrt(g)})}}return f}},function(t,e,n){"use strict";function r(t,e){var n=i.find(t,function(t){return a[t]});if(n)return new Promise(function(t){return t(a[n])});var r=JSON.stringify(t);if(u[r])return new Promise(function(t){return t(u[r])});var s=e?o.forms2:o.forms,c=e?i.map(t,function(t){return String(t)}):i.map(t,function(t){return Number(t)}),l=s.fetchFormData(c).then(function(e){if(!e||1==e.empty)throw i.each(t,function(t){a[""+t]=null}),new Error("Form Data Error: Form not recognized");for(var n=function(t){i.each(t.form_id,function(n,r){if(2==e.desc_v){e.form_description;var i=void 0,o=void 0,s=void 0,c=void 0,u=void 0;if("tabular"===e.type){var l=e.form_description.length||1,p=t.offsets.length||1;u=r%l;var f=Math.floor(r/l)%p,h=t.rows&&t.rows.length;o=t.offsets[f],c=(t.offsets.length-1>f?t.offsets[f+1]:h)-o,s=e.form_description[u],i=0;for(var d=0;d<u;d++)i+=e.form_description[d].length}else i=t.offsets[r],s=e.form_description[r];var y={desc_v:e.desc_v,form_id:n,page:r+1,pageCount:t.form_id.length,startOffset:i,rowCount:c,rowOffset:o,form_description:s,instance_data:t.data&&JSON.parse(t.data),rows:t.rows,batch_data:e.batch_data&&JSON.parse(e.batch_data),batch_form_description:e.form_description,exam_version:t.exam_version,type:e.type};a[""+n]=y}else e.form_description,!(y={desc_v:e.desc_v,form_id:n,page:r+1,pageCount:t.form_id.length,startOffset:t.offsets[r],form_description:e.form_description[r],instance_data:t.data&&JSON.parse(t.data),batch_data:e.batch_data&&JSON.parse(e.batch_data),batch_form_description:e.form_description,exam_version:t.exam_version}).exam_version&&y.batch_data&&y.batch_data.exam_version&&(y.exam_version=y.batch_data.exam_version.toString()),a[""+n]=y})},r=0,o=e.instances;r<o.length;r++)n(o[r]);var s=i.find(t,function(t){return a[t]}),c=a[s];return i.each(t,function(t){a[""+t]=c}),c},function(t){throw delete u[r],t});return u[r]=l,l}var i=n(0),o=n(28),s=n(175),a=n(54),c=n(1),u={};t.exports=function(t){if(t.barcodes)return r([t.barcodes],!0);if(t.fc_blocks&&1==t.fc_blocks.length){var e=t.fc_blocks[0],n=s.decodeFC(e.intensities,a);return n&&n.length?r(n,!1):c.rejected(new Error("Form Data Error: Could not read form code."))}return c.newDeferred(null).promise}},function(t,e,n){"use strict";var r=n(0),i=n(4),o=function(){function t(t){this.formMode=t,this.lastFailure=""}return t.prototype.findIDBlock=function(t){var e=r.max(t.blocks,function(t){return t.right-t.top});return e&&10===e.rows?e:null},t.prototype.createIDBlockDescription=function(t){return new i.FormDescription.NumberBlockDescription({type:"number",form_area:"ids",choices:["0","1","2","3","4","5","6","7","8","9"],zone:0,row:t.row,col:t.col,rows:t.rows,cols:t.cols,label:"GradeCam ID"})},t.prototype.numberRange=function(t,e){var n=r.range(t,t+e);return r.map(n,function(t){return String(t)})},t.prototype.letterRange=function(t,e){var n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],i=r.indexOf(n,t);return r.map(r.range(i,i+e),function(t){return n[t]})},t}();t.exports=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=["_addFormToCache","_debugScan","_debugScanById","_setLogLevel","_simulateScan","bind","clearTyperStrings","enableHighRes","getCameraList","getElement","getGCI","getGciAsync","getJpegAsync","getJPEGImage","getLastFormDescription","getMode","getOption","getOptions","getTyperAvailability","getTyperOptions","getTyperConfig","getExtensionVersion","getVersion","initTyper","isAtLeastVersion","isInstalled","requireSupport","requireVersion","scanFilesAsync","setActive","setDesiredVersion","setLicensingInfo","setMode","setModuleOption","setModuleOrder","setOptions","setReturnURL","setShowMessages","setTransparency","setTyperStrings","setWebTyperId","getWebTyperLink","copyTyperToClipboard","setValidateCallback","startCamera","stopCamera","supports","unbind"],i=["curCamera$","formcode$","scan$"],o=null;e.getExposedPublicAPI=function(t){if(o)return o;o={};for(var e=0,n=r;e<n.length;e++){var s=n[e];o[s]=t[s].bind(t)}for(var a=0,c=i;a<c.length;a++){var u=c[a];o[u]=t[u]}return o.getSDK=function(e){return"internal"===e?t:o},o}},function(t,e,n){"use strict";var r=n(8),i=n(64),o=n(69),s=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r=this.operator,o=i.toSubscriber(t,e,n);if(r?r.call(o,this.source):o.add(this.source?this._subscribe(o):this._trySubscribe(o)),o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.syncErrorThrown=!0,t.syncErrorValue=e,t.error(e)}},t.prototype.forEach=function(t,e){var n=this;if(e||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?e=r.root.Rx.config.Promise:r.root.Promise&&(e=r.root.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,r){var i;i=n.subscribe(function(e){if(i)try{t(e)}catch(t){r(t),i.unsubscribe()}else t(e)},r,e)})},t.prototype._subscribe=function(t){return this.source.subscribe(t)},t.prototype[o.observable]=function(){return this},t.create=function(e){return new t(e)},t}();e.Observable=s},function(t,e,n){"use strict";e.isFunction=function(t){return"function"==typeof t}},function(t,e,n){"use strict";e.errorObject={e:{}}},function(t,e,n){"use strict";e.empty={closed:!0,next:function(t){},error:function(t){throw t},complete:function(){}}},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(t){function e(e,n){t.call(this),this.subject=e,this.subscriber=n,this.closed=!1}return r(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(n(5).Subscription);e.SubjectSubscription=i},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(t){if(u===setTimeout)return setTimeout(t,0)
;if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function o(){d&&f&&(d=!1,f.length?h=f.concat(h):y=-1,h.length&&s())}function s(){if(!d){var t=i(o);d=!0;for(var e=h.length;e;){for(f=h,h=[];++y<e;)f&&f[y].run();y=-1,e=h.length}f=null,d=!1,function(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}(t)}}function a(t,e){this.fun=t,this.array=e}function c(){}var u,l,p=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(t){u=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var f,h=[],d=!1,y=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new a(t,e)),1!==h.length||d||i(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e,n){"use strict";var r,i,o=n(41),s=n(0);window.localStorage?(r=function(){localStorage.setItem("SCAN_META",JSON.stringify(this.fields))},i=function(){return JSON.parse(localStorage.getItem("SCAN_META"))}):(r=function(){o.set("SCAN_META",JSON.stringify(this.fields),365)},i=function(){return JSON.parse(o.get("SCAN_META"))});var a=new(function(){function t(t){this.fields={},this.SCAN_COUNT="sc",s.extend(this.fields,t||{}),this.saveMeta=r,this.loadMeta=i,this.fields=this.loadMeta()||this.fields}return t.prototype.saveMeta=function(){},t.prototype.loadMeta=function(){},t.prototype.getNum=function(t){var e=this.fields[t]||"0";return parseInt(e,10)},t.prototype.setNum=function(t,e){this.fields[t]=""+e},t.prototype.get=function(t){return this.fields[t]},t.prototype.set=function(t,e){this.fields[t]=e},t.prototype.increment=function(t){this.setNum(t,this.getNum(t)+1)},t.prototype.save=function(){this.saveMeta()},t.prototype.getData=function(){return this.fields},t}());t.exports=a},function(t,e,n){"use strict";var r;!function(t){function e(t,e,n,r){var i=new Date,o="",s=typeof e,a="";if(r=r||"/",n&&(i.setTime(i.getTime()+24*n*60*60*1e3),o="; expires="+i.toUTCString()),"object"===s&&"undefined"!=s){if(!("JSON"in window))throw"Bummer, your browser doesn't support JSON parsing.";a=JSON.stringify({v:e})}else a=encodeURIComponent(e);document.cookie=t+"="+a+o+"; path="+r}t.set=e,t.get=function(t){for(var e=t+"=",n=document.cookie.split(";"),r="",i={},o=0;o<n.length;o++){for(var s=n[o];" "==s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(e)){if("{"==(r=s.substring(e.length,s.length)).substring(0,1)&&"v"in(i=JSON.parse(r)))return i.v;if("undefined"==r)return;return decodeURIComponent(r)}}return null},t.remove=function(t){e(t,"",-1)}}(r||(r={})),t.exports=r},function(t,e,n){"use strict";function r(){var t=this,e=b[t._pid],n=t.el;if((_=!_)&&n&&n.style&&(t.isVisible?(n.style.width=_?"99.999%":"100%",n.style.height="100%"):n.style.width=n.style.height="1px"),!t.paused)if(e.callQ.length)e.callQ.shift()();else{var r=t.plugin.getScan();if(e.doGetVidSize){var i=t.plugin.getVideoSize();try{var o=JSON.parse(i);o[0]&&o[1]&&t.trigger("videoSize",o[0],o[1])}catch(t){}}r&&p.defer(function(){t.trigger("scan",JSON.parse(r.replace(/'/g,'"')))})}t.active?t.inhibitProcessing(0):t.inhibitProcessing(9999),e.ivId=setTimeout(e.poll,w)}function i(t,e,n){var r=0,i=0,o=[];return function(s){function a(){!1!==s.next(c,!0)||e&&e(r,i,o)}var c=function(e){if(p.every(e,function(t){return t.error})||p.any(e,function(t){return"bw"==t.type})){var s="unknown",c=void 0,u=p.find(e,function(t){return"readError"==t.type}),l=p.find(e,function(t){return"fileReader"==t.type}),f=p.find(e,function(t){return"file"==t.type}),h=p.find(e,function(t){return"bw"==t.type}),d=p.find(e,function(t){return"noOutput"==t.type});l?(s="File "+l.msg+" appears to have an unsupported format.",c=l.msg):f?(s="File "+f.fileName+" appears to be corrupted or have an unsupported format.",c=f.fileName):h?(s="File "+h.fileName+" appears to be scanned in black and white and cannot be accurately graded.",s+="Please rescan using grayscale or color.",c=h.fileName):d?(s="File "+d.fileName+" does not appear to have a form in it.",c=d.fileName):u&&(s="Could not read "+u.fileName+" -- "+u.msg),i++,o.push(c),n&&n(s)}else{var y=e&&1===e.length&&e[0],g=m.newDeferred();t.trigger("scan",y,{scansRequired:1,scansMax:1,scansToValidate:1,successObj:g}),g.promise.then(function(){r++},function(){i++,o.push(""),n&&n("Could not read form in this image.")})}var v;v=a,b[t._pid].callQ.push(v)};a()}}var o,s=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},u=n(3),l=n(24),p=n(0),f=n(15),h=n(83),d=n(7),y=n(2),m=n(1),g=y.get(),v=0,b={},w=25,_=!0,x=!1,S="",k=l.CameraRotate.None,O=!1,I=function(t){function e(e,n){var i=t.call(this)||this;i.plugin=null,i.el=null,i.isVisible=!1,i.active=!0,i.paused=!1,i.videoWidth=640,i.videoHeight=480,i.typerScores=[],i.eventHost=null,i.currentCameraInfo=new d.ReplaySubject(1),i.plugin=e,i.el=n;var o=e;(O=!e.bind)&&(o=i.eventHost=new u.ClassTS);var s=i._pid=v++;return b[s]={poll:p.bind(r,i),stop:!1,ivId:-1,callQ:[]},i.fileScanHost=h(e),o.bind("scan",function(t){p.defer(function(){i.trigger("scan",JSON.parse(t.replace(/'/g,'"')))})}),o.bind("cameraVisible",function(t){i.isVisible=t,i.trigger("cameraVisible",t)}),o.bind("videoSize",function(t,e){i.videoWidth=t,i.videoHeight=e,i.trigger("videoSize",t,e)}),O&&o.trigger("cameraVisible",!0),i.plugin.currentCameraInfo&&i.plugin.currentCameraInfo.subscribe(i.currentCameraInfo),i}return s(e,t),e.prototype.setTransparency=function(){},e.prototype.getCameraList=function(){return JSON.parse(this.plugin.getCameraList())},e.prototype.getVersionMajor=function(){return this.plugin.getVersionMajor()},e.prototype.getVersionMinor=function(){return this.plugin.getVersionMinor()},e.prototype.startCamera=function(){return x=!0,O&&this.eventHost.trigger("cameraVisible",!0),this.plugin.setCamera(S,k)},e.prototype.stopCamera=function(){return x=!1,O&&this.eventHost.trigger("cameraVisible",!1),this.plugin.stopCamera()},e.prototype.setCamera=function(t,e){O&&this.eventHost.trigger("cameraVisible",!0),x&&S==t&&k==e||(x=!0,this.supports("rotate")?(!0===e?e=l.CameraRotate.Full180:!1===e&&(e=l.CameraRotate.None),this.plugin.setCamera(t,e)):(e=!0===e||e==l.CameraRotate.Full180,this.plugin.setCamera(t,e)),S=t,k=e)},e.prototype.initTyper=function(t,e,n,r){this.plugin.supports("rkeyDelay")?this.plugin.initTyper(t,e,n,r):this.plugin.initTyper(t,Math.max(r,e),n)},e.prototype.setTyperStrings=function(t){this.supports("setTyperStrings")&&this.plugin.setTyperStrings(t),this.typerScores=t.slice(0)},e.prototype.clearTyperStrings=function(){this.supports("setTyperStrings")&&this.plugin.clearTyperStrings(),this.typerScores=[]},e.prototype.inhibitProcessing=function(t){this.plugin.inhibitProcessing(t)},e.prototype.getJPEGImage=function(){return this.plugin.getJPEGImage()},e.prototype.getCurrentImage=function(){return this.plugin.getCurrentImage()},e.prototype.getJpegAsync=function(t){var e=this;this.plugin.getJpegAsync?this.plugin.getJpegAsync(t):p.defer(function(){t(e.plugin.getJPEGImage())})},e.prototype.getGciAsync=function(t){var e=this;this.plugin.getGciAsync?this.plugin.getGciAsync(t):p.defer(function(){t(e.plugin.getCurrentImage())})},e.prototype.enableHighRes=function(t){return!!this.plugin.enableHighRes&&this.plugin.enableHighRes(t)},e.prototype._shutdown=function(){var t=b[this._pid];this.plugin.stopCamera(),this.unbind("scan"),clearInterval(t.ivId),t.ivId=-1,t.stop=!0},e.prototype.startPolling=function(){var t=b[this._pid];-1!=t.ivId&&clearTimeout(t.ivId),t.doGetVidSize=this.supports("videoSize"),t.poll()},e.prototype.pause=function(){this.paused=!0},e.prototype.unpause=function(){this.paused=!1},e.prototype.setActive=function(t){this.active=!!t},e.prototype.getFileScanner=function(){return this.fileScanHost},e.prototype.processImageFiles=function(t,e){return O&&this.eventHost.trigger("cameraVisible",!0),this.fileScanHost.createDirectoryScanner(i(this,t,e))},e.prototype.processImageFile=function(t,e){return O&&this.eventHost.trigger("cameraVisible",!0),this.fileScanHost.createFileScanner(i(this,t,e))},e.prototype.processImageFileArray=function(t,e,n){return O&&this.eventHost.trigger("cameraVisible",!0),this.fileScanHost.loadFromFileArray(i(this,e,n))},e.prototype.scanFilesAsync=function(t,e){return function(t,e,n){function r(e){return a(this,void 0,void 0,function(){function r(){return a(this,void 0,void 0,function(){var o,s;return c(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.next(function(t){n(t,r)})];case 1:return o=a.sent(),[3,3];case 2:return s=a.sent(),g.error("Uncaught filescanner error:",s),n(s),[3,3];case 3:return o||(i&&t.startCamera(),n(null,null)),[2]}})})}var o;return c(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e?[4,r()]:(n(new Error("Could not create scanner")),[2]);case 1:return t.sent(),[3,3];case 2:return o=t.sent(),g.error("Error scanning files:",o),n(o),[3,3];case 3:return[2]}})})}var i=x;t.stopCamera(),O&&t.eventHost.trigger("cameraVisible",!0);var o=t.getFileScanner();if(!o)throw new Error("Your web browser does not support file scanning");if(e&&!o.canUseFileArray())throw new Error("Your web browser does not fully support drag and drop file scanning");return e?o.loadFromFileArray(r,e):o.createFileScanner(r),!0}(this,t,e)},e.prototype.getVersion=function(){try{if(this.plugin.getVersion)return this.plugin.getVersion()}catch(t){}return this.getVersionMajor()+"."+this.getVersionMinor()+".0.0"},e.prototype.isAtLeastVersion=function(t){return!f.isLessThan(this.getVersion(),t)},e.prototype.displayObject=function(t){return this.plugin.displayObject(t)},e.prototype.processDirect=function(t){return this.plugin.processDirect(t)},e.prototype.getSpeedHandicap=function(){return 1},e.prototype.supports=function(t){var e=this.plugin;switch(t){case"versionString":return this.isAtLeastVersion("1.7.0.0");case"processImageFiles":return this.isAtLeastVersion("1.5.0.0");case"liveOptions":case"stopCamera":return this.isAtLeastVersion("1.7.0.0");case"html5Files":var n=this.getFileScanner();return n&&n.canUseFileArray();case"flipCamera":return!0;default:return!!e.supports&&e.supports(t)}},e.prototype.getNeedsTransparency=function(){return!1},e}(u.ClassTS);t.exports=I},function(t,e,n){"use strict";function r(t){void 0===t&&(t=w);var e=d.newDeferred();if(y)return e.resolve(y),e.promise;var n="_fwcb_"+Math.floor(1e8*Math.random());window[n]=function(t){y=t.wyrmhole,clearTimeout(r),e.resolve(y)};var r=setTimeout(function(){e.reject(new Error("timeout"))},t);return window.postMessage({firebreath:"GradeCam",callback:n},"*"),e.promise}function i(){return u(this,void 0,void 0,function(){function t(){e&&e.destroy()}var e,n;return l(this,function(i){switch(i.label){case 0:return[4,r()];case 1:return[4,i.sent().create()];case 2:if(!(e=i.sent()))return[2,[]];i.label=3;case 3:return i.trys.push([3,5,,6]),[4,e.listPlugins()];case 4:return n=i.sent(),t(),[2,n];case 5:return i.sent(),t(),[2,[]];case 6:return[2]}})})}function o(){return u(this,void 0,void 0,function(){var t,e;return l(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,i()];case 1:return t=n.sent(),[2,p.any(t,function(t){return p.any(t.mimetypes,function(t){return"application/x-gcplugin2"==t})})];case 2:throw e=n.sent(),v.error("Could not query plugin; gradebook transfer may not work",e),e;case 3:return[2]}})})}function s(t){setTimeout(function e(){return u(this,void 0,void 0,function(){var n,r;return l(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,o()];case 1:return(n=i.sent())?t(n):setTimeout(e,1e3),[3,3];case 2:return r=i.sent(),v.warn("Could not find plugin:",r),setTimeout(e,2e3),[3,3];case 3:return[2]}})})},1e3)}function a(t){return void 0===t&&(t=w),u(this,void 0,void 0,function(){var e,n,i;return l(this,function(o){switch(o.label){case 0:return b?[2,b]:(e=window.FireWyrmJS)?[4,r(t)]:[3,3];case 1:return n=o.sent(),v.info("Detected plugin2 extension; attempting to connect to wyrmhole"),[4,n.create(g)];case 2:return i=o.sent(),v.info("Connected to wyrmhole and loaded plugin. Starting FireWyrmJS",g),[2,b=new e(i)];case 3:throw new Error("Could not load fwjs")}})})}function c(){return u(this,void 0,void 0,function(){var t,e;return l(this,function(r){switch(r.label){case 0:return[4,a(_)];case 1:return(t=r.sent())?[4,t.create(g,{})]:[3,3];case 2:return e=r.sent(),n(6).plugin2.installed=!0,[2,e];case 3:return[2,null]}})})}var u=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},p=n(0),f=n(2),h=n(23),d=n(1),y=null,m=-1!=document.documentElement.className.indexOf("GCPlugin2"),g="application/x-gcplugin2",v=f.get(),b=null,w=2e3,_=2*w;!function(t){t.detect=o,t.ext_installed=m,t.watchForInstall=s,t.supported=h.chrome&&(h.mac||h.win)}(c||(c={})),h.mozilla&&h.versionNumber>=50&&(h.mac||h.win)&&(c.supported=!0),t.exports=c},function(t,e,n){"use strict";var r=n(0),i=n(58),o=n(127),s=n(1),a=r.template(o);t.exports=function(){function t(){n.reject(new Error("Cancelled"))}var e,n=s.newDeferred(),r=document.createElement("div");r.innerHTML=a();var o=r.querySelector("input[type=file]");i.addEventListener("hide",t),o.addEventListener("change",function(t){e=this.files},!1),r.querySelector("button").addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),n.resolve(e||[])},!1),i.show(r);var c=function(){i.removeEventListener("hide",t),i.hide()};return n.promise.then(c,c),n.promise}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=[];e.configurations=r;var i=function(t){var e,n;switch(t){case"legacy_fast":e=[48e4],n=[0];break;case"legacy_aggressive":e=[48e4,1024e3,192e4],n=[0,50,75,100];break;case"legacy_normal":e=[48e4,192e4],n=[0,75];break;case"fast":e=[0,48e4],n=[0];break;case"aggressive":e=[0,786432,192e4,3145728],n=[0,50,75,100];break;case"high_res":e=[0,1228800,192e4,3145728],n=[0,75];break;case"normal":default:e=[0,48e4,192e4],n=[0,75]}r.length=0;for(var i=0,o=e;i<o.length;i++)for(var s=o[i],a=0,c=n;a<c.length;a++){var u=c[a];r.push({size:s,darkness:u})}};e.setMode=i,i("normal")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.encode=function(t){for(var e,n="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(t),o=i.byteLength,s=o%3,a=o-s,c=0;c<a;c+=3)n+=r[(16515072&(e=i[c]<<16|i[c+1]<<8|i[c+2]))>>18]+r[(258048&e)>>12]+r[(4032&e)>>6]+r[63&e];return 1==s?n+=r[(252&(e=i[a]))>>2]+r[(3&e)<<4]+"==":2==s&&(n+=r[(64512&(e=i[a]<<8|i[a+1]))>>10]+r[(1008&e)>>4]+r[(15&e)<<2]+"="),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hasGCMobile=function(){return"undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&/GradeCamMobile/.test(navigator.userAgent)}},function(t,e,n){"use strict";var r=n(0),i=n(150),o=function(){function t(){}return t.prototype.new=function(e){void 0===e&&(e={}),r.defaults(e,t.defaults),this.update(e)},t.prototype.update=function(t){for(var e=0,n=r.keys(t);e<n.length;e++){var i=n[e];this[i]=t[i]}},t.prototype.toJSON=function(){return console.log("to json"),{type:this.type,exam_length:this.exam_length,auto_length:this.auto_length,exam_versions:this.exam_versions,exam_answer_multiplicities:this.exam_answer_multiplicities,custom_form_description:this.custom_form_description,ignore_formcode_choices:this.ignore_formcode_choices,output_version:this.output_version,numeric_allow_blanks:this.numeric_allow_blanks}},t.defaults={auto_length:!1,exam_versions:0,exam_answer_multiplicities:1,output_version:0,numeric_allow_blanks:!1},t.FormTypeEnum=i,t}();t.exports=o},function(t,e){},function(t,e,n){"use strict";var r=n(0);t.exports=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0,o=e;i<o.length;i++)for(var s=o[i],a=0,c=r.keys(s);a<c.length;a++){var u=c[a];if(!(u in t))if(r.isArray(s[u])){var l=s[u];t[u]=l.slice(0)}else r.isObject(s[u])?(l=r.clone(s[u]),t[u]=l):t[u]=s[u]}}},function(t,e,n){"use strict";function r(){return o||((o=document.createElement("iframe")).style.display="none",o.src=l.formServerComm,document.body.appendChild(o),u=setTimeout(function(){alert("Error communicating with servers; form management will not work"),c.reject()},5e3),o)}function i(t){if(console.log(t.origin,"origin of t"),t.origin==l.formServerDomain){if("ready"==t.data)return clearTimeout(u),void c.resolve();var e,n=function(t){var e=t.indexOf(":");if(-1==e)throw new Error("Malformed message");var n=t.substr(0,e);if(!f[n])throw new Error("Orphan message received!");var r=t.substr(e+1);try{return{dfd:f[n],error:!1,data:JSON.parse(r)}}catch(t){return{dfd:f[n],error:!0,data:t}}}(t.data);n.error?e=n.data:"failed"==n.data.status&&(e=new Error(n.data.message)),e?(e.domain=l.formServerDomain,n.dfd.reject(e)):n.dfd.resolve(n.data.message)}}var o,s=n(160),a=n(1),c=a.newDeferred(),u=-1,l=null,p=0,f={};window.addEventListener?addEventListener("message",i,!1):attachEvent("onmessage",i);var h=!(XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),d=function(){function t(){console.log("====+++"),this.useLegacyAPI=!1;var t="prod";l=s(t),h&&document.body&&document.body.appendChild&&(this.useLegacyAPI=!0,r())}return console.log("====+++1"),t.prototype.sendMessage=function(t,e,n,i,o){var s=p++,u=o?null:c;return o=o||r(),a.PromiseAll([u]).then(function(){var r={command:t,data:e};o.contentWindow.postMessage(function(t,e){return e+":"+JSON.stringify(t)}(r,s),l.formServerDomain);var c=a.newDeferred();return f[s]=c,n&&c.promise.then(n),i&&c.promise.catch(i),c.promise})},t.prototype.printIframe=function(t){window.gcmobilesdk?this.sendMessage("getContent",null,null,null,t).then(function(t){window.gcmobilesdk.command("printIframe",t.content)}):t.contentWindow.postMessage("print","*")},t.prototype.makeFormsRequest=function(t,e,n,r){var i=l.formServerDomain+t,o=new XMLHttpRequest,s=a.newDeferred();return o.onreadystatechange=function(){if(4==o.readyState&&200==o.status)try{var t=JSON.parse(o.responseText);s.resolve(t)}catch(e){e.domain=l.formServerDomain,s.reject(e)}else if(4==o.readyState&&200!=o.status){var e=new Error("Server returned code "+o.status);e.response=o.responseText,e.domain=l.formServerDomain;try{e=JSON.parse(e.response)}catch(t){}s.reject(e)}},e?(o.open("POST",i,!0),o.setRequestHeader("X-Requested-With","GCSDK"),o.setRequestHeader("Content-type","application/json"),o.send(JSON.stringify(e))):(o.open("GET",i,!0),o.send()),n&&s.promise.then(n),r&&s.promise.catch(r),s.promise},t}();t.exports=d},function(t,e,n){"use strict";function r(t){var e=i.flatten(t);if(!(e&&e.length>0))return"";var n=u(e);return 0===n.threshold?"":i.map(t,function(t){return i.findIndex(t,function(t){return t>n.threshold})}).filter(function(t){return t>-1}).join("")}Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(11),s=n(164),a=n(171),c=n(172),u=n(30);e.getMaxIndex=function(t){var e=i.map(t,function(t,e){return{value:e,intensity:t}});return i.max(e,function(t){return t.intensity}).value},e.calculateId=r;var l=function(){function t(t){void 0===t&&(t={}),this.items=[];for(var e=0,n=i.keys(t);e<n.length;e++){var r=n[e];this[r]=t[r]}}return t.prototype.getItemByLabel=function(t){return i.find(this.items,function(e){return e.label===t})},t.prototype.getItemsByType=function(t){return i.select(this.items,function(e){return e.type===t&&!e.ignore})},t.prototype.getItemsByFormArea=function(t){return i.select(this.items,function(e){return e.form_area===t&&!e.ignore})},t.prototype.getIntensityMethods=function(){var t=i.find(this.items,function(t){return t.getIntensityMethods&&!!t.getIntensityMethods()});return t?t.getIntensityMethods():t?t.getIntensityMethods():[]},t.prototype.getFormIdentifier=function(){var t="";i.each(this.getItemsByFormArea("ids"),function(e){var n=r(e.intensities[0]);t+=n});var e=this.fc_data;return e&&e.form_id&&(t+=e.form_id),t.length?t:-Math.random()},t.prototype.hasFormIdentifier=function(){return!!this.getFormIdentifier()},t.prototype.hasClips=function(){var t=this.getItemsByType("clip");return t&&!!t.length},t.Item=o.Item,t.NumberItem=s.NumberItem,t.QuestionItem=a.QuestionItem,t.ClipItem=c.ClipItem,t}();e.StructuredScan=l},function(t,e,n){"use strict";function r(t){return t.label&&" "!=t.label}function i(t,e){t=c.sortBy(t,function(t){return 1e3*t.zone}),e=c.sortBy(e,function(t){return 1e3*t.zone});for(var n=[],r=0,i=0,o=c.zip(t,e);i<o.length;i++){var s=o[i],a=s[0],u=s[1];a&&u&&(n.push({desc:a,scan:u,type:"clip",index:1e3*a.zone+r}),r++)}return c.all(n,function(t){return t.desc.zone==t.scan.zone})?t.length!=n.length?null:n:null}function o(t,e){var n=[],r=c.clone(t),i=c.clone(e),o=c.filter(r,function(t){return"ids"==t.form_area});r=c.difference(r,o),o=c.sortBy(o,function(t){return-t.col});for(var s=[],a=function(t){var e=c.max(i,function(e){return 0!==e.row?-1:e.zone!==t.zone?-1:e.col});s.unshift({desc:t,scan:e}),i=c.without(i,e)},u=0,l=o;u<l.length;u++)a(l[u]);n=n.concat(s);var p=c.sortBy(r,function(t){return 1e3*t.zone+100*t.col+t.row}),f=c.sortBy(i,function(t){return 1e3*t.zone+100*t.col+t.row}),h=0,d=c.zip(p,f);return c.each(d,function(t){var e=t[0],r=t[1];e&&r&&(n.push({desc:e,scan:r,type:"block",index:1e3*e.zone+h}),h++)}),c.all(n,function(t){return t.desc.rows==t.scan.rows&&t.desc.cols==t.scan.cols&&t.desc.zone==t.scan.zone})?t.length!=n.length?null:n:null}var s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(e,"__esModule",{value:!0});var c=n(0),u=n(4),l=n(174),p=n(1),f=n(31);e.matchBlocks=o,e.structure=function(t,e){return s(this,void 0,void 0,function(){var n,s,h,d,y,m,g,v,b,w,_,x,S,k,O,I,C,T,j,D,M,P;return a(this,function(a){switch(a.label){case 0:return t?[4,p.PromiseAll([t,f(e)])]:[2,p.rejected(new Error("Invalid form description"))];case 1:if(n=a.sent(),s=n[0],h=n[1],d=o(s.blocks,e.blocks),y=i(s.clips,e.clips),e.clips&&e.clips.length>0&&!y){for(m=e.clips.shift(),g=0,v=e.blocks;g<v.length;g++)(b=v[g]).zone>m.zone&&b.zone--;for(w=0,_=e.clips;w<_.length;w++)(x=_[w]).zone>m.zone&&x.zone--;d=o(s.blocks,e.blocks),y=i(s.clips,e.clips)}if(!d||!y)return[2,p.rejected(new Error("No matching blocks or clips"))];S=c.sortBy(d.concat(y),function(t){return t.index}),k=new u.StructuredScan({type:s.type,fc_data:h,structure_hash:e.hash()}),O=k.items,I=0,C=S,a.label=2;case 2:if(!(I<C.length))return[3,5];if((T=C[I]).desc.ignore)return[3,4];if("clip"===T.type)O.push(function(t,e){return new u.StructuredScan.ClipItem(c.extend({},t,{image:e.image,type:"clip",form_area:"clip",fdid:"zone"+t.zone,blur:e.blur,skew:e.skew,width:e.width,height:e.height}))}(T.desc,T.scan));else{if(!1===(j=function(t,e){var n=null,i=1,o=e.row,s=e.col;if("questions"==t.type&&0===t.questions.length)return[];if("number"===t.type)return[new u.StructuredScan.NumberItem(c.extend({},t,{type:"number",form_area:t.form_area,block_row:o,block_col:s,intensities:e.getNumberIntensities(),fdid:"zone"+e.zone+"br"+o+"bc"+s}))];if("questions"===t.type){var a=[],l=!1;return c.each(t.questions,function(p,f){l=!0,r(p)?(n=p.label,i=1):i++;var h=new u.StructuredScan.QuestionItem(c.extend({},p,{type:"question",form_area:t.form_area,block_row:o,block_col:s,row:f,intensities:e.getRowIntensities(f),label:r(p)?p.label:n+"(line "+i+")",fdid:"zone"+e.zone+"br"+o+"bc"+s+"r"+f}));a.push(h)}),!!l&&a}return!1}(T.desc,T.scan)))return[2,p.rejected(new Error("Could not structure block"))];for(D=0,M=j;D<M.length;D++)P=M[D],O.push(P)}return[4,l.yieldAsync()];case 3:a.sent(),a.label=4;case 4:return I++,[3,2];case 5:return[2,k]}})})}},function(t,e,n){"use strict";t.exports={}},function(t,e,n){"use strict";function r(t,e){return e?"questions"===(e=u.extend(e,{zone:t.zone})).type?new c.FormDescription.QuestionBlockDescription(e):"number"===e.type?new c.FormDescription.NumberBlockDescription(e):null:null}function i(t){var e=t.exam_answer_multiplicities;if(u.isObject(e)&&!u.isArray(e)){var n=e,r=[];return u.each(n,function(t,e){u.each(t,function(t,n){r[n]||(r[n]={}),r[n][e]=t})}),function(t){return r[t]||1}}return u.isArray(e)?function(t){return e[t]}:function(t){return e||1}}var o,s=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=n(32),c=n(4),u=n(0),l=n(31),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._findBlocks=function(t){var e=this.findIDBlock(t),n=u.without(t.blocks,e);if(!n.length)return null;var r=u.min(n,function(t){return t.left+t.top}),i=this.formMode.exam_versions<=1&&1==this.formMode.exam_length;if(1!==r.rows||i){if(r=null,this.formMode.exam_versions>1)return null}else if(n=u.without(n,r),this.formMode.exam_versions>1&&this.formMode.exam_versions<4&&(this.formMode.exam_versions=4),this.formMode.exam_versions!==r.cols&&this.formMode.exam_versions>1)return null;return 0===n.length?null:{id:e,version:r,answers:n}},e.prototype.getFormDescriptionNoFormCode=function(t){var e=this,n=this._findBlocks(t);if(!n)return this.lastFailure="invalidStructure",null;var r=new c.FormDescription({blocks:[]}),o=r.blocks;if(!n.id)return this.lastFailure="invalidStructure",null;o.push(this.createIDBlockDescription(n.id));var s=i(this.formMode);if(n.version){var a=new c.FormDescription.QuestionBlockDescription({type:"questions",zone:0,row:n.version.row,col:n.version.col,rows:n.version.rows,cols:n.version.cols,form_area:"version",questions:[new c.FormDescription.QuestionItemDescription({label:"Version",choices:this.numberRange(1,n.version.cols),multiplicity_min:1,multiplicity_max:1})]});this.formMode.exam_versions<=1&&(a.ignore=!0),o.push(a)}var l=1;return u.each(n.answers,function(t,n){for(var r=new c.FormDescription.QuestionBlockDescription({type:"questions",zone:0,row:t.row,col:t.col,rows:t.rows,cols:t.cols,form_area:"main",questions:[]}),i=0;i<t.rows;++i){if(l<=e.formMode.exam_length||-1==e.formMode.exam_length){var a=s(l-1),u=new c.FormDescription.QuestionItemDescription({label:"Question "+l,choices:e.letterRange("A",t.cols),multiplicity_min:1,multiplicity_max:a});r.questions.push(u)}l++}o.push(r)}),l-1<this.formMode.exam_length?(this.lastFailure="examLength",null):r},e.prototype.getFormDescriptionFormCode=function(t,e){var n,o=this,s=[],a=[],l=i(o.formMode),p=e.startOffset||0,f=o.formMode.exam_length,h=-1==f||o.formMode.auto_length,d=e&&e.pageCount&&e.pageCount>1,y=[];if(y=e.desc_v&&e.desc_v>=2?JSON.parse(JSON.stringify(e.form_description)):[{type:"rect",zone:0,blocks:JSON.parse(JSON.stringify(e.form_description.blocks))}],u.each(y,function(t){if("rect"==t.type){var e=t.blocks;n||(n=u.find(e,function(t){return"version"==t.form_area}))&&(n.questions[0].multiplicity_min=1,n.questions[0].multiplicity_max=1,s.push(r(t,n)),e=u.without(e,n)),u.each(e,function(e){if("questions"===e.type&&"main"==e.form_area){var n=[];u.each(e.questions,function(t){var e=l(p);if(t.multiplicity_min=1,t.multiplicity_max=e,o.formMode.ignore_formcode_choices)for(var r=0;r<t.choices.length;r++)t.choices[r]="ABCDEFGHIJKLMNOPQRSTUVWXYZ".slice(r,r+1);(!t.choices.length||p>=f&&!h)&&(t.ignore=!0),n.push(t),p++}),e.questions=n,e.questions.length||(e.ignore=!0),s.push(r(t,e))
}else"number"===e.type&&"main"==e.form_area?(p>=f&&!h&&(e.ignore=!0),s.push(r(t,e)),p++):s.push(r(t,e))})}else"clip"==t.type&&(a.push(new c.FormDescription.ClipItemDescription({zone:t.zone,label:t.label})),p++)}),!d&&!h&&p<o.formMode.exam_length)return o.lastFailure="examLength",null;var m=new c.FormDescription({blocks:s,clips:a,has_formcode:!0});return m.oneTimeDescription=!0,m},e.prototype.getFormDescription=function(t){var e=this;return l(t).then(function(n){return n?e.getFormDescriptionFormCode(t,n):e.getFormDescriptionNoFormCode(t)})},e}(a);t.exports=p},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},a=n(0),c=n(32),u=n(4),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getFormDescription=function(t){return o(this,void 0,void 0,function(){var e,n,r,i;return s(this,function(o){return(e=this.findIDBlock(t))?1!==(n=a.without(t.blocks,e)).length?[2,null]:3!=(r=n[0]).cols||10!=r.rows?[2,null]:((i=new u.FormDescription({blocks:[]})).blocks.push(this.createIDBlockDescription(e)),i.blocks.push(new u.FormDescription.NumberBlockDescription({type:"number",zone:0,choices:["0","1","2","3","4","5","6","7","8","9"],form_area:"main",row:r.row,col:r.col,rows:r.rows,cols:r.cols,label:"Score"})),[2,i]):[2,null]})})},e}(c);t.exports=l},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=n(3),s=n(61),a=n(9),c=n(2),u=n(147),l=n(148),p=n(149),f=(n(14),n(0)),h=n(1),d=c.get(),y="https://cdn-qnhd.menco.cn/assets/vendors/gradecam/gc",m=f.template(u),g=f.template(l),v=(f.template(p),new(function(){function t(){this.loader=null,this.evtObj=new o.ClassTS,this.instOpts={downloadsUrl:y,reqFeatures:[],desiredVersion:"6.5.1.3",minVersion:"6.5.1.3",params:[]},this.returnUrl=window.location.href,this.moduleOrder=null,this.moduleOptions={},this.bind=f.bind(this.evtObj.bind,this.evtObj),this.unbind=f.bind(this.evtObj.unbind,this.evtObj)}return t.prototype.makeInstallUrlFactory=function(t){var e=this;return function(n){return t.makeInstallUrl(e.instOpts.desiredVersion,n)}},t.prototype.pluginNotInstalled=function(t,e){var n=e.module,r=h.newDeferred(),i=function(){n.cancelLoad(),r.resolve(!0)};if(window.__GC_TN_HelperFunc=i,window.external&&void 0!==window.external.msActiveXFilteringEnabled&&window.external.msActiveXFilteringEnabled())t.innerHTML=g({}),this.evtObj.trigger("install",{error:"unsupported"}),r.reject(new a.UnsupportedError("unsupported"));else{var o=this.makeInstallUrlFactory(n),s=o(this.returnUrl),c=n.doesInstallRequireRestart(),u=!(!e.fallbacks||!e.fallbacks.length)&&"__GC_TN_HelperFunc";t.innerHTML=m({upgrade:!1,url:s,canTryNext:u}),this.evtObj.trigger("install",{error:null,url:s,upgrade:!1,makeUrl:o,module:n.getName(),requiresRestart:c,nextCb:u?i:null}),c||n.waitForInstall().then(function(t){"cancelled"!=t&&r.resolve(!1)})}return r.promise},t.prototype.needsUpgrade=function(t,e){var n=e.module,r=this.makeInstallUrlFactory(n),i=r(this.returnUrl);t.innerHTML=m({upgrade:!0,url:i,canTryNext:!1}),this.evtObj.trigger("install",{error:null,url:i,makeUrl:r,upgrade:!0,module:n.getName(),requiresRestart:!0})},t.prototype.unsupported=function(t){this.evtObj.trigger("install",{error:"unsupported"})},t.prototype.requireFeatures=function(t){this.instOpts.reqFeatures=t},t.prototype.requireMinVersion=function(t){this.instOpts.minVersion=t},t.prototype.preferVersion=function(t){this.instOpts.desiredVersion=t},t.prototype.setReturnURL=function(t){this.returnUrl=t},t.prototype.setModuleOption=function(t,e,n){this.moduleOptions[t]=this.moduleOptions[t]||{},this.moduleOptions[t][e]=n,this.loader&&this.loader.setModuleOption(t,e,n)},t.prototype.setDesiredVersion=function(t){this.instOpts.minVersion=t},t.prototype.setModuleOrder=function(t){this.moduleOrder=t,d.debug("Plugin module order:",t),this.loader&&this.loader.setModuleOrder(t)},t.prototype.doInstantiate=function(t,e,n){return r(this,void 0,void 0,function(){var r,o,s,c;return i(this,function(i){switch(i.label){case 0:e?((o=n||[]).unshift(e),r=this.loader.instantiateFromList(o,this.instOpts)):r=n?this.loader.instantiateFromList(n,this.instOpts):this.loader.instantiate(this.instOpts),i.label=1;case 1:return i.trys.push([1,3,,9]),[4,r];case 2:return[2,i.sent()];case 3:return(s=i.sent())instanceof a.NeedsInstallError?"install"!=(c=s.getStatus()).installType?[3,5]:[4,this.pluginNotInstalled(t,c)]:[3,7];case 4:return i.sent()?[2,this.doInstantiate(t,null,c.fallbacks)]:[2,this.doInstantiate(t,c.module,c.fallbacks)];case 5:throw this.needsUpgrade(t,c),s;case 6:return[3,8];case 7:if(s instanceof a.UnsupportedError)throw this.unsupported(t),s;i.label=8;case 8:throw s;case 9:return[2]}})})},t.prototype.isInstalled=function(){return s.isInstalled(this.moduleOrder)},t.prototype.getTyperOptions=function(t,e){return s.getTyperOptions(this.moduleOrder,t||this.instOpts.desiredVersion,e||this.returnUrl)},t.prototype.startInstall=function(t,e){return r(this,void 0,void 0,function(){var n,r=this;return i(this,function(i){switch(i.label){case 0:f.extend(this.instOpts,e),this.loader||(this.loader=new s(t),this.moduleOrder&&this.loader.setModuleOrder(this.moduleOrder),f.each(this.moduleOptions,function(t,e){f.each(t,function(t,n){r.loader.setModuleOption(e,n,t)})})),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.doInstantiate(t)];case 2:return[2,i.sent()];case 3:throw n=i.sent(),d.error("Could not instantiate Form Reader: ",n),n;case 4:return[2]}})})},t}()));t.exports=v},function(t,e,n){"use strict";var r,i,o,s,a,c,u,l,p,f,h,d=n(14),y=(r={close_label:"Close",inherit_frames:!1,fade_in_speed:300,fade_out_speed:300,attribute_name:"rel",tags_to_hide:["select","embed"],default_width:450,version_number:"2.2",build_number:"1612",is_opera:-1!=navigator.userAgent.indexOf("Opera/9"),is_ie:-1!=navigator.userAgent.indexOf("MSIE "),is_ie6:!1,is_firefox:"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Gecko")&&-1==navigator.userAgent.indexOf("Netscape"),is_mac:-1!=navigator.userAgent.indexOf("Macintosh"),base_url:"",setPath:function(t){r.base_url=t},bind:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];e=[];for(var r=1;r<arguments.length;r++)e.push(arguments[r]);return function(n){return t.apply(this,[n].concat(e))}},html:function(t,e){if(void 0===t)return s.content;if(void 0===e&&(e={}),i.is_loaded){r.clear(),r.updateObject(s.wrapper.style,{display:"block",visibility:"hidden",left:0,top:0,height:"",width:""}),"string"==typeof t?s.content.innerHTML=t:s.content.appendChild(t),r.getPageSize(),void 0===e.can_resize&&(e.can_resize=!0),void 0===e.fade_in&&(e.use_fade=!0),e.fullscreen&&(e.width="100%",e.height="100%"),a.container=[2*s.wrapper.offsetLeft,2*s.wrapper.offsetTop],a.wrapper=[s.wrapper.offsetWidth-s.content.offsetWidth,s.wrapper.offsetHeight-s.content.offsetHeight],a.wrapper[1]+=4;var n,o=e.width||r.default_width;e.height?n=e.height:(s.content.style.height="100%",n=s.content.offsetHeight+12,s.content.style.height=""),i.dimensions=[o,n],i.params=e,r.reposition();for(var c=0;c<r.tags_to_hide.length;c++)l(r.tags_to_hide[c],s.content);s.wrapper.style.visibility="visible"}},clear:function(){for(s.loading.style.display="none";s.content.firstChild;)s.content.removeChild(s.content.firstChild)},show:function(t,e,n){p(e,n,function(){r.html(t,i.params)})},hide:function(){i.plugin&&i.plugin.unload&&i.plugin.unload(),i={},r.clear();for(var t=0;t<r.tags_to_hide.length;t++)l(r.tags_to_hide[t]);s.loading.style.display="none",s.wrapper.style.display="none",r.fade(s.overlay,r.getOpacity(null,s.overlay),0,r.fade_out_speed,function(){s.overlay.style.display="none"}),r.fireEvent("hide")},reposition:function(){if(i.is_loaded){if("none"!=s.loading.style.display&&r.center(s.loading),i.dimensions){var t=r.getPageSize(),e=i.dimensions[0],n=i.dimensions[1];if(-1!=n.toString().indexOf("%")?s.wrapper.style.height=(Math.max(document.documentElement.clientHeight,document.body.clientHeight,t.height)-a.container[0])*(parseInt(n,10)/100)+"px":n?(s.content.style.height=n+"px",s.wrapper.style.height=s.content.offsetHeight+a.wrapper[1]+"px"):s.wrapper.style.height=s.content.offsetHeight+a.wrapper[1]+"px",-1!=e.toString().indexOf("%")?s.wrapper.style.width=(Math.max(document.documentElement.clientWidth,document.body.clientWidth,t.width)-a.container[1])*(parseInt(e,10)/100)+"px":(s.content.style.width=e+"px",s.wrapper.style.width=s.content.offsetWidth+a.wrapper[0]+"px"),r.updateObject(s.content.style,{width:"",height:""}),e=parseInt(s.wrapper.style.width,10),n=parseInt(s.wrapper.style.height,10),i.params.can_resize){var o=t.width,c=t.height;o-=a.container[0],c-=a.container[1],e>o&&(i.params.constrain&&(n*=o/e),e=o),n>c&&(i.params.constrain&&(e*=c/n),n=c),r.updateObject(s.wrapper.style,{width:e+"px",height:n+"px"})}s.content.style.height=n-a.wrapper[1]+"px",i.dimensions!=["100%","100%"]&&r.center(s.wrapper)}s.overlay.style.height=Math.max(document.body.clientHeight,document.documentElement.clientHeight)+"px"}},updateObject:function(t,e){for(var n in e)t[n]=e[n]},center:function(t){var e=r.getPageSize(),n=r.getScrollPos(),i=r.getElementSize(t),o=Math.round((e.width-i.width)/2+n.scrollX),s=Math.round((e.height-i.height)/2+n.scrollY);t.offsetLeft&&(o-=t.offsetLeft),t.offsetTop&&(s-=t.offsetTop),t.style.left&&(o+=parseInt(t.style.left,10)),t.style.top&&(s+=parseInt(t.style.top,10)),o-=10,r.updateObject(t.style,{top:s+"px",left:o+"px"})},getStyle:function(t,e){return t.currentStyle?t.currentStyle[e]:window.getComputedStyle?document.defaultView.getComputedStyle(t,null).getPropertyValue(e):void 0},getScrollPos:function(){var t=document.documentElement;return{scrollX:document.body.scrollLeft||window.pageXOffset||t&&t.scrollLeft,scrollY:document.body.scrollTop||window.pageYOffset||t&&t.scrollTop}},getPageSize:function(){return{width:window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body.clientHeight}},getElementSize:function(t){return{width:t.offsetWidth||t.style.pixelWidth,height:t.offsetHeight||t.style.pixelHeight}},fade:function(t,e,n,i,o){if((void 0===e||e<0)&&(e=0),e>100&&(e=100),(void 0===n||n<0)&&(n=0),n>100&&(n=100),void 0===i&&(i=0),t.fader&&clearInterval(t.fader),!i)return r.setOpacity(null,t,n),void(o&&o());var s=(n-e)/(i/25);0==s?s=1:s>0?s=Math.ceil(s):s<0&&(s=Math.floor(s)),t.fader=setInterval(r.bind(function(t,e,n,i,o){var s=r.getOpacity(t,e)+n;r.setOpacity(t,e,s),(n<0&&s<=i||n>0&&s>=i)&&(r.setOpacity(t,e,i),clearInterval(e.fader),o&&o())},t,s,n,o),25)},setOpacity:function(t,e,n){n=Math.round(n),e.style.opacity=n/100,e.style.filter="alpha(opacity="+n+")"},getOpacity:function(t,e){return 100*r.getStyle(e,"opacity")},addEvent:function(t,e,n){return t.addEventListener?(t.addEventListener(e,n,!1),!0):!!t.attachEvent&&t.attachEvent("on"+e,n)},addEventListener:function(t,e){o[t]||(o[t]=[]),o[t].push(e)},removeEventListener:function(t,e){if(o[t]){var n=o[t].indexOf(e);n>-1&&o[t].splice(n,1)}},fireEvent:function(t){if(o[t]&&o[t].length)for(var e=0;e<o[t].length;e++){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);if(!1===o[t][e](n))break}},plugins:{list:[],register:function(t,e){void 0===e&&(e=!1),e?r.plugins.list.push(t):r.plugins.list=[t].concat(r.plugins.list)}}},i={},o={},s={},a={},c=function(t){r.getPageSize(),s.container=document.createElement("div"),s.container.id="ibox",s.overlay=document.createElement("div"),s.overlay.style.display="none",r.setOpacity(null,s.overlay,0),r.is_firefox?s.overlay.style.backgroundImage="url('"+d.bg+"')":s.overlay.style.background="#000000",s.overlay.id="ibox_overlay",r.updateObject(s.overlay.style,{position:"absolute",top:0,left:0,width:"100%"}),s.container.appendChild(s.overlay),s.loading=document.createElement("div"),s.loading.id="ibox_loading",s.loading.innerHTML="Loading...",s.loading.style.display="none",s.container.appendChild(s.loading),s.wrapper=document.createElement("div"),s.wrapper.id="ibox_wrapper",r.updateObject(s.wrapper.style,{position:"absolute",top:0,left:0,display:"none"}),s.content=document.createElement("div"),s.content.id="ibox_content",r.updateObject(s.content.style,{overflow:"auto"}),s.wrapper.appendChild(s.content);var e=document.createElement("div");e.id="ibox_footer_wrapper";var n=document.createElement("a");return n.innerHTML=r.close_label,n.href="javascript:void(0)",e.appendChild(n),s.footer=document.createElement("div"),s.footer.id="ibox_footer",s.footer.innerHTML="&nbsp;",e.appendChild(s.footer),s.wrapper.appendChild(e),s.container.appendChild(s.wrapper),t.appendChild(s.container),r.updateObject(s.wrapper.style,{right:"",bottom:""}),s.container},u=function(t,e){void 0===e&&(e=document.body);for(var n=e.getElementsByTagName(t),i=0;i<n.length;i++)"hidden"!=r.getStyle(n[i],"visibility")&&"none"!=n[i].style.display&&(n[i].style.visibility="hidden",n[i].wasHidden=!0)},l=function(t,e){void 0===e&&(e=document.body);for(var n=e.getElementsByTagName(t),r=0;r<n.length;r++)n[r].wasHidden&&(n[r].style.visibility="visible",n[r].wasHidden=null)},p=function(t,e,n){f||h(),void 0===e&&(e={}),i.plugin&&r.hide(),i.is_loaded=!0,i.params=e,s.loading.style.display="block",r.center(s.loading),r.reposition();for(var o=0;o<r.tags_to_hide.length;o++)u(r.tags_to_hide[o]);var a;s.footer.innerHTML=t||"&nbsp;",s.overlay.style.display="block",a=r.is_firefox?100:70,r.fade(s.overlay,r.getOpacity(null,s.overlay),a,r.fade_in_speed,n),r.fireEvent("show")},f=!1,h=function(){if(!f){var t,e;f=!0,t=document.getElementsByTagName("head")[0],(e=document.createElement("div")).innerHTML='<p>x</p><style type="text/css">#ibox_footer_wrapper {font-weight:bold;height:20px;line-height:20px;} #ibox_footer_wrapper a {text-decoration:none;background:#888;border:1px solid #666;line-height:16px;padding:0 5px;color:#333;font-weight:bold;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:10px;} #ibox_footer_wrapper a:hover {background-color:#bbb;color:#111;} #ibox_footer_wrapper {font-size:12px;font-family:Verdana, Arial, Helvetica, sans-serif;color:#111;} #ibox_wrapper {border:1px solid #ccc;} #ibox_wrapper {background-color:#999;}#ibox_content {background-color:#eee;border:1px solid #666;} #ibox_loading {padding:50px; background:#000;color:#fff;font-size:16px;font-weight:bold;}</style>',t.insertBefore(e.childNodes[1],t.firstChild),e.innerHTML='<p>x</p><style type="text/css">#ibox {z-index:1000000;text-align:left;} #ibox_overlay {z-index:1000000;} #ibox_loading {position:absolute;z-index:1000001;} #ibox_wrapper {margin:30px;position:absolute;top:0;left:0;z-index:1000001;} #ibox_content {z-index:1000002;margin:27px 5px 5px 5px;padding:2px;} #ibox_content object {display:block;} #ibox_content .ibox_image {width:100%;height:100%;margin:0;padding:0;border:0;display:block;} #ibox_footer_wrapper a {float:right;display:block;outline:0;margin:0;padding:0;} #ibox_footer_wrapper {text-align:left;position:absolute;top:5px;right:5px;left:5px;white-space:nowrap;overflow:hidden;}</style>',t.insertBefore(e.childNodes[1],t.firstChild);for(var n,i=document.getElementsByTagName("script"),o=0,s=null;s=i[o];o++)if((n=s.getAttribute("src"))&&"/ibox.js"==(n=n.split("?")[0]).substr(n.length-8)){r.setPath(n.substr(0,n.length-7));break}c(document.body),r.fireEvent("load")}},r.addEvent(window,"keypress",function(t){t.keyCode==(window.event?27:t.DOM_VK_ESCAPE)&&y.hide()}),r.addEvent(window,"resize",r.reposition),r.addEvent(window,"load",h),r.addEvent(window,"scroll",r.reposition),r);t.exports=y},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=n(60),s=n(33),a=n(27),c=n(28),u=n(25),l=n(6),p=new o,f=s.getExposedPublicAPI(p);window&&(window.gradecam=f),f.bind("pluginLoad",function(t){window.gradeCamOnPluginLoad&&window.gradeCamOnPluginLoad(t)}),f.forms=c.forms,f.forms2=c.forms2,f._registerFileReader=function(t,e){u._registerFileReader(t,e)},f.registerFileHandler=function(t,e){u.registerFileHandler(t,e)};var h="https://cdn-qnhd.menco.cn/assets/vendors/gradecam/gc";f.registerFileHandler(["pdf"],h+"/pdfloader/current/loader.js"),f.registerFileHandler(["tif","tiff"],h+"/tiffloader/current/tiffloader.js"),a.domLoaded(function(){return r(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,l.readyDfd];case 1:case 2:return t.sent(),[3,3];case 3:return window.gradeCamOnAPILoad&&setTimeout(function(){window.gradeCamOnAPILoad(f)},0),p._setReady(),[2]}})})}),f.SDK_VERSION="6.5.1.3",t.exports=f},function(t,e,n){"use strict";function r(t){t&&t.data&&"GCSDK"==t.data.target&&t.data.resp&&(F=t.data.resp,window.removeEventListener("message",r))}function i(){document.documentElement.className.indexOf("GCPlugin2")>-1&&(window.addEventListener("message",r),setTimeout(function(){null===F&&(F=!1,window.removeEventListener("message",r))},A),window.postMessage({req:"version",target:"GCPlugin2"},"*"))}function o(t,e){l(t.items).each(function(t){t.validate=!1}),e(t.items)}var s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},c=n(33),u=n(3),l=n(0),p=n(57),f=n(27),h=n(41),d=n(40),y=n(45),m=n(48),g=n(4),v=n(173),b=n(191),w=n(192),_=n(2),x=n(193),S=n(54),k=n(1),O=n(194),I=n(27),C=n(15),T=n(195),j=n(24);n(22);var D=n(16),M=n(196),P=new _,E=0,R=(n(14),n(10)),F=null,A=2e3;I.domLoaded(function(){return setTimeout(i,200)});var N=function(t){setTimeout(t,0)},L=function(){function t(){var t=this;this.evtObj=new u.ClassTS,this.controller=null,this.el=null,this.readyDfd=k.newDeferred(),this.pid=E++,this.cameraStarted=!1,this.webTyperId=null,this.curCamera$=new M.BehaviorSubject(""),this.scan$=new D.Subject,this.formcode$=new D.Subject,this.scanCallback=null,this.showMsg=!0,this.mode=new m,this.instanceDfd=k.newDeferred(),this.instanceOptions={},this.requiredFeatures=[],this.requiredVersion="0.0.0.0",this.desiredVersion="current",this.returnURL=window.location.href,this.validateCallback=o,this.videoWidth=640,this.videoHeight=480,this.isFileScanning=!1,this.useRotate=!1,this.typerConfig=null,this.scanManager=null,this.statusReporter=null,this.bind=l.bind(this.evtObj.bind,this.evtObj),this.unbind=l.bind(this.evtObj.unbind,this.evtObj),this._simulateScan=this.onRawScan;try{this.opts=JSON.parse(decodeURIComponent(h.get("gradecam_options")))||{}}catch(t){this.opts={}}l.defaults(this.opts,{multiplicity_error_threshold_not_expected:.001,multiplicity_error_threshold_expected:.01,choice_error_threshold:1e-5,sigma_threshold:3,filescan_sigma_threshold:5,rotate:0}),p.bind("install",function(e){t.evtObj.trigger("install",e)}),this.bind("scan",function(){d.increment(d.SCAN_COUNT),d.save()}),this.scanManager=this.initScanManager();var e=this.statusReporter=new b(this.scanManager);e.bind("problem",function(e){t.showMsg&&t.displayMessage(e.message),t.evtObj.trigger("scanIssue",e)}),e.bind("enableHighRes",function(e){return t.enableHighRes(e)}),this.instanceDfd.promise.then(function(e){return t.initializeController(e)},function(t){return console.warn("Instantiation error:",t)})}return t.prototype.processScanOutput=function(t){return s(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,t.getScanOutput(this.mode.type,this.mode.output_version||0)];case 1:return[2,e.sent()]}})})},t.prototype.initScanManager=function(){var t=this,e=new v,n=this.opts;return e.setMultiplicityErrorThreshold(n.multiplicity_error_threshold_expected,n.multiplicity_error_threshold_not_expected),e.setChoiceErrorThreshold(n.choice_error_threshold),e.setValidateCallback(w(this.validateCallback)),e.bind("pause",function(){t.controller.pause()}),e.bind("unpause",function(){t.controller.unpause()}),e.bind("scan",function(e){return s(t,void 0,void 0,function(){var t,n=this;return a(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.processScanOutput(e)];case 1:return t=r.sent(),[3,3];case 2:throw r.sent();case 3:return this.scanCallback&&N(function(){return n.scanCallback(t)}),N(function(){n.evtObj.trigger("scan",t),n.scan$.next(t)}),this.displayMessage(),[2]}})})}),e.bind("formcode",function(e){N(function(){t.evtObj.trigger("formcode",e),t.formcode$.next(e)})}),e.bind("enableHighRes",function(e){return t.enableHighRes(e)}),e},t.prototype.onRawScan=function(t,e){return this.scanManager.processScan(t,e).catch(function(t){})},t.prototype.callSetCamera=function(){if(this.cameraStarted=!0,this.controller){var t=this.getOption("selected_camera")||"",e=this.getOption("rotate"),n=this.getOption("flip_image");!this.useRotate||!0!==n&&!1!==n||(e=n?R.Rotate.Full180:R.Rotate.None,this.setOptions({flip_image:void 0,rotate:e},!1)),this.useRotate&&(e||e===j.CameraRotate.None)?this.controller.setCamera(t,e):this.controller.setCamera(t,n||!1),this.curCamera$.next(t)}},t.prototype.initializeController=function(t){var e=this,n=t.getNeedsTransparency(),r=this.controller=t;this.useRotate=this.controller.supports("rotate"),r.startPolling(),r.bind("scan",function(t){return e.onRawScan(t)}),r.bind("cameraVisible",function(t){n&&(t?e.hideWatermark(e.el):e.showWatermark(e.el),e.evtObj.trigger("cameraVisible",t))}),r.bind("videoSize",function(t,n){e.videoWidth==t&&e.videoHeight==n||(e.videoWidth=t,e.videoHeight=n,e.evtObj.trigger("videoSize",t,n))}),this.cameraStarted&&this.callSetCamera(),this.scanManager.setSpeedHandicap(r.getSpeedHandicap()),this.evtObj.trigger("pluginLoad",c.getExposedPublicAPI(this))},t.prototype.displayMessage=function(t,e){var n=this,r=f.$("gcPluginMsgDiv");r&&r.parentNode&&r.parentNode.removeChild(r),t&&((r=document.createElement("div")).setAttribute("id","gcPluginMsgDiv"),r.setAttribute("style","position:absolute; bottom: 5%; left: 5%; width:86%; background-color: rgba(50,50,50,0.8); border-radius:5px; border: 1px solid black; padding: 2%; color: #fff; font-size: 14px;"),r.innerHTML=t,this.el.appendChild(r),setTimeout(function(){try{n.el.removeChild(r)}catch(t){}},e||4e3))},t.prototype.findElementInDOM=function(){var t=this,e=k.newDeferred(),n=function(){f.isInDOMTree(t.el)?e.resolve(t.el):setTimeout(n,50)};return n(),e.promise},t.prototype.performStart=function(t){p.requireFeatures(this.requiredFeatures),p.requireMinVersion(this.requiredVersion),p.preferVersion(this.desiredVersion),p.setReturnURL(this.returnURL),p.startInstall(this.el,this.instanceOptions).then(function(e){t.resolve(e)},function(e){t.reject(e)})},t.prototype.showWatermark=function(t){},t.prototype.hideWatermark=function(t){t.setAttribute("style","width:100%; height:100%; position: relative;background-color: transparent;")},t.prototype.getElement=function(t){var e=this;if(!this.el){t&&(this.instanceOptions=t),t&&t.disable_camera?this.cameraStarted=!1:this.cameraStarted=!0;var n=this.el=document.createElement("div");n.style.width="100%",n.style.height="100%",n.setAttribute("id","gcplugin"+this.pid),this.showWatermark(n),this.readyDfd.promise.then(function(){return e.findElementInDOM().then(function(t){return e.performStart(e.instanceDfd)})},function(t){console.warn("Start error:",t)})}return this.el},t.prototype.initTyper=function(t,e,n,r){return void 0===r&&(r=0),s(this,void 0,void 0,function(){return a(this,function(i){switch(i.label){case 0:return this.typerConfig={fkey:t,delay:e,rkey:n,rkeyDelay:r||e},[4,this.instanceDfd.promise];case 1:return i.sent(),this.controller.initTyper(t,e,n,r||e),[2]}})})},t.prototype.setScanCallback=function(t){this.scanCallback=t},t.prototype.setValidateCallback=function(t,e){void 0===e&&(e=!1),this.validateCallback=t,this.scanManager.setValidateCallback(w(t),e)},t.prototype.processImageFile=function(t,e){return console&&console.warn&&console.warn("processImageFile is deprecated and may be removed in a future version of GCSDK."),this.controller.processImageFile(t,e)},t.prototype.processImageFiles=function(t,e){return console&&console.warn&&console.warn("processImageFiles is deprecated and may be removed in a future version of GCSDK."),this.controller.processImageFiles(t,e)},t.prototype.processImageFileArray=function(t,e,n){return console&&console.warn&&console.warn("processImageFileArray is deprecated and may be removed in a future version of GCSDK."),this.controller.processImageFileArray(t,e,n)},t.prototype.setFileScanning=function(t){this.isFileScanning=t,t?this.scanManager.setSigmaThreshold(this.opts.filescan_sigma_threshold):this.scanManager.setSigmaThreshold(this.opts.sigma_threshold)},t.prototype.scanFilesAsync=function(t,e){return s(this,void 0,void 0,function(){var n,r=this;return a(this,function(i){return y.setMode(this.getOptions().file_process_mode||"normal"),(n=this.controller.scanFilesAsync(t,function(t,n){return s(r,void 0,void 0,function(){var r,i,o,c,u,p,f,h,d,y,m,g,v,b,w,_,x,S=this;return a(this,function(k){switch(k.label){case 0:return this.setFileScanning(!0),n?[3,1]:(this.setFileScanning(!1),l.defer(e,null,null,n),[3,15]);case 1:return l.every(t,function(t){return t.error})||l.any(t,function(t){return"bw"==t.type})?(r="unknown",i=void 0,o=l.find(t,function(t){return"readError"==t.type}),c=l.find(t,function(t){return"fileReader"==t.type}),u=l.find(t,function(t){return"file"==t.type}),p=l.find(t,function(t){return"bw"==t.type}),f=l.find(t,function(t){return"noOutput"==t.type}),c?(r="File "+c.msg+" appears to have an unsupported format.",i=c.msg):u?(r="File "+u.fileName+" appears to be corrupted or have an unsupported format.",i=u.fileName):p?(r="File "+p.fileName+" appears to be scanned in black and white and cannot be accurately graded.",r+="Please rescan using grayscale or color.",i=p.fileName):f?(r="File "+f.fileName+" does not appear to have a form in it.",i=f.fileName):o&&(r="Could not read "+o.fileName+" -- "+o.msg),l.defer(e,{message:r,fileName:i},null,n),[3,15]):[3,2];case 2:h=l.filter(t,function(t){return!t.error}),d=[],y=0,m=h,k.label=3;case 3:if(!(y<m.length))return[3,8];g=m[y],k.label=4;case 4:return k.trys.push([4,6,,7]),[4,this.scanManager.processScan(g,{scansRequired:1,scansMax:1,scansToValidate:1,returnScan:!0,dontValidate:!0})];case 5:return(v=k.sent())?d.push(v):d.push(null),[3,7];case 6:return k.sent(),[3,7];case 7:return y++,[3,3];case 8:if(!d.length)return l.defer(e,{message:"No form could be read from this file",fileName:"unknown"},null,n),[2];(b=l.filter(d,function(t){return t.fc_data})).length&&(d=b),d=l.sortBy(d,function(t){return t.getUnvalidatedItems().length}),w=d.pop(),k.label=9;case 9:return k.trys.push([9,14,,15]),w.getUnvalidatedItems().length?[4,this.scanManager.validateScan(w).then(function(t){return s(S,void 0,void 0,function(){var r
;return a(this,function(i){switch(i.label){case 0:return[4,this.processScanOutput(t)];case 1:return r=i.sent(),l.defer(e,null,r,n),[2]}})})},function(){l.defer(n)})]:[3,11];case 10:return k.sent(),[3,13];case 11:return[4,this.processScanOutput(w)];case 12:_=k.sent(),l.defer(e,null,_,n),k.label=13;case 13:return[3,15];case 14:return x=k.sent(),P.warn("Error processing results: ",JSON.stringify(t)),console&&console.warn("error:",x),l.defer(e,{message:x.toString(),fileName:"Unknown"},null,n),[3,15];case 15:return[2]}})})}))?[2,n]:(this.setFileScanning(!1),[2,!1])})})},t.prototype.setMode=function(t){t.scan_mode&&(t.type=t.scan_mode),this.mode.update(t),this.scanManager.setMode(this.mode)},t.prototype.getMode=function(){return this.mode.toJSON()},t.prototype.getLastFormDescription=function(){return this.scanManager.getLastFormDescription()},t.prototype.setOptions=function(t,e){void 0===e&&(e=!0);var n=this.opts;l.extend(n,t),h.set("gradecam_options",JSON.stringify(n),3650),(e&&"flip_image"in t||"selected_camera"in t||"rotate"in t)&&(this.el&&this.supports("liveOptions")?this.callSetCamera():this.evtObj.trigger("needsRefresh")),e&&l.any(l.keys(n),function(t){return-1!=t.indexOf("threshold")})&&(this.scanManager.setMultiplicityErrorThreshold(n.multiplicity_error_threshold_expected,n.multiplicity_error_threshold_not_expected),this.scanManager.setChoiceErrorThreshold(n.choice_error_threshold),this.scanManager.setSigmaThreshold(this.isFileScanning?n.filescan_sigma_threshold:n.sigma_threshold)),e&&n.dsTimeout&&(g.InterpretedScan.DeepSplitTimeout=n.dsTimeout)},t.prototype.getOptions=function(){return JSON.parse(JSON.stringify(this.opts))},t.prototype.stopCamera=function(){if(this.cameraStarted=!1,this.controller&&this.supports("stopCamera"))return this.controller.stopCamera()},t.prototype.startCamera=function(){this.callSetCamera()},t.prototype.getCameraList=function(){return this.controller.getCameraList()},t.prototype.getOption=function(t){return this.getOptions()[t]},t.prototype.setActive=function(t){return this.controller.setActive(t)},t.prototype.enableHighRes=function(t){return this.controller.enableHighRes(t||5e3)},t.prototype.setModuleOrder=function(t){return p.setModuleOrder(t)},t.prototype.setModuleOption=function(t,e,n){return p.setModuleOption(t,e,n)},t.prototype.getVersion=function(){return this.controller?this.controller.getVersion():null},t.prototype.getExtensionVersion=function(){return F},t.prototype.isAtLeastVersion=function(t){return this.controller?this.controller.isAtLeastVersion(t):null},t.prototype.isInstalled=function(){return p.isInstalled()},t.prototype.getTyperConfig=function(){return this.typerConfig},t.prototype.getTyperOptions=function(){return p.getTyperOptions(this.desiredVersion,this.returnURL)},t.prototype.getTyperAvailability=function(t){var e=p.getTyperOptions(this.desiredVersion,this.returnURL);return e.length?l.findWhere(e,{installed:!0})?"installed":"possible":"not supported"},t.prototype.setWebTyperId=function(t){this.webTyperId=t},t.prototype.getWebTyperLink=function(t,e){if(!(t=t||this.webTyperId))throw new Error("No typer ID specified");return"javascript:(function(g,id){if(g._GCRequestGrades){g._GCRequestGrades(id)}else{var jsCode=document.createElement('script');jsCode.setAttribute('src','"+(e=e||{scriptUrl:"https://downloads.gradecam.com/webtyper/current/typer.js"}).scriptUrl+"');document.body.appendChild(jsCode);g._GCGradeXferReq=id}})(this,'"+t+"');"},t.prototype.copyTyperToClipboard=function(){if(!this.webTyperId)throw new Error("call setWebTyperId first");return O.copyToClipboard("_GCPasteScores_:"+this.webTyperId)},t.prototype.setTyperStrings=function(t){var e=this;if(this.webTyperId){var n={charDelay:this.typerConfig.delay||50,entryDelay:this.typerConfig.rkeyDelay||50,rKey:this.typerConfig.rkey||"\t"};T.setWebTyperScores(this.webTyperId,t,n).then(function(){},function(t){return console.warn("Error setting web typer: ",t)})}return this.controller?this.controller.setTyperStrings(t):(this.instanceDfd.promise.then(function(){e.setTyperStrings(t)}),!0)},t.prototype.clearTyperStrings=function(){var t=this;return this.controller?this.controller.clearTyperStrings():(this.instanceDfd.promise.then(function(){t.clearTyperStrings()}),!0)},t.prototype.supports=function(t){switch(t){case"typer_copy":return!!F&&!C.isLessThan(F,"2.1.0.0");case"webtyper":return!0;default:return this.controller&&this.controller.supports(t)}},t.prototype.requireSupport=function(t){this.requiredFeatures.push(t)},t.prototype.requireVersion=function(t){this.requiredVersion=t},t.prototype.setDesiredVersion=function(t){this.desiredVersion=t},t.prototype.setReturnURL=function(t){this.returnURL=t},t.prototype.getJPEGImage=function(){return this.controller.getJPEGImage()},t.prototype.getGCI=function(){return this.controller.getCurrentImage()},t.prototype.getJpegAsync=function(t){return this.controller.getJpegAsync(t)},t.prototype.getGciAsync=function(t){return this.controller.getGciAsync(t)},t.prototype.setLicensingInfo=function(t){for(var e=0,n=["licensee","cust_id","cust_state","cust_school","cust_district","cust_type","cust_studentcount","cust_free","cust_billMonth"];e<n.length;e++){var r=n[e];t[r]&&d.set(r,t[r])}d.save()},t.prototype.setTransparency=function(){this.controller&&this.controller.setTransparency()},t.prototype.setShowMessages=function(t){this.showMsg=t},t.prototype._setLogLevel=function(t){_.get().setLogLevel(t)},t.prototype._debugScanById=function(t){return s(this,void 0,void 0,function(){var e,n,r,i;return a(this,function(o){switch(o.label){case 0:return[4,x(t)];case 1:e=o.sent(),n=0,r=e,o.label=2;case 2:if(!(n<r.length))return[3,7];i=r[n],o.label=3;case 3:return o.trys.push([3,5,,6]),[4,this.onRawScan(i)];case 4:case 5:return o.sent(),[3,6];case 6:return n++,[3,2];case 7:return[2]}})})},t.prototype._debugScan=function(t){return s(this,void 0,void 0,function(){var e,n,r;return a(this,function(i){switch(i.label){case 0:e=0,n=t,i.label=1;case 1:if(!(e<n.length))return[3,6];r=n[e],i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.onRawScan(r)];case 3:case 4:return i.sent(),[3,5];case 5:return e++,[3,1];case 6:return[2]}})})},t.prototype._setReady=function(){this.readyDfd.resolve()},t.prototype._addFormToCache=function(t){S[t.form_id]=t},t}();t.exports=L},function(t,e,n){"use strict";function r(t){var e=s.filter(p,function(t){return t.isSupported()}),n=s.indexBy(e,function(t){return t.getName()});return s.map(t,function(t){var e=t.split("-"),r=n[e[0]];return r&&(r.loadPref=e[1]),r})}var i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},s=n(0),a=n(62),c=n(82),u=n(136),l=n(9),p=[c,a,u],f=["mobile-prompt","plugin-always","noplugin"],h=function(){function t(t){this.el=t,this.activeModuleList=[],this.setModuleOrder(f)}return t.prototype.setModuleOrder=function(t){this.activeModuleList=r(t),this.activeModuleList=s.filter(this.activeModuleList,function(t){return!!t})},t.prototype.setModuleOption=function(t,e,n){var r=s.find(this.activeModuleList,function(e){return e.getName()==t});r&&r.setOption&&r.setOption(e,n)},t.prototype.instantiate=function(t){var e=s.toArray(this.activeModuleList);return e=s.filter(e,function(e){return!e.supports||s.all(t.reqFeatures,function(t){return e.supports(t)})}),this.instantiateFromList(e,t)},t.prototype.instantiateFromList=function(t,e){return i(this,void 0,void 0,function(){function n(t,e){return c.module=t,"always"!=t.loadPref&&(c.fallbacks=e),new l.NeedsInstallError(c)}var r,a,c,u,p,f,h,d,y,m,g=this;return o(this,function(v){for(r=e.reqFeatures,a=e.minVersion,c={installType:"install",reason:"not present",module:null,fallbacks:null},u=function(t){return r&&r.length&&s.any(r,function(e){return!t.supports(e)})?(c.installType="upgrade",c.reason="features",!1):!!t.isAtLeastVersion(a)||(c.installType="upgrade",c.reason="version",!1)},p=s.toArray(t),f=null,h=0,d=p;h<d.length;h++)(y=d[h])&&y.setDownloadsUrl&&y.setDownloadsUrl(e.downloadsUrl);return[2,(m=function(){return i(g,void 0,void 0,function(){var r,i;return o(this,function(o){switch(o.label){case 0:if(r=p.shift(),f||(f=r),r||!t.forceInstall)return[3,1];throw c.installType="unsupported",c.reason="unsupported",new l.UnsupportedError("Not supported on this system");case 1:return r||t.forceInstall?[3,2]:((i=s.toArray(t)).forceInstall=!0,[2,this.instantiateFromList(i,e)]);case 2:if(!r.isInstalled())return[3,7];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,r.instantiate(this.el,e,u)];case 4:return[2,o.sent()];case 5:if(o.sent(),r.loadPref||p.forceInstall)throw n(r,p);return[2,m()];case 6:return[3,8];case 7:if(r.loadPref)throw n(r,p);return[2,m()];case 8:return[2]}})})})()]})})},t.isInstalled=function(t){var e=r(t=t||f),n=!1,i=s.any(e,function(t){return!!t&&("always"!=t.loadPref||t.isInstalled()||(n=!0),t.isInstalled())});return!(n||!i)},t.getTyperOptions=function(t,e,n){void 0===t&&(t=null);for(var i=r(t=t||f),o=[],a=function(t){if(!t||!t.supportsTyper())return"continue";var r={module:t.getName(),installed:!!t.isTyperInstalled(),url:t.makeInstallUrl(e,n),makeUrl:function(n){return t.makeInstallUrl(e,n)},waitForInstall:s.bind(t.waitForInstall,t)};o.push(r)},c=0,u=i;c<u.length;c++)a(u[c]);return o},t}();t.exports=h},function(t,e,n){"use strict";function r(){return l.ios?"ios":l.android?"android":"unknown/unsupported"}var i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},s=n(0),a=n(63),c=n(21),u=n(9),l=n(23),p=new(function(){function t(){this.loadPref=null,this.mobileUrls={}}return t.prototype.getName=function(){return"mobile"},t.prototype.isSupported=function(){var t=r();return this.isInstalled()||!!this.mobileUrls[t]},t.prototype.isInstalled=function(){return!!window.gcmobilesdk},t.prototype.getInstallURL=function(){var t=r();return this.mobileUrls[t]},t.prototype.makeInstallUrl=function(){var t=r();return this.mobileUrls[t]},t.prototype.setOption=function(t,e){var n=this;"url"==t&&s.each(e,function(t,e){n.mobileUrls[e]=t})},t.prototype.instantiate=function(t){return i(this,void 0,void 0,function(){var e;return o(this,function(n){switch(n.label){case 0:e=new a(t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,c(window.gcmobilesdk)];case 2:return n.sent(),[2,e];case 3:throw n.sent(),new u.UnauthenticatedError("Could not contact server");case 4:return[2]}})})},t.prototype.doesInstallRequireRestart=function(){return!0},t.prototype.waitForInstall=function(){throw new u.UnsupportedError("Unsupported")},t.prototype.supportsTyper=function(){return!1},t.prototype.isTyperInstalled=function(){return!1},t.prototype.cancelLoad=function(){},t}());t.exports=p},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=n(3),s=n(0),a=n(15),c=n(7),u={},l=function(t){function e(e){var n=t.call(this)||this;return n.active=!0,n.paused=!1,n.currentCameraInfo=new c.ReplaySubject(1),u={stop:!1,ivId:-1,callQ:[],div:e},gcmobilesdk.cameraVisibleCallback=function(t){n.trigger("cameraVisible",t)},gcmobilesdk.updateDimensionCallback=function(t,e){n.videoWidth=t,n.videoHeight=e,n.trigger("videoSize",t,e)},gcmobilesdk.setGcipV2&&gcmobilesdk.setGcipV2(!0),gcmobilesdk.currentCameraInfoCallback=function(t){n.maxVideoWidth=t.w,n.maxVideoHeight=t.h,n.currentCameraInfo.next({width:t.w,height:t.h,supportsHighRes:t.w*t.h>48e4})},n}return i(e,t),e.prototype.getCameraList=function(){return gcmobilesdk.cameraList},e.prototype.getVersionMajor=function(){return gcmobilesdk.version.split(".")[0]},e.prototype.getVersionMinor=function(){return gcmobilesdk.version.split(".")[1]},e.prototype.stopCamera=function(){return gcmobilesdk.hide()},e.prototype.setTransparency=function(){return gcmobilesdk.command("allowTransparency")},e.prototype.setCamera=function(t){gcmobilesdk.command("setCamera",t),this.setActive(!0)},e.prototype.initTyper=function(t,e,n,r){return!1},e.prototype.setTyperStrings=function(t){return!1},e.prototype.clearTyperStrings=function(){return!1},e.prototype.inhibitProcessing=function(t){return!1},e.prototype.getJPEGImage=function(){return!1},e.prototype.getCurrentImage=function(){return!1},e.prototype.getJpegAsync=function(t){gcmobilesdk.getJpegImage?gcmobilesdk.getJpegImage(t):t(!1)},e.prototype.getGciAsync=function(t){gcmobilesdk.getCurrentImage?gcmobilesdk.getCurrentImage(t):t(!1)},e.prototype.enableHighRes=function(t){return!!gcmobilesdk.setHighResFor&&(gcmobilesdk.setHighResFor(t),!0)},e.prototype.startPolling=function(){var t=this;gcmobilesdk.gcipCallback=function(e){(function(t){var e=this;this.paused||s.defer(function(){return e.trigger("scan",t)})}).call(t,e)}},e.prototype.getFileScanner=function(){return null},e.prototype._shutdown=function(){this.unbind("scan"),clearInterval(u.ivId),u.ivId=-1,u.stop=!0},e.prototype.pause=function(){this.paused=!0},e.prototype.unpause=function(){this.paused=!1},e.prototype.setActive=function(t){this.active=!!t,t?(gcmobilesdk.showOnDiv(u.div),gcmobilesdk.command("startScanning")):gcmobilesdk.hide()},e.prototype.processImageFile=function(t,e){return!1},e.prototype.processImageFiles=function(t,e){return!1},e.prototype.processImageFileArray=function(){return!1},e.prototype.scanFilesAsync=function(){return!1},e.prototype.getVersion=function(){return gcmobilesdk.version},e.prototype.isAtLeastVersion=function(t){return!a.isLessThan(this.getVersion(),t)},e.prototype.getSpeedHandicap=function(){return 1},e.prototype.supports=function(t){switch(t){case"versionString":return!0;case"liveOptions":case"stopCamera":return!0;case"flipCamera":return!1;default:return!!gcmobilesdk.supports&&gcmobilesdk.supports(t)}},e.prototype.getNeedsTransparency=function(){return!0},e}(o.ClassTS);t.exports=l},function(t,e,n){"use strict";var r=n(18),i=n(19),o=n(37);e.toSubscriber=function(t,e,n){if(t){if(t instanceof r.Subscriber)return t;if(t[i.rxSubscriber])return t[i.rxSubscriber]()}return t||e||n?new r.Subscriber(t,e,n):new r.Subscriber(o.empty)}},function(t,e,n){"use strict";e.isArray=Array.isArray||function(t){return t&&"number"==typeof t.length}},function(t,e,n){"use strict";e.isObject=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){"use strict";function r(){try{return i.apply(this,arguments)}catch(t){return o.errorObject.e=t,o.errorObject}}var i,o=n(36);e.tryCatch=function(t){return i=t,r}},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(t){function e(e){t.call(this),this.errors=e;var n=Error.call(this,e?e.length+" errors occurred during unsubscription:\n  "+e.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"");this.name=n.name="UnsubscriptionError",this.stack=n.stack,this.message=n.message}return r(e,t),e}(Error);e.UnsubscriptionError=i},function(t,e,n){"use strict";function r(t){var e,n=t.Symbol;return"function"==typeof n?n.observable?e=n.observable:(e=n("observable"),n.observable=e):e="@@observable",e}var i=n(8);e.getSymbolObservable=r,e.observable=r(i.root),e.$$observable=e.observable},function(t,e,n){"use strict";var r=n(71),i=n(74);e.queue=new i.QueueScheduler(r.QueueAction)},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(t){function e(e,n){t.call(this,e,n),this.scheduler=e,this.work=n}return r(e,t),e.prototype.schedule=function(e,n){return void 0===n&&(n=0),n>0?t.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,n){return n>0||this.closed?t.prototype.execute.call(this,e,n):this._execute(e,n)},e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?t.prototype.requestAsyncId.call(this,e,n,r):e.flush(this)},e}(n(72).AsyncAction);e.QueueAction=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(8),o=function(t){function e(e,n){t.call(this,e,n),this.scheduler=e,this.work=n,this.pending=!1}return r(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t,this.pending=!0;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),i.root.setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;i.root.clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(t){n=!0,r=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),r},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(n(73).Action);e.AsyncAction=o},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(t){function e(e,n){t.call(this)}return r(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(n(5).Subscription);e.Action=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(t){function e(){t.apply(this,arguments)}return r(e,t),e}(n(75).AsyncScheduler);e.QueueScheduler=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(t){function e(){t.apply(this,arguments),this.actions=[],this.active=!1,this.scheduled=void 0}return r(e,t),e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(n(76).Scheduler);e.AsyncScheduler=i},function(t,e,n){"use strict";var r=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=Date.now?Date.now:function(){return+new Date},t}();e.Scheduler=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(18),o=n(78);e.observeOn=function(t,e){return void 0===e&&(e=0),this.lift(new s(t,e))};var s=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.scheduler,this.delay))},t}();e.ObserveOnOperator=s;var a=function(t){function e(e,n,r){void 0===r&&(r=0),t.call(this,e),this.scheduler=n,this.delay=r}return r(e,t),e.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.add(this.scheduler.schedule(e.dispatch,this.delay,new c(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(o.Notification.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(o.Notification.createError(t))},e.prototype._complete=function(){this.scheduleMessage(o.Notification.createComplete())},e}(i.Subscriber);e.ObserveOnSubscriber=a;var c=function(t,e){this.notification=t,this.destination=e};e.ObserveOnMessage=c},function(t,e,n){"use strict";var r=n(34),i=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){switch(this.kind){case"N":return r.Observable.of(this.value);case"E":return r.Observable.throw(this.error);case"C":return r.Observable.empty()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}();e.Notification=i},function(t,e,n){"use strict";var r,i=n(1);!function(t){function e(t){var e=[];for(var n in t)e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")}function n(t){return function(e){var n=null;if("string"==typeof e)try{n=JSON.parse(e)}catch(t){n=e}else n=e;t.resolve(n)}}t.callbackCounter=0,t.serialize=e,t.fetch=function(r,o){var s=i.newDeferred(),a="JSONPCallback_"+t.callbackCounter++;window[a]=n(s),o.callback=a;var c=document.createElement("SCRIPT");return c.src=r+"?"+e(o),document.getElementsByTagName("HEAD")[0].appendChild(c),s.promise},t.evalJSONP=n}(r||(r={})),t.exports=r},function(t,e,n){(function(t){function r(t,e){this._id=t,this._clearFn=e}var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;e.setTimeout=function(){return new r(o.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new r(o.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(81),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(17))},function(t,e,n){(function(t,e){!function(t,n){"use strict";function r(t){delete p[t]}function i(t){if(f)setTimeout(i,0,t);else{var e=p[t];if(e){f=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{r(t),f=!1}}}}if(!t.setImmediate){var o,s,a,c,u,l=1,p={},f=!1,h=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?o=function(t){e.nextTick(function(){i(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?(c="setImmediate$"+Math.random()+"$",u=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(c)&&i(+e.data.slice(c.length))},t.addEventListener?t.addEventListener("message",u,!1):t.attachEvent("onmessage",u),o=function(e){t.postMessage(c+e,"*")}):t.MessageChannel?((a=new MessageChannel).port1.onmessage=function(t){i(t.data)},o=function(t){a.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(s=h.documentElement,o=function(t){var e=h.createElement("script");e.onreadystatechange=function(){i(t),e.onreadystatechange=null,s.removeChild(e),e=null},s.appendChild(e)}):o=function(t){setTimeout(i,0,t)},d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return p[l]=r,o(l),l++},d.clearImmediate=r}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(17),n(39))},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=n(21),s=n(42),a=n(9),c=n(23),u=n(135),l=new(function(){function t(){this.loadPref=null}return t.prototype.getName=function(){return"plugin"},t.prototype.isSupported=function(){return!(c.pluginsDisabled||c.mobile||c.cros)||!!this.isInstalled()},t.prototype.isInstalled=function(){return!!u.isPluginInstalled()},t.prototype.makeInstallUrl=function(t,e){var n=this.downloadsUrl;if(t||e){var r=[];t&&r.push("v="+t),e&&r.push("url="+encodeURIComponent(e)),n=n+"?"+r.join("&")}return n},t.prototype.setDownloadsUrl=function(t){this.downloadsUrl=t},t.prototype.instantiate=function(t,e,n){return r(this,void 0,void 0,function(){var e,r,c,l,p;return i(this,function(i){switch(i.label){case 0:return e={gcip_v2:!0},[4,u.injectPlugin(t,"gcpluginid",e)];case 1:if(r=i.sent(),c=r[0],l=r[1],p=new s(c,l),!n(p))throw new Error("Invalid version");i.label=2;case 2:return i.trys.push([2,4,,5]),[4,o(c)];case 3:return i.sent(),[2,p];case 4:throw i.sent(),new a.UnauthenticatedError("Could not contact server");case 5:return[2]}})})},t.prototype.supportsTyper=function(){return!0},t.prototype.isTyperInstalled=function(){return!!this.isInstalled()},t.prototype.doesInstallRequireRestart=function(){return!1},t.prototype.cancelLoad=function(){u.cancelWait()},t.prototype.waitForInstall=function(){return u.waitForInstall()},t}());t.exports=l},function(t,e,n){"use strict";var r=n(6),i=n(84),o=n(133),s=function(t){return new o(t)};r.webWorker&&r.fileSupport&&(s=function(t){return t.supports("directData")?new i(t):new o(t)}),t.exports=s},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=n(0),s=n(44),a=n(25),c=n(1),u=function(){function t(t){this.plugin=t,this.createDirectoryScanner=this.createHtml5Loader,this.createFileScanner=this.createHtml5Loader}return t.prototype.displayObject=function(t){
return this.plugin.displayDirectObj(t)},t.prototype.processDirectData=function(t){return this.plugin.processDirectData(t)},t.prototype.createHtml5Loader=function(t,e){return r(this,void 0,void 0,function(){var n,r,u=this;return i(this,function(i){switch(i.label){case 0:if(!t)throw new Error("Missing callback");e=e&&o.isArray(e)?c.newDeferred(e).promise:s(),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,e];case 2:return n=i.sent(),[4,a.ensureFileLoaders(n)];case 3:return i.sent(),r=new a(n,function(t){return u.displayObject(t)},function(t){return u.processDirectData(t)}),t(r),[2,r];case 4:return i.sent(),t&&t(null),[2,null];case 5:return[2]}})})},t.prototype.loadFromFileArray=function(t,e){return this.createHtml5Loader(t,e)},t.prototype.canUseFileArray=function(){return!0},t}();t.exports=u},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){t.exports=""},function(t,e){t.exports=""},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){t.exports=""},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){t.exports=""},function(t,e){t.exports=""},function(t,e){t.exports=""},function(t,e){t.exports=""},function(t,e){t.exports='<div id="gc_filescanner">\n\n<p><input type="file" id="files" name="gc_scan_files[]" multiple /></p>\n\n<p><button id="gc_scan_go">Scan now</button></p>\n\n</div>\n'},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=n(129),s=function(){function t(t){this.file=t,this.canvas=document.createElement("canvas"),this.atLocation=!1,this.imgDfd=o.loadImageFromFile(this.file),this.supportsNativeRes=!0,this.canvas.style.width="1px",this.canvas.style.height="1px",this.canvas.style.visibility="hidden",document.body.appendChild(this.canvas)}return t.prototype.next=function(){return!this.atLocation&&(this.atLocation=!0,!0)},t.prototype.getName=function(){return this.file.name},t.prototype.getData=function(t){return void 0===t&&(t=-1),r(this,void 0,void 0,function(){var e,n,r,o,s,a,c;return i(this,function(i){switch(i.label){case 0:return[4,this.imgDfd];case 1:return e=i.sent(),n=e.width,r=e.height,o=n*r,s=48e4,t>0?s=t:0===t&&(s=o),(o>s||t)&&(a=Math.sqrt(s/o),n*=a,r*=a),this.canvas.width=n,this.canvas.height=r,(c=this.canvas.getContext("2d")).drawImage(e,0,0,n,r),[2,{obj:e,data:c.getImageData(0,0,n,r)}]}})})},t.prototype.destroy=function(){document.body.removeChild(this.canvas)},t.isSupported=function(){return!(!window.FileReader||(t=document.createElement("canvas"),!t.getContext||!t.getContext("2d")));var t},t}();t.exports=s},function(t,e,n){"use strict";function r(t){var e=i.newDeferred();if(t.src)e.resolve(t.src);else{var n=new FileReader;n.onload=function(t){e.resolve(n.result)},n.onerror=function(t){e.reject(t.error)},n.readAsDataURL(t)}return e.promise}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1);e.readFileAsUint8=function(t){var e=i.newDeferred();if(t.buffer)e.resolve(t.buffer.buffer||t.buffer);else{var n=new FileReader;n.onload=function(t){e.resolve(n.result)},n.onerror=function(t){e.reject(t.error)},n.readAsArrayBuffer(t)}return e.promise},e.readFileAsDataURL=r,e.loadImageFromFile=function(t){return r(t).then(function(t){var e=i.newDeferred(),n=new Image;return n.onload=function(){e.resolve(n)},n.onerror=function(t){e.reject(t.error)},n.src=t,e.promise})}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=function(){function t(t){this.file=t,this.atLocation=!1,this.canvas=document.createElement("canvas"),this.canvas.style.width="1px",this.canvas.style.height="1px",this.canvas.style.visibility="hidden";var e=this.canvas.getContext("2d");this.imgData=e.createImageData(t.width,t.height),this.imgData.data.set(t.pixels)}return t.prototype.next=function(){return!this.atLocation&&(this.atLocation=!0,!0)},t.prototype.getName=function(){return this.file.name},t.prototype.getData=function(t){return void 0===t&&(t=-1),r(this,void 0,void 0,function(){return i(this,function(t){return[2,{obj:this.canvas,data:this.imgData}]})})},t.prototype.destroy=function(){this.imgData=null,this.canvas=null},t.isSupported=function(){return!(!(t=document.createElement("canvas")).getContext||!t.getContext("2d"));var t},t}();t.exports=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.detectBW=function(t){for(var e=0,n=0,r=t.data.data,i=0;i<t.data.data.length;i+=4){var o=(r[i]+r[i+1]+r[i+2])/3;o<128&&(n+=1),o<10&&(e+=1)}return e/n>.3}},function(module,exports,__webpack_require__){"use strict";var nbl={c:document,q:{},n:null,l:function(a){var b,c,x,y,z,s,l,i=0,j=0,m=this;if(m.h=m.c.head||m.c.body||m.c.documentElement||m.h,m.i||(m.s=m.f=0,m.i=setInterval(function(){(m.o<0||!m.s)&&(m.i=clearInterval(m.i),m.s>0&&m.f&&m.f(m.q)),m.o--},m.o=50)),a==m.n)for(s=m.c.getElementsByTagName("script");j<s.length;){if((a=eval("("+s[j].getAttribute("data-nbl")+")"))&&a){m.h=s[j].parentNode;break}j++}if(a&&a.shift)for(;i<a.length;)b=a[i],c=a[i+1],x="function",y=typeof b,z=typeof c,l=z==x?c:y==x?b:m.n,"number"==y&&(m.o=b/50),"string"==y&&m.a([b],l),b.shift&&m.a([b.shift(),b],l),!m.f&&l&&(m.f=l),i++},a:function(t,e){var n,r=this,i=t[0].replace(/.+\/|\.min\.js|\.js|\?.+|\W/gi,"");(n=r.q[i]=r.c.createElement("script")).setAttribute("src",t[0]),n.onload=n.onreadystatechange=function(){var n=this;n.readyState&&!/de|te/.test(n.readyState)||(n.onload=n.onreadystatechange=r.n,function(){var n=r,o=t[1];n.q[i]=!0,o&&n.l(o),e&&e(),n.s--}())},r.s++,r.h.appendChild(n)}};module.exports=nbl},function(t,e,n){"use strict";function r(t){return c.webWorker&&c.reqAnimFrame&&c.fileSupport&&t.supports&&t.supports("processBase64")}var i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},s=n(1),a=n(0),c=n(6),u=n(46),l=n(44),p=n(25),f=n(134),h=n(26),d=function(){function t(t){this.plugin=t}return t.prototype.displayObject=function(t){},t.prototype.processDirectData=function(t){var e=s.newDeferred(),n=t.data,r=t.width,i=t.height,o=h.getGrayscaleBuffer(n,r,i,!0),a=u.encode(o),c=this.plugin.processBase64(r,i,a);return setTimeout(function(){e.resolve(c)},0),e.promise},t.prototype.createHtml5Loader=function(t,e){return i(this,void 0,void 0,function(){var n,r,i=this;return o(this,function(o){switch(o.label){case 0:e=e&&a.isArray(e)?s.newDeferred(e).promise:l(),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,e];case 2:return n=o.sent(),[4,p.ensureFileLoaders(n)];case 3:return o.sent(),r=new p(n,function(t){return i.displayObject(t)},function(t){return i.processDirectData(t)}),t&&t(r),[2,r];case 4:return o.sent(),t&&t(null),[2,null];case 5:return[2]}})})},t.prototype.createDirectoryScanner=function(t){return r(this.plugin)?this.createHtml5Loader(t):new f(this.plugin).createDirectoryScanner(t)},t.prototype.createFileScanner=function(t){return r(this.plugin)?this.createHtml5Loader(t):new f(this.plugin).createFileScanner(t)},t.prototype.loadFromFileArray=function(t,e){return!!r(this.plugin)&&this.createHtml5Loader(t,e)},t.prototype.canUseFileArray=function(){return r(this.plugin)},t}();t.exports=d},function(t,e,n){"use strict";var r=n(1),i=function(){function t(t){this.pluginScanner=t}return t.prototype.next=function(t,e){return this.pluginScanner.next(function(e,n){t(e?[JSON.parse(n.replace(/'/g,'"'))]:[{error:!0,type:"file",fileName:n}])})},t}(),o=function(){function t(t){this.plugin=t}return t.prototype.scanWrapper=function(t,e){var n=r.newDeferred();return this.plugin[t](function(t){if(!t)return n.resolve(null),e(null),null;var r=new i(t);return e(r),n.resolve(r),r}),n.promise},t.prototype.createFileScanner=function(t){return this.scanWrapper("createFileScanner",t)},t.prototype.createDirectoryScanner=function(t){return this.scanWrapper("createDirectoryScanner",t)},t}();t.exports=o},function(t,e,n){"use strict";var r=n(0),i=n(1),o={GCPlugin:{name:"GCPlugin",mimeType:"application/x-gradecam",activeXName:"GradeCam.GCPlugin",guid:"c6bdb9cb-5921-5a0d-aced-d5f0ebcd92a1",installURL:{win:"_installer.msi"}}},s=0,a=-1,c=null,u=new(function(){function t(){this.pollInterval=500,this.addListener=document.attachEvent?function(t,e,n){t.attachEvent("on"+e,n)}:function(t,e,n){t.addEventListener(e,n,!1)}}return t.prototype.isPluginInstalled=function(){return window.gcmobilesdk?"mobile":o.GCPlugin?function(){var t=o.GCPlugin.activeXName,e=!1;try{e=new ActiveXObject(t);var n=!1;if(e)try{n=e.getVersionMajor()}catch(t){n=!0}return n}catch(t){}if(!navigator.plugins||!navigator.plugins.refresh)return!1;navigator.plugins.refresh(!1);var r=o.GCPlugin.name;if(void 0!==navigator.plugins[r]){var i=navigator.plugins[r].filename,s=/([0-9.]+)\.dll/.exec(i);return null===s||s[1]}return!1}():null},t.prototype.cancelWait=function(){a>-1&&clearTimeout(a),a=-1,c&&c.resolve()},t.prototype.waitForInstall=function(){var t=this;if(c)return c.promise;c=i.newDeferred();var e=function(){t.isPluginInstalled()?(a=-1,c.resolve(!!t.isPluginInstalled())):a=setTimeout(function(){e()},t.pollInterval)};return e(),c.promise},t.prototype.abortWait=function(){-1!=a&&(clearInterval(a),a=-1)},t.prototype.injectPlugin=function(t,e,n){var a=i.newDeferred(),c=o.GCPlugin;(n=n||{}).onload="__pluginCB"+s++;var u=r.once(function(t){var n=document.getElementById(e);t||(t=n),a.resolve([t,n])});window.gradecamPluginInit=window[n.onload]=u;var l='<object id="'+e+'" type="'+c.mimeType+'" style="width: 1px; height: 1px;">';return r(n).each(function(t,e){l+='<param name="'+e+'" value="'+n[e]+'" />'}),l+="</object>",t.innerHTML=l,t.style.backgroundColor="#000000",a.promise},t.prototype.addListener=function(t,e,n){},t}());t.exports=u},function(t,e,n){"use strict";var r=n(137),i=n(42),o=n(6),s=n(1),a=new(function(){function t(){this.loadPref=null}return t.prototype.getName=function(){return"noplugin"},t.prototype.isSupported=function(){return o.userMedia&&o.reqAnimFrame&&o.webWorker},t.prototype.isInstalled=function(){return!0},t.prototype.makeInstallUrl=function(t,e){var n=this.downloadsUrl;if(t||e){var r=[];t&&r.push("v="+t),e&&r.push("url="+encodeURIComponent(e)),n=n+"?"+r.join("&")}return n},t.prototype.setDownloadsUrl=function(t){this.downloadsUrl=t},t.prototype.cancelLoad=function(){},t.prototype.instantiate=function(t){var e=r.create(t);return s.PromiseAll([e]).then(function(t){var e=t[0],n=e[0],r=e[1];return new i(n,r)})},t.prototype.doesInstallRequireRestart=function(){return!0},t.prototype.waitForInstall=function(){var t=s.newDeferred();return o.plugin2.waitForPlugin(function(){return t.resolve(!0)}),t.promise},t.prototype.supportsTyper=function(){return o.plugin2.supported},t.prototype.isTyperInstalled=function(){return!!o.plugin2.installed},t.prototype.supports=function(t){return r.supports(t)},t}());t.exports=a},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=n(7),s=n(3),a=n(0),c=n(138),u=n(10),l=n(139),p=n(2),f=n(43),h=n(1),d=n(10),y=n(146),m=p.get(),g=1,v=2,b={},w=["typer","typerArrows","typerStrings","setTyperStrings","elmoCallback","rkeyDelay"],_=a.template(y),x=function(){function t(t){var e=this;this.el=t,this.cameraController=null,this.bitBlitter=null,this.imageHandler=null,this.evtBus=new s.ClassTS,this.version="",this.workerSupports={},this.scanOptions={gcip_v2:!0},this.plugin2=null,this.p2Deferred=h.newDeferred(),this.startupTimer=new p.LogTimer("NoPlugin Startup Timer",p.INFO),this.currentCameraInfo=new o.ReplaySubject(1),this.bind=a.bind(this.evtBus.bind,this.evtBus),this.unbind=a.bind(this.evtBus.unbind,this.evtBus),this.el.innerHTML=_(),this.canvas=this.el.querySelector("canvas"),this.naclParent=t.querySelector("div");var n=l.create(this.naclParent,g,v),r=c.create(this.canvas),i=u.create(t,n,r,this.p2Deferred.promise);this.loadedDfd=h.PromiseAll([n,r,i]).then(function(t){var n=t[0],r=t[1],i=t[2];return e.imageHandler=n,e.bitBlitter=r,e.cameraController=i,e.initCameraController(i),e.initBitBlitter(r),e.initImageHandler(n,r),e.version=n.getWorkerVersion(),e.workerSupports=n.getWorkerSupports(),m.info("NoPlugin Version: "+e.version),e.startupTimer.logNow(),e.startupTimer=null,e})}return t.prototype.getLoadedDfd=function(){return this.loadedDfd},t.prototype.initCameraController=function(t){var e=this.evtBus;t.bind("videoSize",function(t,n){e.trigger("videoSize",t,n)}),t.currentCameraInfo.subscribe(this.currentCameraInfo)},t.prototype.initBitBlitter=function(t){var e=this.evtBus;t.bind("cameraVisible",function(t){e.trigger("cameraVisible",t)})},t.prototype.initImageHandler=function(t,e){var n=this.evtBus;t.setOptions(this.scanOptions),t.bind("scan",function(t){m.trace("GCIP scan received: ",t),n.trigger("scan",t)}),t.bind("suspectedRects",function(t){m.trace("suspectedRects: ",t),e.setSuspectedRects(t)}),t.bind("confirmedRects",function(t){m.trace("confirmedRects: ",t),e.setConfirmedRects(t)}),t.bind("debugImages",function(t){n.trigger("debugImages",t)}),t.bind("processingTime",function(t){n.trigger("processingTime",t)})},t.prototype._setDebugOutputContainer=function(t){return this.imageHandler.setDebugOutputContainer(t)},t.prototype.inhibitProcessing=function(t){return this.imageHandler.inhibitProcessing(t)},t.prototype.initTyper=function(t,e,n,r){if(void 0===r&&(r=0),!this.plugin2)return!1;this.supports("rkeyDelay")?this.plugin2.initTyper(t,e,n,r):this.plugin2.initTyper(t,Math.max(e,r),n)},t.prototype.setTyperStrings=function(t){if(!this.plugin2||!this.supports("setTyperStrings"))return!1;m.info("Setting typer strings to:",t),this.plugin2.setTyperStrings(t)},t.prototype.clearTyperStrings=function(){if(!this.plugin2||!this.supports("setTyperStrings"))return!1;m.info("Clearing typer strings"),this.plugin2.clearTyperStrings()},t.prototype.getCameraList=function(){return this.cameraController.getCameraList()},t.prototype.setCamera=function(t,e){!0===e&&(e=d.Rotate.Full180),!1===e&&(e=d.Rotate.None),this.cameraController.setRotate(e),this.cameraController.setCamera(t)},t.prototype.stopCamera=function(){return this.cameraController.stopCamera()},t.prototype.enableHighRes=function(t){return this.bitBlitter.enableHighRes(t)},t.prototype.pauseCamera=function(){this.cameraController.pause()},t.prototype.unpauseCamera=function(){this.cameraController.unpause()},t.prototype.displayDirectObj=function(t){this.bitBlitter.drawImage(t)},t.prototype.processDirectData=function(t){return r(this,void 0,void 0,function(){var e,n;return i(this,function(r){switch(r.label){case 0:return this.pauseCamera(),[4,this.imageHandler.whenReadyForFrame()];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this.imageHandler.processFrame(t,!0,!0)];case 3:return e=r.sent(),[3,5];case 4:return n=r.sent(),m.error("Error processing frame: ",n),[3,5];case 5:return this.unpauseCamera(),[2,e]}})})},t.prototype.getVersion=function(){return this.version},t.prototype.getVersionMajor=function(){return this.version.split(".")[0]},t.prototype.getVersionMinor=function(){return this.version.split(".")[1]},t.prototype.getCurrentImage=function(){return!1},t.prototype.getJPEGImage=function(){return!1},t.prototype.getGciAsync=function(t){return r(this,void 0,void 0,function(){var e,n,r,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,h.PromiseAll([this.imageHandler.getGciData(),this.cameraController.getJpegDfd()])];case 1:return e=i.sent(),n=e[0],r=e[1],t(!(!n||!r)&&[n.width,n.height,r,n.data]),[3,3];case 2:return o=i.sent(),m.error("Error getting GCI:",o),t(!1),[3,3];case 3:return[2]}})})},t.prototype.getJpegAsync=function(t){this.cameraController.getJpegDfd().then(function(e){t(e)},function(){t(!1)})},t.prototype.setPlugin2=function(t){return r(this,void 0,void 0,function(){var e,n,o,s,a,c,u=this;return i(this,function(l){switch(l.label){case 0:return l.trys.push([0,6,,7]),t?(m.info("Plugin2 loaded",t),this.plugin2=t,"featureMap"in t?[4,t.featureMap]:[3,2]):(m.info("No plugin2 found"),this.p2Deferred.resolve(null),[2,this.p2Deferred.promise]);case 1:for(e=l.sent(),n=0,o=w;n<o.length;n++)s=o[n],b[s]=!!e[s];return[3,5];case 2:return[4,t.supports];case 3:return a=l.sent(),c=w.map(function(t){return r(u,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return[4,a(t)];case 1:return e=n.sent(),b[t]=e,[2,e]}})})}),[4,h.PromiseAll(c)];case 4:l.sent(),l.label=5;case 5:return this.supports("elmoCallback")?this.p2Deferred.resolve(t):this.p2Deferred.resolve(null),[3,7];case 6:return l.sent(),m.error("Failed to check supported features"),this.p2Deferred.resolve(null),[3,7];case 7:return[2,this.p2Deferred.promise]}})})},t.prototype.setOption=function(t,e){this.scanOptions[t]=e,this.imageHandler.setOptions(this.scanOptions)},t.prototype.getScan=function(){return!1},t.prototype.setTransparency=function(t){},t.prototype.supports=function(e){return"typer"==e?!!this.plugin2:this.workerSupports[e]||b[e]||t.supports(e)},t.prototype.getElement=function(){return this.canvas},t.supports=function(t){switch(t){case"elmo":return!1;case"imageExport":case"multiTiff":case"fileScan":return!0;case"typerArrows":return!1;case"directData":case"highRes":case"rotate":return!0;default:return!1}},t.create=function(e){return r(this,void 0,void 0,function(){var n,r;return i(this,function(i){switch(i.label){case 0:m.info("Creating NoPlugin"),n=new t(e),r=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,f()];case 2:return r=i.sent(),n.setPlugin2(r),[3,4];case 3:return i.sent(),m.info("Plugin2 not loaded"),n.setPlugin2(null),[3,4];case 4:return[4,n.getLoadedDfd()];case 5:return i.sent(),[2,[n,n.getElement()]]}})})},t}();t.exports=x},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=n(0),s=n(3),a=n(10),c=function(){function t(t){this.canvas=t,this.evtBus=new s.ClassTS,this.context=this.canvas.getContext("2d"),this.yellowRects=[],this.greenRects=[],this.high_res=!1,this.high_res_timeout=-1,this.bind=o.bind(this.evtBus.bind,this.evtBus),this.unbind=o.bind(this.evtBus.unbind,this.evtBus),this.clearVideo()}return t.prototype._drawRects=function(t,e,n,r){void 0===r&&(r=a.Rotate.None);var i=this.canvas,s=this.context,c=i.width,u=i.height,l=function(t){return t*n},p=function(t){return t*n};o.each(t,function(t){s.beginPath(),s.lineWidth=c*u/48e4*3,s.strokeStyle=e,s.moveTo(l(t.tl.x),p(t.tl.y)),s.lineTo(l(t.bl.x),p(t.bl.y)),s.lineTo(l(t.br.x),p(t.br.y)),"clip"!=t.type&&(s.lineTo(l(t.tr.x),p(t.tr.y)),s.lineTo(l(t.tl.x),p(t.tl.y))),s.stroke()})},t.prototype.enableHighRes=function(t){var e=this;return this.high_res=!0,this.high_res_timeout>0&&clearTimeout(this.high_res_timeout),this.high_res_timeout=setTimeout(function(){return e.reset_high_res()},t),!0},t.prototype.isHighRes=function(){return this.high_res},t.prototype.reset_high_res=function(){this.high_res=!1,this.high_res_timeout=-1},t.prototype.calculateScaleFactor=function(t,e){var n=Math.sqrt(48e4/(t*e)),r=Math.sqrt(2073600/(t*e)),i=n;return(this.high_res||i>1)&&(i=1),r<i&&(i=r),i},t.prototype.setSuspectedRects=function(t){this.yellowRects=t},t.prototype.setConfirmedRects=function(t){this.greenRects=t},t.prototype.drawVideo=function(t,e){void 0===e&&(e=a.Rotate.None);var n=this.context,r=this.canvas;n.setTransform(1,0,0,1,0,0);var i=t.videoWidth||t.naturalWidth,o=t.videoHeight||t.naturalHeight,s=this.calculateScaleFactor(i,o);i=Math.floor(i*s),o=Math.floor(o*s),r.width=i,r.height=o;var c=!1,u=Math.PI;switch(e){case a.Rotate.Left90:u*=-.5,c=!0;break;case a.Rotate.Right90:u*=.5,c=!0;break;case a.Rotate.Full180:u*=1;break;case a.Rotate.None:default:u*=0}return c?(r.height=i,r.width=o,n.translate(o/2,i/2)):n.translate(i/2,o/2),n.rotate(u),c?(n.drawImage(t,-i/2,-o/2,i,o),n.rotate(-u),n.translate(-o/2,-i/2)):(n.drawImage(t,-i/2,-o/2,i,o),n.rotate(-u),n.translate(-i/2,-o/2)),this.evtBus.trigger("cameraVisible",!0),c?{w:o,h:i}:{w:i,h:o}},t.prototype.drawImage=function(t){var e=this.context,n=this.canvas;n.width=t.width,n.height=t.height,e.drawImage(t,0,0,t.width,t.height),this.evtBus.trigger("cameraVisible",!0)},t.prototype.drawRects=function(t){this._drawRects(this.yellowRects,"yellow",4,t),this._drawRects(this.greenRects,"green",1,t)},t.prototype.clearRects=function(){this.yellowRects=[],this.greenRects=[]},t.prototype.clearVideo=function(){var t=this.context,e=this.canvas;t.beginPath(),t.fillStyle="black",t.rect(0,0,e.width,e.height),t.fill(),this.evtBus.trigger("cameraVisible",!1)},t.prototype.getVideoPixels=function(){return this.context.getImageData(0,0,this.canvas.width,this.canvas.height)},t.prototype.getJPEGImage=function(){var t=this.canvas.toDataURL("image/jpeg");return 5!=t.indexOf("image/jpeg")?null:t.substr(t.indexOf(",")+1)},t.create=function(e){return r(this,void 0,void 0,function(){return i(this,function(n){return[2,new t(e)]})})},t}();t.exports=c},function(t,e,n){"use strict";var r,i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},s=n(3),a=n(0),c=n(140),u=n(46),l=n(2),p=n(145),f=n(26),h=n(1),d=l.get();!function(t){t.Rect="rect",t.GCIP="gcip",t.GCIPLock="gcip_lock"}(r||(r={}));var y=[{threshold:0,throttleTo:30},{threshold:5,throttleTo:5},{threshold:15,throttleTo:4}],m=function(){function t(t,e,n){this.naclParent=t,this.gcipWorkerCount=e,this.rectWorkerCount=n,this.timerSinceLastScan=new l.LogTimer("TimeSinceLastScan",999),this.timerSinceLastGCIP=new l.LogTimer("TimeSinceLastGCIP",999),this.timerSinceLastRect=new l.LogTimer("TimeSinceLastRect",999),this.profileScanTimer=new l.LogTimer("profileScanTimer",l.INFO),this.profileGCIPTimer=new l.LogTimer("profileGCIPTimer",l.INFO),this.profileRectTimer=new l.LogTimer("profileRectTimer",l.INFO),this.seqFailCount=0,this.currentImage=null,this.currentIsOneOff=!1,this.inhibit=!1,this.inhibitCallbackId=-1,this.scanOpts={},this.gcipWorkers=[],this.rectWorkers=[],this.version=null,this.supports={},this.state=r.Rect,this.evtBus=new s.ClassTS,this.outputContainer=null,this._readyDfd=this._initWorkers(),this.bind=a.bind(this.evtBus.bind,this.evtBus),this.unbind=a.bind(this.evtBus.unbind,this.evtBus)}return t.prototype._initWorkers=function(){return i(this,void 0,void 0,function(){var t,e,n,r,i,s=this;return o(this,function(o){switch(o.label){case 0:return t=this.gcipWorkers,e=this.rectWorkers,(n=function(t,e,n){for(var r=0;r<n;++r){var i=c.createWorker(s.naclParent);t.push(i),e.push(i.getReadyDfd())}})(t,r=[],this.gcipWorkerCount||1),n(e,r,this.rectWorkerCount||1),[4,r[0]];case 1:return i=o.sent(),this.version=i.getVersion(),this.supports=i.getSupports(),[4,h.PromiseAll(r)];case 2:return o.sent(),[2,this]}})})},t.prototype.setDebugOutputContainer=function(t){this.outputContainer=t},t.prototype.getGCIPWorker=function(){return a.find(this.gcipWorkers,function(t){return t.isIdle()})},t.prototype.getRectWorker=function(){return this.timerSinceLastRect.getSeconds()<(t=this.timerSinceLastScan.getSeconds(),e=1,a.each(y,function(n){t>n.threshold&&(e=n.throttleTo)}),1/e)?null:this.timerSinceLastRect.getSeconds()<1/1.5?null:a.find(this.rectWorkers,function(t){return t.isIdle()});var t,e},t.prototype.inhibitProcessing=function(t){var e=this;void 0===t&&(t=500),-1!=this.inhibitCallbackId&&clearTimeout(this.inhibitCallbackId),this.inhibit=t>0,0!==t&&(this.inhibitCallbackId=setTimeout(function(){e.inhibit=!1},t))},t.prototype.setOptions=function(t){this.scanOpts=t||{}},t.prototype.readyForFrame=function(){var t=this.state;if(this.inhibit)return!1;if(t==r.GCIP||t==r.GCIPLock)return!!this.getGCIPWorker();if(t==r.Rect)return!!this.getRectWorker();throw new Error("ImageHandler in invalid state!")},t.prototype.whenReadyForFrame=function(){var t=this,e=h.newDeferred(),n=function(){t.readyForFrame()?e.resolve(!0):setTimeout(n,5)};return this.readyForFrame()?e.resolve(!0):setTimeout(n,5),e.promise},t.prototype.logAndReset=function(t,e){t.getSeconds()>e&&(t.logNow(),t.reset())},t.prototype.getState=function(){return this.state},t.prototype.setState=function(t){t!=this.state&&(this.state=t,d.debug("ImageHandler state is "+this.state))},t.prototype.processFrame=function(t,e,n){return i(this,void 0,void 0,function(){var i,s,a,c,u,y,m,g,v,b,w,_,x,S,k,O
;return o(this,function(o){switch(o.label){case 0:return i=h.newDeferred(),s=this.evtBus,this.currentImage=t,this.currentIsOneOff=e,u=t.data,y=t.width,m=t.height,g=this.getState(),e||g==r.GCIP||g==r.GCIPLock?a=this.getGCIPWorker():"rect"==g&&(c=this.getRectWorker()),v=new l.LogTimer("Convert to grayscale",l.DEBUG),b=f.getGrayscaleBuffer(u,y,m,!!e),v.logNow(),v=null,c?(this.timerSinceLastRect.reset(),c.lock(),[4,c.getRects(y,m,b)]):[3,2];case 1:return S=o.sent(),this.profileRectTimer.ping(),S.length?(s.trigger("suspectedRects",S),this.setState(r.GCIP)):g!=r.GCIPLock&&this.setState(r.GCIPLock),[3,4];case 2:return a?(d.trace("Running GCIP"),a.lock(),this.timerSinceLastGCIP.reset(),w=(new Date).getTime(),[4,a.readImage(y,m,b,this.scanOpts)]):[3,4];case 3:if(_=o.sent(),x=_[0],S=_[1],k=_[2],this.profileGCIPTimer.ping(),s.trigger("processingTime",(new Date).getTime()-w),this.outputContainer&&(x||e)&&p.importImageBuffer(y,m,b,this.outputContainer),k&&k.debugImages&&s.trigger("debugImages",k.debugImages),x){d.debug("Found possible scan, locking w/ "+y+"x"+m),this.setState(r.GCIPLock),s.trigger("confirmedRects",S),s.trigger("suspectedRects",[]),this.seqFailCount=0;try{(O=JSON.parse(x))&&O.length&&O[0].type&&(O.unshift({type:"meta",higher_avail:!n}),x=JSON.stringify(O))}catch(t){}e||s.trigger("scan",x),this.timerSinceLastScan.reset(),this.profileScanTimer.ping(),i.resolve(x)}else i.resolve(""),g==r.GCIPLock?(this.seqFailCount++,this.seqFailCount>=3&&(this.setState(r.Rect),s.trigger("confirmedRects",[]))):(this.setState(r.Rect),s.trigger("confirmedRects",[]));o.label=4;case 4:return this.logAndReset(this.profileScanTimer,10),this.logAndReset(this.profileGCIPTimer,10),this.logAndReset(this.profileRectTimer,10),[2,i.promise]}})})},t.prototype.getGciData=function(){var t=this.currentImage;if(!t)return null;var e=t.data,n=new Uint32Array(2);n[0]=t.width,n[1]=t.height;var r=new Uint8Array(e.length/4+8);r.set(new Uint8Array(n.buffer),0);for(var i=f.getGrayscaleBuffer(e,t.width,t.height,!!this.currentIsOneOff),o=0;o<i.length;++o)r[o+8]=i[o];return{width:t.width,height:t.height,data:u.encode(r)}},t.prototype.getWorkerVersion=function(){return this.version},t.prototype.getWorkerSupports=function(){return this.supports},t.create=function(t,e,n){return i(this,void 0,void 0,function(){var r;return o(this,function(i){switch(i.label){case 0:return[4,(r=new this(t,e,n))._readyDfd];case 1:return i.sent(),[2,r]}})})},t}();t.exports=m},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(141),o=n(142),s=n(143),a=n(2),c=n(144),u=a.get(),l=c("nopluginVer")||window._GCNOPLUGINVER||"current",p="https://cdn-qnhd.menco.cn/assets/vendors/gradecam/gc/noplugin/"+l+"/",f=p,h=c("nopluginOverride")||window._GCNOPLUGINURL;h&&(f=h);var d=function(){try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var t=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(t instanceof WebAssembly.Module)return new WebAssembly.Instance(t)instanceof WebAssembly.Instance}}catch(t){}return!1}();e.createWorker=function(t){if(d||!o.isSupported())return u.info("Using native JS"),new i(r.bind(s,null,f));u.info("Using pnacl");var e=document.createElement("div");return t.appendChild(e),new i(r.bind(o,null,e,f))}},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=n(21),s=n(2),a=n(1),c=s.get(),u=1,l=function(){function t(t){var e=this;this.id=u++,this.name="GCIPWorker #"+this.id,this.logTimer=new s.LogTimer(name,s.DEBUG),this.gcipTimer=new s.LogTimer(name+" readImage",s.DEBUG),this.rectTimer=new s.LogTimer(name+" findRects",s.DEBUG),this.initDfd=null,this.worker=null,this.readyDfd=null,this.intervalId=-1,this.supports={},this.lastScanDfd=null,this.lastRectDfd=null,this.locked=!1,c.debug("Creating "+name),this.worker=t();var n=this.worker.getReadyDfd().then(function(t){return e.initWorker(t)});this.readyDfd=n.then(function(){return c.debug("Authenticating "+e.name),o(e).then(function(){return e.logTimer.logNow("Authenticated in"),e.logTimer.reset(),e})})}return t.prototype.initWorker=function(t){var e=this;return this.initDfd=a.newDeferred(),this.intervalId=setInterval(function(){return t.postMessage({fn:"init",message:"init"})},100),t.setHandler(function(t){return e.messageHandler(t)}),this.initDfd.promise},t.prototype.messageHandler=function(t){switch(c.trace(this.name+" received message:",t),t.message){case"version":clearInterval(this.intervalId),this.version=String(t.version),this.challenge=String(t.challenge),this.supports=t.supports||this.supports,this.logTimer.logNow("loaded in"),this.logTimer.reset(),c.info("Finished loading GCIPWorker #"+this.id),this.initDfd.resolve(this.worker);break;case"challenge":this.challenge=String(t.challenge);break;case"gcip":this.lastScanDfd&&(this.gcipTimer.logNow("readImage returned in"),t.error?(this.lastScanDfd.reject(new Error(t.error)),this.lastScanDfd=null):(this.lastScanDfd.resolve([String(t.scan),t.rects,t.extra]),this.lastScanDfd=null),this.locked=!1);break;case"rect":this.lastRectDfd&&(this.rectTimer.logNow("findRects returned in"),t.error?(this.lastRectDfd.reject(new Error(t.error)),this.lastRectDfd=null):(this.lastRectDfd.resolve(t.rects),this.lastRectDfd=null),this.locked=!1)}},t.prototype.isIdle=function(){return!this.locked},t.prototype.lock=function(){this.locked=!0},t.prototype.readImage=function(t,e,n,o){return r(this,void 0,void 0,function(){var r;return i(this,function(i){switch(i.label){case 0:return this.lastScanDfd&&c.error("lastScanDfd already defined!"),(r=this.lastScanDfd||a.newDeferred())!=this.lastScanDfd&&(this.lastScanDfd=r),[4,this.readyDfd];case 1:return i.sent(),this.gcipTimer.reset("Beginning GCIP"),this.worker.postMessage({fn:"readImage",width:t,height:e,buf:n.buffer,opts:o}),[2,r.promise]}})})},t.prototype.getRects=function(t,e,n){return r(this,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:return this.lastRectDfd&&c.error("lastRectDfd already defined!"),this.lastRectDfd=this.lastRectDfd||a.newDeferred(),[4,this.readyDfd];case 1:return r.sent(),this.rectTimer.reset("Beginning findRects"),this.worker.postMessage({fn:"getRects",width:t,height:e,buf:n.buffer}),[2,this.lastRectDfd.promise]}})})},t.prototype.getChallenge=function(){return this.challenge},t.prototype.setChallengeResponse=function(t){this.worker.postMessage({fn:"setChallengeResponse",response:t})},t.prototype.getReadyDfd=function(){return this.readyDfd},t.prototype.getVersion=function(){return this.version},t.prototype.getSupports=function(){return this.supports},t}();t.exports=l},function(t,e,n){"use strict";function r(t,e){return new l(t,e)}var i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},s=n(2),a=n(1),c=s.get(),u=1,l=function(){function t(t,e){var n=this;this.el=t,this.msgHandler=null,this.readyDfd=null,this.id=u++;var r=a.newDeferred();this.readyDfd=r.promise,t.innerHTML='<embed width=0 height=0 src="'+e+'/GciPNacl.nmf" type="application/x-pnacl" />',this.pnaclPlugin=this.el.getElementsByTagName("embed")[0],t.addEventListener("load",function(){c.info("Finished loading NaCL worker #"+n.id),r.resolve(n)},!0),t.addEventListener("message",function(t){n.msgHandler&&n.msgHandler(t.data)},!0),t.addEventListener("crash",function(t){c.error("Pnacl plugin "+n.id+" crashed!",t),r.reject(t)},!0)}return t.prototype.setHandler=function(t){this.msgHandler=t},t.prototype.getReadyDfd=function(){return this.readyDfd},t.prototype.postMessage=function(t){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.readyDfd];case 1:return e.sent(),this.pnaclPlugin.postMessage(t),[2]}})})},t}();!function(t){t.isSupported=function(){return void 0!==navigator.mimeTypes["application/x-pnacl"]&&navigator.mimeTypes["application/x-pnacl"].enabledPlugin&&!window.gcNoPnacl}}(r||(r={})),t.exports=r},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},o=n(1),s=null,a="gcplugin_worker.js",c=function(){function t(t){var e=this;this.url=t,this.msgHandler=null,this.workerURLDfd=function(t){if(s)return s.promise;s=o.newDeferred();var e=new XMLHttpRequest;return e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var t=new Blob([e.responseText],{type:"text/javascript"});s.resolve(window.URL.createObjectURL(t))}},e.open("GET",t+a,!0),e.send(),s.promise}(this.url),this.readyDfd=this.workerURLDfd.then(function(t){var n=new Worker(t);return n.postMessage({url:e.url}),n.addEventListener("message",function(t){e.msgHandler&&e.msgHandler(t.data)}),n})}return t.prototype.setHandler=function(t){this.msgHandler=t},t.prototype.getReadyDfd=function(){var t=this;return this.readyDfd.then(function(){return t})},t.prototype.postMessage=function(t){return r(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,this.readyDfd];case 1:return e.sent().postMessage(t),[2]}})})},t}();t.exports=function(t){return new c(t)}},function(t,e,n){"use strict";t.exports=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))}},function(t,e,n){"use strict";function r(t,e,n,r){var i=document.createElement("canvas");i.width=t,i.height=e,r.appendChild(i);for(var o=i.getContext("2d"),s=o.createImageData(t,e),a=0;a<n.length;++a){var c=4*a;s.data[c]=n[a],s.data[c+1]=n[a],s.data[c+2]=n[a],s.data[c+3]=255}o.putImageData(s,0,0),i.style.width="320px",i.style.height="240px"}Object.defineProperty(e,"__esModule",{value:!0}),e.importImageBuffer=r,e.importImageGCI=function(t,e){var n=new Uint32Array(2);return n.set(t.subarray(0,7),0),r(n[0],n[1],t.subarray(8),e)}},function(t,e){t.exports='<img style="visibility: hidden; position: absolute;" />\n<canvas style="width: 1px; height: 1px;"></canvas>\n<video autoplay="true" muted="true" playsinline="true" style="position: absolute; top: 50%; left: 50%; width: 1px; height: 1px; opacity: 0;"></video>\n<div style="visibility: hidden; position: absolute;"></div>\n'},function(t,e){t.exports='<div style="position: relative; width: 100%; height: 100%; border: none; text-decoration: none; background: #babec1; background: -moz-radial-gradient(center, ellipse cover,  #babec1 0%, #0d2535 100%); background: -webkit-gradient(radial, center center, 0px, center center, 100%, color-stop(0%,#babec1), color-stop(100%,#0d2535)); background: -webkit-radial-gradient(center, ellipse cover,  #babec1 0%,#0d2535 100%); background: -ms-radial-gradient(center, ellipse cover,  #babec1 0%,#0d2535 100%); background: radial-gradient(center, ellipse cover,  #babec1 0%,#0d2535 100%); ">\n    <div style="position: absolute; width: 120px; top: 50%; left: 50%; margin: -60px 0 0 -60px; text-align: center;">\n        <a href="<%= url %>" style="display: block;  padding-top: 60px; color: #fff; text-shadow: 0px 0px 2px #555; font-size: 16px; text-decoration: none;">\n        <% if(upgrade) { %>\n            Upgrade the<br/>Plugin\n        <% }else{ %>\n            Install the<br/>Plugin\n        <% }%>\n        </a>\n<% if (canTryNext) { %>\n    -or-<br/>\n    <a href="javascript:<%= canTryNext %>();" style="color: #fff; text-decoration: none; text-shadow: 0px 0px 2px #555; font-size: 11px;">\n        Continue without\n    </a>\n<% } %>\n    </div>\n</div>\n'},function(t,e){t.exports='<a href="#" style="position: relative; display: block; width: 100%; height: 100%; border: none; text-decoration: none; background-color: #babec1; ">\n    <div style="position: absolute; width: 120px; height: 60px; padding-top: 60px; top: 50%; left: 50%; margin: -60px 0 0 -60px; color: #fff; text-shadow: 0px 0px 2px #555; font-size: 16px; text-align: center;">\n        Please disable ActiveX Filtering.\n    </div>\n</a>\n'},function(t,e){t.exports='<div style="position: relative; width: 100%; height: 100%; border: none; text-decoration: none; background: #babec1; background: -moz-radial-gradient(center, ellipse cover,  #babec1 0%, #0d2535 100%); background: -webkit-gradient(radial, center center, 0px, center center, 100%, color-stop(0%,#babec1), color-stop(100%,#0d2535)); background: -webkit-radial-gradient(center, ellipse cover,  #babec1 0%,#0d2535 100%); background: -ms-radial-gradient(center, ellipse cover,  #babec1 0%,#0d2535 100%); background: radial-gradient(center, ellipse cover,  #babec1 0%,#0d2535 100%); ">\n    <div style="position: absolute; width: 120px; top: 50%; left: 50%; margin: -60px 0 0 -60px; text-align: center;">\n        <a href="<%= url %>" style="display: block; padding-top: 60px; color: #fff; text-shadow: 0px 0px 2px #555; font-size: 16px; text-decoration: none;">\n            not supported on your system\n        </a>\n    </div>\n</div>\n'},function(t,e,n){"use strict";var r={type:String,enum:["exam","answerkey","score","credit","custom","tabular"]};t.exports=r},function(t,e,n){"use strict";var r=n(152);t.exports=r.ScanBlocks},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(153),o=n(154),s=function(){function t(t){this.blocks=[],this.clips=[],this.fc_blocks=[];for(var e=0,n=r.keys(t||{});e<n.length;e++){var i=n[e];this[i]=t[i]}}return t.prototype.getBlock=function(t,e){return r.find(this.blocks,function(n){return n.row===t&&n.col===e})},t.prototype.print=function(){for(var t=0,e=this.blocks;t<e.length;t++)e[t].print()},t.prototype.hash=function(){return r.reduce(this.blocks,function(t,e){return t+100*e.row+1e3*e.col+e.rows+10*e.cols},0)},t.prototype.hasFormData=function(){return!!this.barcodes||!(!this.fc_blocks||1!=this.fc_blocks.length)},t.prototype._transformIntensitiesWith=function(t,e){},t.prototype._normalizeIntensitiesWith=function(t,e){this._transformIntensitiesWith(t,function(){return null})},t.prototype.normalizeIntensities=function(t){this._normalizeIntensitiesWith("intensities",t)},t.loadV2=function(e){var n=new t({blocks:[],clips:[]}),i=e.slice(),s=0,a=r.filter(i,function(t){return"barcode"==t.type}),c=r.filter(i,function(t){return"barcode"!=t.type&&"meta"!=t.type});2==a.length&&(a=r.sortBy(a,function(t){return t.top}),n.barcodes=a[0].barcode.barcode+a[1].barcode.barcode);for(var u=function(){var t=r.min(c,function(t){return t.top}),e=r.filter(c,function(e){return e.top<=t.bottom&&e.bottom>=t.top});c=r.difference(c,e);for(var i=0,u=e=r.sortBy(e,function(t){return t.left});i<u.length;i++){var p=u[i];if("rect"==p.type&&p.gcip)l.loadRect(n,p.gcip,s);else if("clip"==p.type&&p.image){var f=new o.Clip({image:p.image,zone:s,blur:p.clip.blur,width:o.Clip.calcWidth(p.clip),height:o.Clip.calcHeight(p.clip),skew:o.Clip.calcSkew(a,p.clip)});if(2==a.length&&(p.top<a[0].top||p.top>a[1].top))continue;n.clips.push(f)}s++}},l=this;c.length>0;)u();return n},t.load=function(e){var n=new t({blocks:[]});return this.loadRect(n,e,0),n},t.loadRect=function(t,e,n){var o=[];if(e.length){r.each(e,function(t){o.push(new i.Block(t))});var s=r.max(o,function(t){return t.top});15===s.cols&&(t.fc_blocks.push(s),o=r.without(o,s));for(var a=0,c=function(){var e=r.min(o,function(t){return t.left});if(e.left>e.right)return o=r.without(o,e),{value:void 0};var i=(e.right-e.left)/e.cols,s=e.left,c=r.select(o,function(t){return t.left<s+2*i});o=r.difference(o,c);for(var u=0,l=0,p=c=r.sortBy(c,function(t){return t.top});l<p.length;l++){var f=p[l];f.row=u,f.col=a,f.zone=n,t.blocks.push(f),u++}a++};o.length>0;){var u=c();if("object"==typeof u)return u.value}return a}},t.Block=i.Block,t.Clip=o.Clip,t}();e.ScanBlocks=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(t){this.intensities=[],this.intensities_alt1=[];for(var e=0,n=r.keys(t||{});e<n.length;e++){var i=n[e];this[i]=t[i]}}return t.prototype._getRowIntensitiesWith=function(t,e){var n=this.cols*t,r=this[e];return r?r.slice(n,n+this.cols):null},t.prototype.getRowIntensities=function(t){var e=this._getRowIntensitiesWith(t,"intensities"),n=this._getRowIntensitiesWith(t,"intensities_alt1"),r=[];return e&&r.push(e),n&&r.push(n),r},t.prototype._getColIntensitiesWith=function(t,e){var n=this[e];if(!n||!n.length)return null;for(var r=n,i=this.rows,o=this.cols,s=[],a=0;a<i;a++)s.push(r[t+a*o]);return s},t.prototype.getColIntensities=function(t){var e=this._getColIntensitiesWith(t,"intensities"),n=this._getColIntensitiesWith(t,"intensities_alt1"),r=[];return e&&r.push(e),n&&r.push(n),r},t.prototype._getNumberIntensitiesWith=function(t){for(var e=[],n=0;n<this.cols;n++){var r=this._getColIntensitiesWith(n,t);if(!r)return null;e.push(r)}return e},t.prototype.getNumberIntensities=function(){var t=[],e=this._getNumberIntensitiesWith("intensities"),n=this._getNumberIntensitiesWith("intensities_alt1");return e&&t.push(e),n&&t.push(n),t},t.prototype.print=function(){console.dir({row:this.row,col:this.col,rows:this.rows,cols:this.cols})},t}();e.Block=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=function(){function t(t){for(var e=0,n=r.keys(t||{});e<n.length;e++){var i=n[e];this[i]=t[i]}}return t.calcWidth=function(t){var e=t.br.global_y-t.bl.global_y,n=t.br.global_x-t.bl.global_x;return Math.sqrt(e*e+n*n)},t.calcHeight=function(t){var e=t.tl.global_y-t.bl.global_y,n=t.tl.global_x-t.bl.global_x;return Math.sqrt(e*e+n*n)},t.calcSkew=function(t,e){if(2!=t.length)return 1;var n=t[0].barcode.l.global_x-t[0].barcode.r.global_x,r=t[0].barcode.l.global_y-t[0].barcode.r.global_y,i=Math.sqrt(n*n+r*r),o=t[1].barcode.l.global_x-t[1].barcode.r.global_x,s=t[1].barcode.l.global_y-t[1].barcode.r.global_y;return i/(Math.sqrt(o*o+s*s)+1e-7)},t}();e.Clip=i},function(t,e,n){"use strict";var r=n(156);t.exports=r.InterpretedScan},function(t,e,n){"use strict";function r(t){return t.validate}function i(t){return t.wantMoreCopies}function o(t){return s(this,void 0,void 0,function(){return a(this,function(e){return[2,new Promise(function(e,n){var r=new Image;r.onload=function(){return e(r)},r.src=t})]})})}var s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(e,"__esModule",{value:!0});var c=n(0),u=n(157),l=n(28),p=n(1),f=["GradeCam ID","Version"],h=function(){function t(e){void 0===e&&(e={}),this.items=[],c.defaults(e,t.defaults);for(var n=0,r=c.keys(e);n<r.length;n++){var i=r[n];this[i]=e[i]}}return t.prototype.getItem=function(t){return c.find(this.items,function(e){return e.label===t})},t.prototype.needsValidation=function(){return c.any(this.items,r)},t.prototype.wantsMoreClipCopies=function(){return c.any(this.items,i)},t.prototype.getUnvalidatedItems=function(){return c.filter(this.items,r)},t.prototype.getAnswerItems=function(){return c.filter(this.items,function(t){return c.indexOf(f,t.label)<0})},t.prototype.getScanOutput=function(e,n){return s(this,void 0,void 0,function(){var r,i,u,f,h,d,y,m,g,v,b,w,_,x,S,k,O,I,C,T,j,D,M,P,E,R,F,A,N,L,q,U,B,G,V,H;return a(this,function(z){switch(z.label){case 0:if(this.needsValidation())throw new Error("Not all answers were validated!");if(i=1+2*(r=.15),u=[],f=null,d=this.fc_data,1!=n)return[3,9];for(q=[],y={},m=0,g=this.items;m<g.length;m++)switch(G=g[m],V=G.form_area,H=G.value,V){case"ids":u.push(H);break;case"version":f=H;break;case"main":"Score"===G.label&&(h=H),v={value:H,area:V,choices:G.choices,type:G.type},G.choicesArr&&G.choicesArr.length>0&&(v.choicesArr=G.choicesArr),q.push(v);break;default:q.push({value:H,type:G.type})}if(y.scan_type=e,q.length&&(y.answers=q),1==u.length&&(y.gradecam_id=u[0]),u.length&&(y.ids=u),h&&(y.score=h),f&&(y.exam_version=f),!d)return[3,8];if(2!=d.desc_v||"tabular"!=d.type||!d.rows)return[3,7];y.columns=this.items,delete y.answers,b=[],w=[],_=[],x=!1,S=document.createElement("canvas"),k=S.getContext("2d"),O=0,I=y.columns,z.label=1;case 1:return O<I.length?(C=I[O],T=document.createElement("canvas"),j=T.getContext("2d"),[4,o(C.value)]):[3,4];case 2:D=z.sent(),T.width=D.width,T.height=D.height,j.drawImage(D,0,0),b.push(T),M=T.height/i*r,S.width=T.width,S.height=T.height-2*M,k.drawImage(D,0,M,S.width,S.height,0,0,S.width,S.height),P=S.toDataURL("image/jpeg"),2===(E=P.split(",")).length&&(E[0].indexOf("jpeg")>=0||E[0].indexOf("jpg")>=0)?(w.push({image:{b64:E[1]},nsplits:d.rowCount-1}),_.push(S.height)):x=!0,z.label=3;case 3:return O++,[3,1];case 4:for(y.scan_type="tabular",y.rows=[],y.rowOffset=d.rowOffset,R=0;R<d.form_description.length;R++)y.columns[R].label=d.form_description[R].label;return F=function(){return s(this,void 0,void 0,function(){var t,e,n,o,s,c,u,p,f,h,y,m,g,v,x;return a(this,function(a){switch(a.label){case 0:if(2!=d.desc_v)throw new Error("Invalid value");return t=[],[4,l.forms2.makeFormsRequest("/split/v1",{instances:w})];case 1:for(e=a.sent(),n=[],o=function(t){var o=b[t].height/i*r,s=b[t].height,a=e[t].splits.slice(0,d.rowCount-1).sort(function(t,e){return t-e});(a=a.map(function(e){return e*_[t]+o})).unshift(o),a.push(s-o),n.push(a)},s=0;s<e.length;s++)o(s);for(c=0;c<d.rowCount;c++){for(u={columns:[],text:d.rows[d.rowOffset+c].text,data:d.rows[d.rowOffset+c].data},p=0;p<b.length;p++)f={type:"clip"},h=n[p][c+1]-n[p][c],y=r*h,m=b[p].width,g=h+2*y,v=n[p][c],x=v-y,S.width=m,S.height=g,k.drawImage(b[p],0,x,m,g,0,0,m,g),f.value=S.toDataURL("image/jpeg"),u.columns.push(f);t.push(u)}return[2,t]}})})},A=function(){if(2!=d.desc_v)throw new Error("Invalid value");for(var t=[],e=0;e<d.rowCount;e++){for(var n={columns:[],text:d.rows[d.rowOffset+e].text,data:d.rows[d.rowOffset+e].data},o=0;o<b.length;o++){var s={type:"clip"},a=b[o].height/i*r,c=(b[o].height-2*a)/d.rowCount,u=r*c,l=d.rowCount,p=e/l,f=b[o].height-2*a,h=y.columns[o].skew,m=2*f*h/(h+1),g=f-m,v=m*p+g*p*p,w=m*(p+1/l)+g*(p+1/l)*(p+1/l),_=b[o].width,x=w-v+2*u,O=a+v-u;S.width=_,S.height=x,k.drawImage(b[o],0,O,_,x,0,0,_,x),s.value=S.toDataURL("image/jpeg"),n.columns.push(s)}t.push(n)}return t},x?[3,6]:(N=y,[4,p.race([F(),p.later(null,t.DeepSplitTimeout)]).catch(function(t){return A()})]);case 5:return N.rows=z.sent(),y.rows||(y.rows=A()),[3,7];case 6:y.rows=A(),z.label=7;case 7:y.data={},c.extend(y.data,d.batch_data),c.extend(y.data,d.instance_data),y.page=d.page,y.pageCount=d.pageCount,y.startOffset=d.startOffset,y.form_id=d.form_id,d.exam_version&&(y.exam_version=d.exam_version),z.label=8;case 8:return[2,y];case 9:for(L={},q=[],U=0,B=this.items;U<B.length;U++)switch(G=B[U],V=G.form_area,H=G.value,V){case"ids":u.push(H);break;case"version":f=H;break;case"main":"Score"===G.label&&(h=H),q.push(H)}return L.scan_type=e,q.length&&(L.answers=q),1==u.length&&(L.gradecam_id=u[0]),u.length&&(L.ids=u),h&&(L.score=h),f&&(L.exam_version=f),d&&(c.extend(L,d.batch_data),c.extend(L,d.instance_data),L.data={},c.extend(L.data,d.batch_data),c.extend(L.data,d.instance_data),L.page=d.page,L.pageCount=d.pageCount,L.startOffset=d.startOffset,d.exam_version&&(L.exam_version=d.exam_version)),[2,L]}})})},t.DeepSplitTimeout=5e3,t.InterpretedItem=u.InterpretedItem,t.defaults={bad_form:!1,bad_form_version:!1},t}();e.InterpretedScan=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=["type","form_area","label","value","validate","choices"],o=i.concat(["validate_classifier","bad_multiplicity","debug","marked_sigma","skew","P_blank","P_state"]),s=function(){function t(e){void 0===e&&(e={}),this.choices=[],this.choicesArr=null,r.defaults(e,t.defaults);for(var n=0,i=r.keys(e);n<i.length;n++){var o=i[n];this[o]=e[o]}}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},set:function(t){this._label=String(t)},enumerable:!0,configurable:!0}),t.prototype.toObject=function(t){void 0===t&&(t=!1);for(var e={},n=0,s=t?o:i;n<s.length;n++){var a=s[n];e[a]=r.clone(this[a])}return e},t.defaults={bad_multiplicity:!1},t}();e.InterpretedItem=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});n(0),n(159);var o=function(t){function e(){var e=t.call(this)||this;return e.useLegacyAPI&&(e.renderForm=e.renderForm_old,e.testRenderForm=e.testRenderForm_old,e.getStatus=e.getStatus_old,e.fetchFormData=e.fetchFormData_old),e}return i(e,t),e.prototype.getStatus=function(t,e,n,r){var i="/batch/"+t+"/status/"+e;return this.makeFormsRequest(i,!1,n,r)},e.prototype.getStatus_old=function(t,e,n,r){return this.sendMessage("status",{batch:t,type:e},n,r)},e.prototype.fetchFormData=function(t,e,n){return this.makeFormsRequest("/formv2/data/",t,e,n)},e.prototype.fetchFormData_old=function(t,e,n){return this.sendMessage("fetchv2",{form_id_list:t},e,n)},e}(n(51));e.Form1Manager=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=n(0),s=n(50),a=["choices","label"],c=function(){function t(e){void 0===e&&(e={}),this.opts=e,s(this.opts,t._defaults)}return t.prototype.toJSON=function(){return this.opts},t._defaults={},t}(),u=(function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return s(r.opts,e._defaults),r}i(e,t),e.prototype.setChoices=function(t){return this.opts.choices=t.toUpperCase(),this},e.prototype.setLabel=function(t){this.opts.section_label=t},e._defaults={choices:"12345"}}(c),function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return s(r.opts,e._defaults),r}return i(e,t),e.prototype.setCount=function(t){return this.opts.count=t,this},e.prototype.setChoices=function(t){return this.opts.choices=t.toUpperCase(),this},e.prototype.setAltChoices=function(t){return this.opts.choices_alt=t.toUpperCase(),this},e.prototype.setCompact=function(t){void 0===t&&(t=!0),!1!==t&&(this.opts.compact=!0)},e.prototype.setLabel=function(t){return this.opts.section_label=t,this},e.prototype.override=function(t,e,n){this.opts.question_opts||(this.opts.question_opts={});var r=String(t);if(this.opts.question_opts[r]||(this.opts.question_opts[r]={}),-1==o.indexOf(a,e))throw new Error("Invalid field type for overriding.  Supported fields are: "+a.join(", "));return this.opts.question_opts[r][e]=n,this},e.prototype.setStartNumber=function(t){return this.opts.start_num=t,this},e._defaults={choices:"ABCDE",question_opts:null},e}(c)),l=function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return s(r.opts,e._defaults),r}return i(e,t),e.prototype.setCount=function(t){return this.opts.count=t,this},e.prototype.setLabel=function(t){return this.opts.section_label=t,this},e.prototype.setWidth=function(t){
return this.opts.width=t,this},e.prototype.setChoices=function(t){return this.opts.choices=t.toUpperCase(),this},e.prototype.override=function(t,e,n){this.opts.question_opts||(this.opts.question_opts={});var r=String(t);if(this.opts.question_opts[r]||(this.opts.question_opts[r]={}),-1==o.indexOf(a,e))throw new Error("Invalid field type for overriding.  Supported fields are: "+a.join(", "));return this.opts.question_opts[r][e]=n,this},e.prototype.setStartNumber=function(t){return this.opts.start_num=t,this},e._defaults={type:"shortanswer",question_opts:null,choices:"CI"},e}(c),p=function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return s(r.opts,e._defaults),r}return i(e,t),e.prototype.setChoices=function(t){return this.opts.choices=t,this},e.prototype.setLabel=function(t){return this.opts.label=t,this},e.prototype.setDigits=function(t){return this.opts.digits=t,this},e._defaults={choices:"0123456789",digits:3,label:"",type:"numeric"},e}(c),f=function(){function t(e){void 0===e&&(e={}),this.instances=[],this.data=null,this.formSpec=e,s(this.formSpec,t._defaults)}return t.prototype.getInstances=function(){return this.instances},t.prototype.toJSON=function(){return this.formSpec},t.prototype.addInstance=function(t){if(!t)throw new Error("addInstance expects an object with one or more of: data, ids, top, bottom");var e={data:t.data,ids:t.ids};t.top&&(e.top=t.top),t.bottom&&(e.bottom=t.bottom),t.exam_version&&(e.exam_version=t.exam_version),this.instances.push(e)},t.prototype.config=function(t,e){this.formSpec.config[t]=e},t.prototype.setZoom=function(t){if(t>2||t<.25)throw new Error("Zoom level should be a value between 0.25 and 2.0 where 1.0 is normal size");this.config("zoom",t)},t._defaults={sections_topright:[],sections:[],formCode:null,config:{zoom:1}},t}();!function(t){!function(t){t.MultipleChoice=u,t.Numeric=p,t.ShortAnswer=l}(t.Sections||(t.Sections={}))}(f||(f={})),t.exports=f},function(t,e,n){"use strict";t.exports=function(t){var e="https://gc-forms.menco.cn";return"local"===t?e="http://localhost:3010":t&&"http"==t.substr(0,4)?e=t:t&&"dev"==t&&(e="https://gc-forms.menco.cn"),{formServerDomain:e,formServerComm:e+"/comm"}}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(51),s=(n(162),n(1)),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getStatus=function(t,e,n,r){var i=s.newDeferred();return i.resolve({state:"complete",status_string:""}),i.promise.then(n),i.promise},e.prototype.fetchFormData=function(t,e,n){return this.makeFormsRequest(l,t,e,n)},e}(o);e.Form2Manager=a},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=n(0),s=n(50),a=["choices","label"],c=function(){function t(e){void 0===e&&(e={}),this.opts=e,s(this.opts,t._defaults)}return t.prototype.toJSON=function(){return this.opts},t._defaults={},t}(),u=function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return s(r.opts,e._defaults),r}return i(e,t),e.prototype.setChoices=function(t){return this.opts.choices=t.toUpperCase(),this},e.prototype.setLabel=function(t){this.opts.section_label=t},e._defaults={choices:"12345"},e}(c),l=function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return s(r.opts,e._defaults),r}return i(e,t),e.prototype.setCount=function(t){return this.opts.count=t,this},e.prototype.setChoices=function(t){return this.opts.choices=t.toUpperCase(),this},e.prototype.setAltChoices=function(t){return this.opts.choices_alt=t.toUpperCase(),this},e.prototype.setCompact=function(t){void 0===t&&(t=!0),!1!==t&&(this.opts.compact=!0)},e.prototype.setLabel=function(t){return this.opts.section_label=t,this},e.prototype.override=function(t,e,n){this.opts.question_opts||(this.opts.question_opts={});var r=String(t);if(this.opts.question_opts[r]||(this.opts.question_opts[r]={}),-1==o.indexOf(a,e))throw new Error("Invalid field type for overriding.  Supported fields are: "+a.join(", "));return this.opts.question_opts[r][e]=n,this},e.prototype.setStartNumber=function(t){return this.opts.start_num=t,this},e._defaults={choices:"ABCDE",question_opts:null},e}(c),p=function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return s(r.opts,e._defaults),r}return i(e,t),e.prototype.setChoices=function(t){return this.opts.choices=t,this},e.prototype.setLabel=function(t){return this.opts.label=t,this},e.prototype.setDigits=function(t){return this.opts.digits=t,this},e._defaults={choices:"0123456789",digits:3,label:"",type:"numeric"},e}(c),f=function(){function t(e){void 0===e&&(e={}),this.zoneSpec={},this.zoneSpec=e,s(this.zoneSpec,t._defaults)}return t.prototype.toJSON=function(){return this.zoneSpec},t._defaults={},t}(),h=function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return s(r.zoneSpec,e._defaults),r}return i(e,t),e.prototype.setVersionSection=function(t,e){var n=new u;return t&&n.setChoices(t),e&&n.setLabel(e),this.zoneSpec.version=n,n},e.prototype.addMultipleChoiceSection=function(t,e,n){var r={},i=null;o.isObject(t)?(r=t,e=n=null):i=t;var s=new l(r);return i&&s.setCount(i),e&&s.setChoices(e),n&&s.setAltChoices(n),this.zoneSpec.sections.push(s),s},e.prototype._createNumericSection=function(t,e){var n;return n=o.isObject(t)?new p(t):new p({label:t,digits:e}),n},e.prototype.addTopRightNumericSection=function(t,e){var n="string"==typeof t?this._createNumericSection(t,e):this._createNumericSection(t);return this.zoneSpec.sections_topright.push(n),n},e.prototype.addNumericSection=function(t,e){var n="string"==typeof t?this._createNumericSection(t,e):this._createNumericSection(t);return this.zoneSpec.sections.push(n),n},e._defaults={type:"rect",sections_topright:[],sections:[]},e}(f),d=function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return s(r.zoneSpec,e._defaults),r}return i(e,t),e._defaults={type:"clip"},e}(f),y=function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return s(r.zoneSpec,e._defaults),r}return i(e,t),e._defaults={type:"text"},e}(f),m=function(){function t(e){void 0===e&&(e={}),this.instances=[],this.data=null,this.formSpec=e,s(this.formSpec,t._defaults)}return t.prototype.getInstances=function(){return this.instances},t.prototype.toJSON=function(){return this.formSpec},t.prototype.setFormCode=function(t){this.formSpec.formCode=t},t.prototype.addRectZone=function(t){void 0===t&&(t={});var e=new h(t=t||{});return this.formSpec.zones.push(e),e},t.prototype.addTextZone=function(t){void 0===t&&(t={});var e=new y(t=t||{});return this.formSpec.zones.push(e),e},t.prototype.addClip=function(t){void 0===t&&(t={});var e=new d(t=t||{});return this.formSpec.zones.push(e),e},t.prototype.addColumns=function(t){var e;this.formSpec.columns||(this.formSpec.columns=[]),Array.isArray(t)||(t=[t]),(e=this.formSpec.columns).push.apply(e,t)},t.prototype._getTopRightZone=function(){var t=this.formSpec.topRightZone;return t||(t=this.formSpec.topRightZone=new h({type:"topRight"})),t},t.prototype._getVersionZone=function(){var t=this.formSpec.versionZone;return t||(t=this.formSpec.versionZone=new h({type:"version"})),t},t.prototype.setVersionSection=function(t,e){return this._getVersionZone().setVersionSection(t,e)},t.prototype.addTopRightNumericSection=function(t,e){return this._getTopRightZone().addTopRightNumericSection(t,e)},t.prototype.setFormData=function(t){this.data=t},t.prototype.getFormData=function(){return this.data},t.prototype.addInstance=function(t){if(!t)throw new Error("addInstance expects an object with one or more of: data, ids, top, bottom");var e={data:t.data,ids:t.ids,header:t.header,footer:t.footer};t.top&&(e.top=t.top),t.bottom&&(e.bottom=t.bottom),t.exam_version&&(e.exam_version=t.exam_version),t.rows&&(e.rows=t.rows),this.instances.push(e)},t.prototype.config=function(t,e){this.formSpec.config[t]=e},t.prototype.setZoom=function(t){if(t>2||t<.25)throw new Error("Zoom level should be a value between 0.25 and 2.0 where 1.0 is normal size");this.config("zoom",t)},t._defaults={zones:[],formCode:null,config:{zoom:1}},t}();t.exports=m},function(t,e,n){"use strict";var r=n(52);t.exports=r.StructuredScan},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(11),a=n(12),c=function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return r.choices=r.choices||[],r.choicesArr=r.choicesArr||null,o.defaults(r,e.defaults,a.NumberItemDescription.defaults),r}return i(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){this._label=String(t)},enumerable:!0,configurable:!0}),e.prototype.getIntensities=function(t){return this.intensities[t||0]},e.prototype.getIntensityList=function(t){for(var e=[],n=0,r=this.getIntensities(t);n<r.length;n++){var i=r[n];e=e.concat(i)}return e},e.prototype.getIntensityMethods=function(){return o.range(this.intensities.length)},e.defaults={},e}(s.Item);e.NumberItem=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(166),o=n(167),s=n(29),a=n(168),c=n(169),u=n(170),l=n(13),p=function(){function t(e){void 0===e&&(e={}),this.blocks=[],this.clips=[],r.defaults(e,t.defaults);var n=e.blocks,i=e.clips;delete e.blocks,delete e.clips;for(var o=0,s=r.keys(e);o<s.length;o++){var a=s[o];this[a]=e[a]}for(var c=0,u=n||[];c<u.length;c++){var l=u[c];this.blocks.push(t.loadBlock(l))}for(var p=0,f=i||[];p<f.length;p++){var h=f[p];this.clips.push(t.loadClip(h))}}return t.prototype.toObject=function(){return JSON.parse(JSON.stringify(this))},t.loadBlock=function(t){switch(t.type){case"number":return new o.NumberBlockDescription(t);case"questions":return new i.QuestionBlockDescription(t);default:return null}},t.loadClip=function(e){return new t.ClipItemDescription(e)},t.defaults={has_formcode:!1},t.QuestionBlockDescription=i.QuestionBlockDescription,t.NumberBlockDescription=o.NumberBlockDescription,t.BlockDescription=s.BlockDescription,t.ClipItemDescription=a.ClipItemDescription,t.NumberItemDescription=c.NumberItemDescription,t.QuestionItemDescription=u.QuestionItemDescription,t.ItemDescription=l.ItemDescription,t}();e.FormDescription=p},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e){var n=t.call(this,e)||this;return n.questions=n.questions||[],n}return i(e,t),e}(n(29).BlockDescription);e.QuestionBlockDescription=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e){void 0===e&&(e={});var n=t.call(this,e)||this;return n.choices=n.choices||[],n}return i(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){this._label=String(t)},enumerable:!0,configurable:!0}),e}(n(29).BlockDescription);e.NumberBlockDescription=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e){return void 0===e&&(e={}),t.call(this,e)||this}return i(e,t),e}(n(13).ItemDescription);e.ClipItemDescription=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(n(13).ItemDescription);e.NumberItemDescription=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=function(t){function e(n){return n=n||{},o.defaults(n,e.defaults),t.call(this,n)||this}return i(e,t),e.prototype.getMultiplicityMin=function(t){var e=this.multiplicity_min;return"object"==typeof e?""===t?o.max(e)===o.min(e)?o.max(e):null:e[t||0]||1:e||1},e.prototype.getMultiplicityMax=function(t){var e=this.multiplicity_max;return"object"==typeof e?""===t?o.max(e)===o.min(e)?o.max(e):null:e[t||0]||1:e||1},e.defaults={multiplicity_max:1,multiplicity_min:1},e}(n(13).ItemDescription);e.QuestionItemDescription=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(52),a=n(11),c=n(12),u=function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return r.choices=r.choices||[],r.getMultiplicityMin=c.QuestionItemDescription.prototype.getMultiplicityMin,r.getMultiplicityMax=c.QuestionItemDescription.prototype.getMultiplicityMax,o.defaults(r,e.defaults,c.QuestionItemDescription.defaults),r}return i(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){this._label=String(t)},enumerable:!0,configurable:!0}),e.prototype.getIntensities=function(t){return this.intensities[t||0]},e.prototype.getIntensityList=function(t){return this.getIntensities(t)},e.prototype.getIntensityMethods=function(){return o.range(this.intensities.length)},e.prototype.getDarkestBubble=function(){var t=s.getMaxIndex(this.intensities[0]);return this.choices[t]},e.defaults={},e}(a.Item);e.QuestionItem=u},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(11),a=n(12),c=function(t){function e(n){void 0===n&&(n={});var r=t.call(this,n)||this;return r.choices=r.choices||[],o.defaults(r,e.defaults,a.ClipItemDescription.defaults),r}return i(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){this._label=String(t)},enumerable:!0,configurable:!0}),e.defaults={},e}(s.Item);e.ClipItem=c},function(t,e,n){"use strict";function r(t,e,n,r){var i=C[t._pid],o=i.structQ,s=e.hash();return o.push(s),o.length>n&&o.shift(),s==i.lockedStruct||!(o.length<r)&&(p.reduce(i.structQ,function(t,e){return e==s?t+1:t},0)>=r&&(i.lockedStruct=s,!0))}function i(t){return((new Date).getTime()-C[t._pid].timer)/1e3}function o(t,e,n,r){n.resolve(e),r.returnScan||t.trigger("scan",e),C[t._pid].fired=!0}var s,a=this&&this.__extends||(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},u=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},l=n(3),p=n(0),f=n(4),h=n(2),d=n(53),y=n(47),m=n(177),g=n(180),v=n(184),b=n(187),w=n(31),_=n(1),x=7,S=10,k=3,O=5,I=15,C={},T=0,j=h.get();y.hasGCMobile()&&(I=10);var D=function(t){function e(){var e=t.call(this)||this;e._pid=T++;var n=e._pid;return C[n]={mode:new f.FormMode,lockedStruct:null,structQ:[],scanQ:[],config:null,paused:!1,lastFormCodeFormId:null,fired:!1,validate:null,merger:new v,interpreter:new g(m),mult_error_thresh_e:.01,mult_error_thresh_ne:.001,choice_error_thresh:1e-5,sigma_thresh:3,sqReq:x,sqMax:S,vTime:k,cTime:O,vScans:I},e}return a(e,t),e.prototype.enableHighRes=function(){this.trigger("enableHighRes",15e3)},e.prototype.setSpeedHandicap=function(t){var e=C[this._pid];e.sqReq=Math.floor(x*t),e.sqMax=Math.floor(S*t),e.vScans=Math.floor(I*t)},e.prototype.isPaused=function(){return C[this._pid].paused},e.prototype.pause=function(){C[this._pid].paused=!0,this.trigger("pause")},e.prototype.unpause=function(){C[this._pid].paused=!1,this.trigger("unpause")},e.prototype.validateScan=function(t){var e={},n=C[this._pid],r=p.map(t.getUnvalidatedItems(),function(t,r){var i=t.toObject(n.validateDebug);return e[r]=t,i}),i=t.getItem("GradeCam ID"),o="";return i&&!i.validate&&(o=i.value),n.validate({items:r,bad_form:t.bad_form,bad_form_version:t.bad_form_version,gradecam_id:o,mode:n.mode.toJSON(),formcode_data:t.fc_data}).then(function(n){if(!n)throw new Error("Form was not validated");return p.each(n,function(t,n){var r=e[n];r.value=t.value,r.validate=t.validate}),t})},e.prototype.fireFormCodeEvent=function(t,e){return c(this,void 0,void 0,function(){var n,r;return u(this,function(i){switch(i.label){case 0:n=C[this._pid],i.label=1;case 1:return i.trys.push([1,3,,4]),[4,w(t)];case 2:return(r=i.sent())&&r.form_id!=n.lastFormCodeFormId&&(this.trigger("formcode",r),n.lastFormCodeFormId=r.form_id),2==r.desc_v&&p.some(r.form_description,function(t){return"clip"===t.type})&&(j.info("Form description contains clips, triggering highRes"),this.enableHighRes(),e&&e.higher_avail)?[2,!1]:[3,4];case 3:return i.sent(),[2,!1];case 4:return[2,!0]}})})},e.prototype.processScan=function(t,e){return c(this,void 0,void 0,function(){var n,s,a,c,l,h,y,g,v,b,w,x,S,k=this;return u(this,function(u){switch(u.label){case 0:if(e=e||{},n=_.newDeferred(),s=C[this._pid],e.returnScan&&this.reset(),!s.config)return this.trigger("processScanResult","config"),n.reject(new Error("Not configured")),[2,n.promise];u.label=1;case 1:return u.trys.push([1,5,,6]),s.formDesc?[4,s.formDesc]:[3,3];case 2:return h=u.sent(),[3,4];case 3:h=null,u.label=4;case 4:return l=h,[3,6];case 5:return u.sent(),l=s.formDesc=null,[3,6];case 6:if(l&&l.oneTimeDescription&&(s.formDesc=null,l=null),c=s.scanQ,p.defaults(e,{scansRequired:s.sqReq,scansMax:s.sqMax,scansToValidate:s.vScans}),this.isPaused())return e.successObj&&e.successObj.reject(),n.reject(new Error("Tried to process scan while paused")),this.trigger("processScanResult","paused"),[2,n.promise];if(y=null,t&&t.length&&t[0].type){if("meta"==(t=t)[0].type&&(y=t.shift()),g=y&&y.higher_avail,(a=f.ScanBlocks.loadV2(t)).clips.length&&g)return this.trigger("processScanResult","needHighRes"),j.info("Scan output contains clips, triggering highRes"),this.enableHighRes(),n.reject(new Error("Need high res image")),[2,n.promise]}else a=f.ScanBlocks.load(t);if(a.normalizeIntensities(m),v=a.hasFormData())C[this._pid].formCodeTimer=(new Date).getTime(),this.fireFormCodeEvent(a,y);else if(e.scansRequired>1&&function(t){return((new Date).getTime()-C[t._pid].formCodeTimer)/1e3}(this)<15)return e.successObj&&e.successObj.reject(),this.trigger("processScanResult","paused"),n.reject(new Error("Scaning is paused")),[2,n.promise];if(s.formDesc)return[3,10];if(!v&&!r(this,a,e.scansMax,e.scansRequired))return e.successObj&&e.successObj.reject(),n.reject(new Error("Could not verify form structure")),this.trigger("processScanResult","structure"),[2,n.promise];if(s.formDesc=s.config.getFormDescription(a),!s.formDesc||!s.formDesc.then)return[3,10];u.label=7;case 7:return u.trys.push([7,9,,10]),[4,s.formDesc];case 8:return l=u.sent(),[3,10];case 9:return u.sent(),l=null,[3,10];case 10:s.lastFormDesc=l,b=d.structure(s.formDesc,a),this.pause(),u.label=11;case 11:return u.trys.push([11,13,,14]),[4,b];case 12:return w=u.sent(),s.scanQ.length&&c[0].hasFormIdentifier()&&c[0].getFormIdentifier()==w.getFormIdentifier()||(s.scanQ=c=[],function(t){C[t._pid].timer=(new Date).getTime()}(this),s.fired=!1),s.fired?(this.unpause(),e.successObj&&e.successObj.resolve(),n.reject(new Error("Duplicate form")),this.trigger("processScanResult","alreadyProcessed"),[2,n.promise]):(c.push(w),(x=s.merger.interpretScans(l,s.scanQ,s.interpreter))?(x.wantsMoreClipCopies()&&i(this)<s.cTime&&e.scansRequired>1?(this.trigger("processScanResult","wantMoreCopies"),j.info("Scan output contains clips, more copies of the clips requested"),this.unpause(),n.reject(new Error("Needs more clip copies"))):!x.needsValidation()||e.dontValidate?(this.trigger("processScanResult","success"),o(this,x,n,e),e.successObj&&e.successObj.resolve(),c.length&&!c[0].hasFormIdentifier()&&(s.scanQ=[]),this.unpause()):i(this)>=s.vTime||c.length>=e.scansToValidate||c.length&&!s.scanQ[0].hasFormIdentifier()?(this.trigger("processScanResult","validating"),this.validateScan(x).then(function(t){e.successObj&&e.successObj.resolve(),c.length&&!c[0].hasFormIdentifier()&&(s.scanQ=[]),o(k,t,n,e)},function(){e.successObj&&e.successObj.reject(),n.reject(new Error("Could not validate form")),s.scanQ=[],s.fired=!1}).then(function(){return k.unpause()},function(){return k.unpause()})):(p.defer(function(){k.trigger("processScanResult","moreScans",k)}),this.unpause(),n.reject(new Error("Needs more scans"))),[3,14]):(this.reset(),p.defer(function(){k.trigger("processScanResult","moreScans",k)}),this.unpause(),n.reject(new Error("Need more scans")),[2,n.promise]));case 13:return S=u.sent(),this.unpause(),S&&S.domain?p.defer(function(){k.trigger("processScanResult","networkError",{domain:S.domain,error:S})}):l?this.trigger("processScanResult","structure"):p.defer(function(){"examLength"==s.config.lastFailure?k.trigger("processScanResult","examLength"):k.trigger("processScanResult","structure")}),r(this,a,e.scansMax,e.scansRequired)&&(s.formDesc=null),e.successObj&&e.successObj.reject(),n.reject(new Error("Could not scan form")),[3,14];case 14:return[2,n.promise]}})})},e.prototype.reset=function(){var t=C[this._pid];t.scanQ=[],t.formDesc=null,t.fired=!1,t.lastFormCodeFormId=null},e.prototype.setMode=function(t){var e=C[this._pid];this.reset(),e.mode=t,e.config=b.createFromMode(t),e.interpreter.setMode(t)},e.prototype.getLastFormDescription=function(){var t=C[this._pid];return t.lastFormDesc?t.lastFormDesc.toObject():null},e.prototype.setLockThreshold=function(t,e){var n=C[this._pid];n.sqReq=t,n.sqMax=e},e.prototype.setValidateTime=function(t){C[this._pid].vTime=t},e.prototype.setValidateCallback=function(t,e){void 0===e&&(e=!1),C[this._pid].validate=t,C[this._pid].validateDebug=e},e.prototype.setMultiplicityErrorThreshold=function(t,e){var n=C[this._pid];n.mult_error_thresh_e=t,n.mult_error_thresh_ne=e,n.interpreter.setMultiplicityErrorThreshold(t,e)},e.prototype.setChoiceErrorThreshold=function(t){var e=C[this._pid];e.choice_error_thresh=t,e.interpreter.setChoiceErrorThreshold(t)},e.prototype.setSigmaThreshold=function(t){var e=C[this._pid];e.sigma_thresh=t,e.interpreter.setSigmaThreshold(t)},e.prototype.setMerger=function(t){C[this._pid].merger=t},e.prototype.setInterpreter=function(t){var e=C[this._pid];e.interpreter=t,t.setMultiplicityErrorThreshold(e.mult_error_thresh_e,e.mult_error_thresh_ne),t.setChoiceErrorThreshold(e.choice_error_thresh),t.setSigmaThreshold(e.sigma_thresh)},e.prototype.resetLastScan=function(){var t=C[this._pid];t.fired=!1,t.scanQ=[]},e}(l.ClassTS);t.exports=D},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){setTimeout(t,0)};e.executeAsync=n,void 0!==t&&(e.executeAsync=n=function(e){t.nextTick(e)}),e.executeAsyncDfd=function(t){return new Promise(function(e,n){try{return t()}catch(t){console&&(console.log("Error:",t),console.log(t.stack))}})},e.yieldAsync=function(){return new Promise(function(t){return n(t)})}}).call(this,n(39))},function(t,e,n){"use strict";function r(t){for(var e,n=0,r=0,i=0,o=0;o<t.length;o++)n+=e=t[o],r+=e*e,i+=1;return n/=i,r/=i,Math.sqrt(r-n*n)}function i(t,e,n,r){var i=[];return s.each(t,function(t){t<=e?i.push(0):t<=n?i.push(1):t<=r?i.push(2):i.push(3)}),i}function o(t,e){var n=s.sortBy(t,function(t){return t});n.push(10),n.unshift(-10);for(var r=[],o=function(o){for(var c=function(c){for(var u=function(u){if(!function(t,e,n,r){var i=[];return s.each(t,function(t){t<=e?i.push(0):t<=n?i.push(1):t<=r?i.push(2):i.push(3)}),a.checksum(i[0],i[1],i[2],i[3])==i[4]}(t,n[o],n[c],n[u]))return"continue";var l=[],p=[],f=[],h=[];s.each(t,function(t){t<=n[o]?l.push(t):t<=n[c]?p.push(t):t<=n[u]?f.push(t):h.push(t)}),s.each(e,function(e){var s=.05,a=Math.max(e.t1_min,n[o]-s),d=Math.min(e.t1_max,n[o+1]+s);if(!(d<=a)){var y=Math.max(e.t2_min,n[c]-s),m=Math.min(e.t2_max,n[c+1]+s);if(!(m<=y)){var g=Math.max(e.t3_min,n[u]-s),v=Math.min(e.t3_max,n[u+1]+s);v<=g||r.push({t1_min:a,t1_max:d,t2_min:y,t2_max:m,t3_min:g,t3_max:v,list0:e.list0.concat(l),list1:e.list1.concat(p),list2:e.list2.concat(f),list3:e.list3.concat(h),syms:e.syms+i(t,n[o],n[c],n[u]).join("")})}}})},l=c;l<6;l++)u(l)},u=o;u<6;u++)c(u)},c=0;c<6;c++)o(c);return r}Object.defineProperty(e,"__esModule",{value:!0});var s=n(0),a=n(176),c=!0;e.decodeFC=function(t,e){if(e&&c||(e={}),30==t.length){for(var n,i=t.length/5,a=[{t1_min:0,t1_max:1,t2_min:0,t2_max:1,t3_min:0,t3_max:1,list0:[],list1:[],list2:[],list3:[],syms:""}],u=0;u<i;u++)a=o(t.slice(5*u,5*(u+1)),a);s.each(a,function(t){for(var n=0,r=0;r<t.syms.length;r++)r%5!=4&&(n*=4,n+=Number(t.syms[r]));n=""+n,t.value=n,t.cache_hit=!!e[n],t.cache_veto=null===e[n]}),a=s.filter(a,function(t){return!t.cache_veto}),n=a,s.each(n,function(t){t.len0=t.list0.length,t.len1=t.list1.length,t.len2=t.list2.length,t.len3=t.list3.length,t.dev0=r(t.list0),t.dev1=r(t.list1),t.dev2=r(t.list2),t.dev3=r(t.list3),t.devTot=t.len0*t.dev0*t.dev0+t.len1*t.dev1*t.dev1+t.len2*t.dev2*t.dev2+t.len3*t.dev3*t.dev3});var l=function(t,e,n){var r=s.sortBy(t,function(t){return t.len0&&t.len1&&t.len2&&t.len3?t.devTot:1/0}),i=s.find(r,function(t){return t.cache_hit});return i?[i]:s.any(r.slice(0,8),function(t){return t.cache_veto})?[]:r.slice(0,16)}(a);if(l.length)return s.pluck(l,"value")}}},function(t,e,n){"use strict";function r(t,e){return s.map(t,function(t,n){return t^e[n]})}function i(t){for(var e=[],n=0;n<t;n++)e.push(0);return e}function o(t,e,n){return i(e).concat(t).concat(i(n))}Object.defineProperty(e,"__esModule",{value:!0});var s=n(0);e.xor=r,e.zeros=i,e.pad=o,e.crc=function(t,e,n){for(;0===e[0];)e=e.slice(1);n=n?n.slice(-(e.length-1)):i(e.length-1);for(var s=t.concat(n),a=0;a<t.length;a++)s[a]&&(s=r(s,o(e,a,s.length-a-e.length)));return s.slice(-1*n.length)},e.checksum=function(t,e,n,r){return 3-(t+e+n+r)%4},e.conf={codeSymLen:30,codeWordLen:5,bitsPerWord:8,getMaxBits:function(){return this.codeSymLen/this.codeWordLen*this.bitsPerWord}}},function(t,e,n){"use strict";var r=n(178);t.exports=r},function(t,e,n){"use strict";function r(t,e,n){return 1/Math.sqrt(6.2832*e*e)*Math.exp(-(n-t)*(n-t)/(2*e*e))}function i(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];e/=t.length;var r=a.sortBy(t,function(t){return(t-e)*(t-e)}).slice(0,Math.floor(.5*t.length)),i=0;return a.each(r,function(t){i+=(t-e)*(t-e)}),2.65*Math.sqrt(i/r.length)}var o,s=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=n(0),c=n(179),u=n(30),l=n(2).get(),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._classify=function(){if(this.intensityList.length<2)this.otsu={marked_sigma:1,unmarked_sigma:1,marked_average:1,unmarked_average:0};else{this.otsu=u(this.intensityList),this.unfiltered_otsu=this.otsu;var t=this.filterLowIntensities(this.intensityList);t.length<2||(this.otsu=u(t),this.otsu.marked_sigma<2*this.otsu.unmarked_sigma&&(this.otsu.marked_sigma=2*this.otsu.unmarked_sigma),(t=this.filterExceptionalIntensities(t)).length<2||(this.otsu=u(t),this.otsu.marked_sigma<2*this.otsu.unmarked_sigma&&(this.otsu.marked_sigma=2*this.otsu.unmarked_sigma)))}},e.prototype.filterLowIntensities=function(t){var e=(this.otsu.marked_average*this.otsu.unmarked_sigma+this.otsu.unmarked_average*this.otsu.marked_sigma)/(this.otsu.unmarked_sigma+this.otsu.marked_sigma),n=[];a.each(t,function(t){t<e&&n.push(t)});var r=a.sortBy(n,function(t){return t})[Math.floor(n.length/2)]-i(n),o=[];return a.each(t,function(t){!(t<r)&&o.push(t)}),o},e.prototype.filterExceptionalIntensities=function(t){var e=this,n=[],r=(this.otsu.marked_average*this.otsu.unmarked_sigma+this.otsu.unmarked_average*this.otsu.marked_sigma)/(this.otsu.unmarked_sigma+this.otsu.marked_sigma),o=[],s=[];a.each(t,function(t){t<r?o.push(t):s.push(t)});var c=s.length>5?i(s):this.otsu.marked_sigma,u=o.length>5?i(o):this.otsu.unmarked_sigma;return a.each(t,function(t){var r=Math.abs(t-e.otsu.marked_average)/c,i=Math.abs(t-e.otsu.unmarked_average)/u;Math.min(r,i)<=5&&n.push(t)}),n},e.prototype.normalityTest=function(t){function e(e){var r=0;return a.each(t,function(t){r+=Math.pow(t-n,e)}),r/=t.length}var n=a.reduce(t,function(t,e){
return e+t},0)/t.length,r=e(2),i=e(3),o=e(4),s=i/Math.pow(r,1.5),c=o/Math.pow(r,2);console.log("Sqrt b1 = "+s),console.log("b2 = "+c);var u=t.length,l=s*Math.sqrt((u+1)*(u+3)/(6*(u-2))),p=3*(u*u+27*u-70)*(u+1)*(u+3)/((u-2)*(u+5)*(u+7)*(u+9)),f=Math.sqrt(-1+Math.sqrt(2*(p-1))),h=1/Math.log(f),d=l/Math.sqrt(2/(f*f-1)),y=h*Math.log(d+Math.sqrt(d*d+1));console.log("Z(sqrtb1) = "+y);var m=24*u*(u-2)*(u-3)/((u+1)*(u+1)*(u+3)*(u+5)),g=(c-3*(u-1)/(u+1))/Math.sqrt(m),v=6*(u*u-5*u+2)/((u+7)*(u+9))*Math.sqrt(6*(u+3)*(u+5)/(u*(u-2)*(u-3))),b=6+8/v*(2/v+Math.sqrt(1+4/(v*v))),w=(1-2/(9*b)-Math.pow((1-2/b)/(1+g*Math.sqrt(2/(b-4))),1/3))/Math.sqrt(2/9/b);console.log("Z(b2) = "+w);var _=y*y*w*w;console.log("Ksqr = "+_+" n = "+u)},e.prototype.getProbabilityGivenMarked=function(t){return t>this.otsu.marked_average?1e4:(e=this.otsu.marked_average,n=this.otsu.marked_sigma,.98*r(e,n,i=t)+.02*r(e,2*n,i));var e,n,i},e.prototype.getProbabilityGivenUnmarked=function(t){return t<this.otsu.unmarked_average?1e4:(e=this.otsu.unmarked_average,n=this.otsu.unmarked_sigma,.99*r(e,n,i=t)+.01*r(e,2*n,i));var e,n,i},e.prototype.calcTransform=function(){this.A=1/(this.otsu.marked_average-this.otsu.unmarked_average),this.B=-1*this.otsu.unmarked_average*this.A},e.prototype.transform=function(t){return this.A*t+this.B},e.prototype.getMarkedSignificance=function(t){return(t-this.otsu.marked_average)/this.otsu.marked_sigma},e.prototype.getUnmarkedSignificance=function(t){return(t-this.otsu.unmarked_average)/this.otsu.unmarked_sigma},e.prototype.validate=function(t){t=t||3;var e=this.unfiltered_otsu,n=Math.sqrt(e.marked_sigma*e.marked_sigma+e.unmarked_sigma*e.unmarked_sigma),r=(e.marked_average-e.unmarked_average)/n;return this.sigma=r,l.trace("Classifier: "+this.id),l.trace("Sigma: "+r),r<t?(l.trace("Rejecting to low sigma:",r,this.intensityList),!1):!(this.unmarkedValidationInfo&&(e.marked_average-this.unmarkedValidationInfo.average)/this.unmarkedValidationInfo.sigma<4)},e}(c);t.exports=p},function(t,e,n){"use strict";var r=0,i=function(t,e){this.unmarkedValidationInfo=e,this.intensityList=t,this.id=r++,this._classify()};t.exports=i},function(t,e,n){"use strict";var r=n(181);t.exports=r},function(t,e,n){"use strict";function r(t,e){var n=t.length,r=[];if(n>3){var i=[],o=a.zip(t,e);a.each(o,function(t){var e=t[0],n=e/(e+t[1]);n<.5&&(n=1-n),i.push(n)});var s,c=a.sortBy(i,function(t){return-t}),u=n-5;s=u>=0?c[u]:1,a.each(i,function(n,i){n>=s?t[i]>e[i]?r.push([1]):r.push([0]):r.push([1,0])})}else a.each(t,function(){r.push([1,0])});var l=function t(e){if(1===e.length)return e[0];var n=e[0],r=[],i=t(e.splice(1,e.length));return a.each(n,function(t){a.each(i,function(e){r.push([t].concat(e))})}),r}(r),p=[];return a.each(l,function(t){p.push({state:t})}),p}function i(t,e,n,r,i){a.each(t,function(t){var o=1;a.each(t.state,function(t,r){o*=1===t?e[r]:n[r]}),t.P=o*function(t,e,n){return t.multiplicity<=n&&t.multiplicity>=e?.97/p(t.state.length,e,n):0===t.multiplicity?.02:.01/(f(t.state.length)-p(t.state.length,Math.max(e,1),n)-1)}(t,r,i)})}var o,s=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=n(0),c=n(182),u=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4],l=function(t){return u[t]},p=a.memoize(function(t,e,n){var r=0;return a.each(a.range(e,n+1),function(e){r+=l(t)/(l(e)*l(t-e))}),r},function(t,e,n){return String(1e4*t+100*e+n)}),f=a.memoize(function(t){return Math.pow(2,t)}),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.interpretIntArray=function(t,e,n,o,s){var c=[],u=[];s>e.length&&(s=e.length),a.each(e,function(e){var n=t.getProbabilityGivenMarked(e),r=t.getProbabilityGivenUnmarked(e);c.push(n),u.push(r)});var l=r(c,u);!function(t){a.each(t,function(t){t.multiplicity=a.reduce(t.state,function(t,e){return t+Number(e)},0)})}(l),t.validate(this.sigma_threshold)||(o=0,s=e.length),i(l,c,u,o,s),function(t){var e=a.reduce(t,function(t,e){return t+e.P},0),n=[0,0,0,0,0,0,0,0,0,0];a.each(t,function(t){n[t.multiplicity]+=t.P}),a.each(t,function(t){t.P_state=t.P/e,t.P_choice=t.P/n[t.multiplicity],t.P_multiplicity=n[t.multiplicity]/e})}(l);var p=a.max(l,function(t){return t.P_state}),f=[];a.each(p.state,function(t,e){t&&f.push(n[e])});var h=a.find(l,function(t){return 0===t.multiplicity}),d=0;h&&(d=h.P_multiplicity);var y,m=t.getMarkedSignificance(a.max(e)),g=1-p.P_choice,v=1-p.P_multiplicity,b=g>this.choice_error_threshold;return y=f.length>=o&&f.length<=s?v>this.multiplicity_error_threshold_expected:v>this.multiplicity_error_threshold_not_expected,{values:f,validate:b||y,P_blank:d,P_state:p.P_state,P_choice:p.P_choice,P_multiplicity:p.P_multiplicity,marked_sigma:m}},e}(c);t.exports=h},function(t,e,n){"use strict";function r(t,e,n){if(!t)return e;if(!e)return t;var r={};return s.each(t,function(t,n){var i=e[n],o=t.validate_classifier?0:t.P_state,s=i.validate_classifier?0:i.P_state;o>.3&&""===t.value?r[n]=t:s>.3&&""===i.value?r[n]=i:r[n]=o>s?t:i}),r}function i(t,e){var n=0,r=0;return s.each(t,function(t){r++,0!=t.validate&&1!=t.bad_multiplicity||0!=t.validate_classifier||n++}),n/r}var o=n(4),s=n(0),a=n(183),c=n(30),u=function(){function t(t){this.Classifier=t,this.multiplicity_error_threshold_not_expected=.001,this.multiplicity_error_threshold_expected=.01,this.choice_error_threshold=1e-5,this.sigma_threshold=3,this.scanMode=null}return t.prototype.setMode=function(t){this.scanMode=t},t.prototype.setMultiplicityErrorThreshold=function(t,e){this.multiplicity_error_threshold_not_expected=e,this.multiplicity_error_threshold_expected=t},t.prototype.setChoiceErrorThreshold=function(t){this.choice_error_threshold=t},t.prototype.setSigmaThreshold=function(t){this.sigma_threshold=t},t.prototype.interpretScanUsingMethod=function(t,e,n,r,i,o){var a=this,c={},u=s.groupBy(t.items,n);return s.each(u,function(t,n){var s=[];s=[];for(var u=0,l=t;u<l.length;u++){var p=y=l[u];s=s.concat(p.getIntensityList?p.getIntensityList(r):[])}for(var f=new e(s,i),h=0,d=t;h<d.length;h++){var y=d[h],m=a.interpretItem(f,y,r,o);m.classifier_id=f.id,c[y.fdid]=m}}),c},t.prototype.interpretScan=function(t){var e=this,n=s.indexOf(t.getIntensityMethods(),1)>=0,u=function(t){return"number"===t.type?t.label:String(t.block_col)},l=function(t){return"number"===t.type?t.label:"question"},p=t.getItemByLabel("Version"),f=null;p&&(f=p.getDarkestBubble()),t.fc_data&&t.fc_data.exam_version?f=t.fc_data.exam_version:t.fc_data&&t.fc_data.batch_data&&t.fc_data.batch_data.exam_version&&(f=t.fc_data.batch_data.exam_version);var h=t.getItemsByType("number");h.length||(h=t.getItemsByType("question"));for(var d=[],y=[],m=0,g=h;m<g.length;m++){var v=g[m];d=d.concat(v.getIntensityList(0)),y=y.concat(v.getIntensityList(1))}var b,w,_=c(d),x=c(y);_&&(b={average:_.unmarked_average,sigma:_.unmarked_sigma}),x&&(w=n?{average:x.unmarked_average,sigma:x.unmarked_sigma}:{});var S,k=this.interpretScanUsingMethod(t,this.Classifier,u,0,b,f);a(k),i(k)<1&&(S=this.interpretScanUsingMethod(t,this.Classifier,l,0,b,f),a(S));var O,I,C,T=r(k,S),j=i(T),D=0;j<1&&n&&(O=this.interpretScanUsingMethod(t,this.Classifier,u,1,w,f),a(O),i(O)<1&&(I=this.interpretScanUsingMethod(t,this.Classifier,l,1,w,f),a(I)),D=i(C=r(O,I)));var M={},P=!1;if(j>.4&&j>D)M=T;else if(D>.4)M=C;else{var E=this.interpretScanUsingMethod(t,this.Classifier,l,0,{},f);s.each(E,function(t){"GradeCam ID"!=t.label&&(t.validate=!0)}),M=E,P=!0}var R=!1;s.each(M,function(t){"Version"==t.label&&t.validate&&-1==e.multiplicity_error_threshold_not_expected&&(R=!0)}),s.each(M,function(t){!0===t.bad_multiplicity&&(t.validate=!0)});for(var F=[],A=0,N=t.items;A<N.length;A++)v=N[A],F.push(M[v.fdid]);return new o.InterpretedScan({fc_data:t.fc_data,type:t.type,items:F,bad_form:P,bad_form_version:R})},t.prototype.interpretItem=function(t,e,n,r){switch(e.type){case"number":return this.interpretNumberItem(t,e,n);case"question":return this.interpretQuestionItem(t,e,n,r);case"clip":return this.interpretClipItem(e);default:throw"Unknown Item Type"}},t.prototype.interpretQuestionItem=function(t,e,n,r){var i,s=e.getIntensities(n);i=e.ignore?{values:[],validate:!1,P_state:1,P_blank:1,marked_sigma:0}:this.interpretIntArray(t,s,e.choices,e.getMultiplicityMin(r),e.getMultiplicityMax(r));var a=!t.validate(this.sigma_threshold);a&&(i.validate=!0);var c=new o.InterpretedScan.InterpretedItem({type:"question",form_area:e.form_area,label:e.label,value:i.values.join(""),choices:e.choices,validate:i.validate,validate_classifier:a,P_state:i.P_state,P_blank:i.P_blank,marked_sigma:i.marked_sigma});-1!==this.multiplicity_error_threshold_not_expected||e.ignore||c.value.length!==e.getMultiplicityMax(r)&&(c.bad_multiplicity=!0);var u={};return i.debug&&(u=i.debug),u.intArray=s,c.debug=u,c},t.prototype.interpretNumberItem=function(t,e,n){var r=e.getIntensities(n),i="",a=!1,c=!1,u=this,l=!t.validate();return s.each(r,function(n,r){var o=e.choices;e.choicesArr&&e.choicesArr.length&&(o=e.choicesArr[r]);var s=u.interpretIntArray(t,n,o,0,1);s.values=s.values.filter(function(t){return void 0!==t}),s.values.length>1?a=!0:0==s.values.length?i+=" ":i+=s.values[0],s.validate&&(c=!0)}),i=i.trim(),a&&(i="",c=!0),!this.scanMode.numeric_allow_blanks&&i.indexOf(" ")>-1&&(a=!0,c=!0),t.validate()||(c=!0),new o.InterpretedScan.InterpretedItem({type:"number",choices:e.choices,choicesArr:e.choicesArr,form_area:e.form_area,label:e.label,value:i,validate:c,validate_classifier:l,bad_multiplicity:a})},t.prototype.interpretClipItem=function(t){return new o.InterpretedScan.InterpretedItem({type:"clip",choices:[],form_area:t.form_area,label:t.label,value:t.image,wantMoreCopies:t.wantMoreCopies,validate:!1,validate_classifier:!1,skew:t.skew})},t}();t.exports=u},function(t,e,n){"use strict";var r=n(0);t.exports=function(t){var e=[];r.each(t,function(t){var n=t.label.split(" ");if("Question"===n[0]){var r=Number(n[1])-1;e[r]=t}}),r.each(e,function(t,n){var r=Number(n);if(!t.ignore&&0===t.value.length){var i=r>=1?e[r-1]:null;if(i&&i.classifier_id===t.classifier_id){if(i.P_blank<.001){var o=i.marked_sigma-t.marked_sigma;t.P_blank>.9?(t.value="",t.validate=!1):o>3&&(t.value="",t.validate=!1)}0===i.value.length&&!1===i.validate&&t.P_blank>.9&&(t.value="",t.validate=!1)}}})}},function(t,e,n){"use strict";var r=n(185);t.exports=r},function(t,e,n){"use strict";function r(t){return t.blur/t.width||1}function i(t){for(var e=a.map(t[0],function(){return 0}),n=0;n<t.length;n++)for(var r=0;r<e.length;r++)e[r]+=t[n][r];for(r=0;r<e.length;r++)e[r]=e[r]/t.length;return e}var o,s=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=n(0),c=n(186),u=n(4),l=0,p=0,f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.interpretScans=function(t,e,n){if(!e.length)return null;var o=e[0].structure_hash;if(a.any(e,function(t){return t.structure_hash!=o}))return null;var s=a.pluck(e[0].items,"fdid"),c=e[0].fc_data,f=a.reduce(e,function(t,e){return e?t.concat(e.items):t},[]),h=new u.StructuredScan({type:e[0],items:[],fc_data:c});return a.each(s,function(t){var e,n=a.select(f,function(e){return e.fdid==t}),o=[],s=n[0];if("number"===s.type){var c=new u.StructuredScan.NumberItem(s);o=[];for(var d=a.map(n,function(t){return t.intensities}),y=[],m=function(t){o=[],o=a.map(d,function(e){return e[t]}),y.push(function(t){for(var e=a.keys(t[0]).map(function(t){return Number(t)}),n=[],r=function(e){var r=a.map(t,function(t){return t[e]});n[e]=i(r)},o=0,s=e;o<s.length;o++)r(s[o]);return n}(o))},g=0;g<d[0].length;g++)m(g);c.intensities=y,e=c}else if("clip"==s.type){var v=!1,b=a.select(f,function(e){return e.fdid==t}),w=a.min(b,function(t){return r(t)}),_=r(w);b.length>=3?v=!0:p>5&&_>1.5*l&&(v=!0),v&&(l=l?.9*l+_*(1-.9):_),p++<1&&(l=_);var x=w;x.wantMoreCopies=!v,e=new u.StructuredScan.ClipItem(x)}else{c=new u.StructuredScan.QuestionItem(s),o=[],d=a.map(n,function(t){return t.intensities}),y=[];var S=function(t){o=[],o=a.map(d,function(e){return e[t]}),y.push(i(o))};for(g=0;g<d[0].length;g++)S(g);c.intensities=y,e=c}h.items.push(e)}),n.interpretScan(h)},e}(c);t.exports=f},function(t,e,n){"use strict";var r=function(){};t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(188),i=n(55),o=n(56),s=n(189),a=n(190);e.createFromMode=function(t){switch(t.type){case"exam":return new i(t);case"answerkey":return new r(t);case"score":return new o(t);case"credit":return new s(t);case"custom":return new a(t);default:throw"Unimplemented form type"}}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},a=n(55),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.parentGetFormDescription=a.prototype.getFormDescription,e}return i(e,t),e.prototype.getFormDescription=function(t){return o(this,void 0,void 0,function(){var e,n,r,i;return s(this,function(o){switch(o.label){case 0:return[4,this.parentGetFormDescription(t)];case 1:if(!(e=o.sent()))return[2,null];for(n=0,r=e.blocks;n<r.length;n++)"ids"===(i=r[n]).form_area&&(i.ignore=!0);return[2,e]}})})},e}(a);t.exports=c},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},a=n(0),c=n(56),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.parentGetFormDescription=c.prototype.getFormDescription,e}return i(e,t),e.prototype.getFormDescription=function(t){return o(this,void 0,void 0,function(){var e,n;return s(this,function(r){switch(r.label){case 0:return[4,this.parentGetFormDescription(t)];case 1:return(e=r.sent())?1!==(n=a.filter(e.blocks,function(t){return"Score"===t.label})).length?[2,null]:(n[0].ignore=!0,[2,e]):[2,null]}})})},e}(c);t.exports=u},function(t,e,n){"use strict";function r(t){return t?"questions"===t.type?new l.FormDescription.QuestionBlockDescription(t):"number"===t.type?new l.FormDescription.NumberBlockDescription(t):null:null}function i(t,e){return!!p.matchBlocks(e.blocks,t.blocks)}var o,s=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},u=n(32),l=n(4),p=n(53),f=n(0),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.getFormDescription=function(t){return a(this,void 0,void 0,function(){var e,n,o;return c(this,function(s){return e=this.formMode.custom_form_description,f.isArray(e)?(n=f.map(e,function(t){return new l.FormDescription({blocks:f.map(t.blocks,r)})}),[2,f.find(n,function(e){return i(t,e)})]):(o=new l.FormDescription({blocks:f.map(e.blocks,r)}),i(t,o)?[2,o]:[2,null])})})},e}(u);t.exports=h},function(t,e,n){"use strict";function r(t){return t?(new Date).valueOf()-t.valueOf():1/0}var i,o=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=n(0),a=function(t){function e(e){var n=t.call(this)||this;return n.scanManager=e,n.lastResult=null,n.lastSuccess=null,n.queue=[],n.scanManager.bind("processScanResult",n.onProcessScanResult,n),n.intervalId=setInterval(function(){r(n.lastResult)>5e3&&n.reset()},1e3),n}return o(e,t),e.prototype.shutdown=function(){clearInterval(this.intervalId)},e.prototype.reset=function(){this.queue=[]},e.prototype.reportProblem=function(t,e,n){this.reset(),this.trigger("problem",{type:t,message:e,data:n})},e.prototype.onProcessScanResult=function(t,e){this.lastResult=new Date,"success"==t&&(this.queue=[],this.lastSuccess=new Date);var n,i=[];switch(s.each(this.queue,function(t){r(t.time)<6e4&&i.push(t)}),this.queue=i,this.queue.push({result:t,time:new Date}),t){case"paused":case"config":break;case"examLength":s.filter(this.queue,function(t){return"examLength"==t.result}).length>3&&(n="",this.reportProblem("examLength",n));break;case"alreadyProcessed":r(this.lastSuccess)>5e3&&(n="",this.reportProblem("duplicateId",n));break;case"needHighRes":r(this.lastSuccess)>8e3&&(n=". Clips may not work.",this.reportProblem("cannotHighRes",n));break;case"structure":var o=s.filter(this.queue,function(t){return"structure"==t.result});new Date-o[0].time>6e3&&o.length>10&&o.length/this.queue.length>.7&&(n="",this.reportProblem("badStructure",n),this.trigger("enableHighRes",3e3));break;case"networkError":this.reportProblem("networkError"," "+e.domain+"; .",e),console&&console.error&&console.error(e.error)}},e}(n(3).ClassTS);t.exports=a},function(t,e,n){"use strict";var r=n(1);t.exports=function(t){return function(e){var n=r.newDeferred();return t(e,function(t){null===t?n.reject(t):n.resolve(t)}),n.promise}}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=n(1),s="",a=function(t){function e(e,n){var r=t.call(this,e)||this;return r.req=n,r}return i(e,t),e}(Error);t.exports=function(t){var e=o.newDeferred(),n=new XMLHttpRequest,r=s+t+"/gcip";return n.onreadystatechange=function(){if(4==n.readyState&&200==n.status)try{var t=JSON.parse(n.responseText);e.resolve(t)}catch(t){e.reject(t)}else 4==n.readyState&&200!=n.status&&e.reject(new a("Error making request",n))},n.open("GET",r,!0),n.send(),e.promise}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.copyToClipboard=function(t){var e=document.activeElement,n=document.createElement("textarea");document.body.appendChild(n),n.value=t,n.select();var r=!1;try{r=document.execCommand("copy")}catch(t){}return n.remove(),e&&"function"==typeof e.focus&&e.focus(),r}},function(t,e,n){"use strict";function r(t,e){return i(this,void 0,void 0,function(){var n,r,i;return o(this,function(o){return n=t,r=new XMLHttpRequest,i=s.newDeferred(),r.onreadystatechange=function(){if(4==r.readyState&&200==r.status)try{var t=JSON.parse(r.responseText);i.resolve(t)}catch(e){i.reject(e)}else if(4==r.readyState&&200!=r.status){var e=new Error("Server returned code "+r.status);e.response=r.responseText;try{e=JSON.parse(e.response)}catch(t){}i.reject(e)}},e?(r.open("PUT",n,!0),r.setRequestHeader("X-Requested-With","GCSDK"),r.setRequestHeader("Content-type","application/json"),r.send(JSON.stringify(e))):(r.open("GET",n,!0),r.send()),[2,i.promise]})})}var i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(o=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,i=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){a.label=n[1];break}if(6===n[0]&&a.label<o[1]){a.label=o[1],o=n;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(n);break}o[2]&&a.ops.pop(),a.trys.pop();continue}n=e.call(t,a)}catch(t){n=[6,t],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,i,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),a="xxxx//downloads.gradecam.com/grades";e.setWebTyperScores=function(t,e,n){return i(this,void 0,void 0,function(){var i;return o(this,function(o){switch(o.label){case 0:return[4,r(a+"/"+encodeURIComponent(t),{scores:e,config:n})];case 1:return[2,(i=o.sent())&&i.success]}})})}},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(16),o=n(20),s=function(t){function e(e){t.call(this),this._value=e}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new o.ObjectUnsubscribedError;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(i.Subject);e.BehaviorSubject=s}])});